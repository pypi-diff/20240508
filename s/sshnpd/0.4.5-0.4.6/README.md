# Comparing `tmp/sshnpd-0.4.5.tar.gz` & `tmp/sshnpd-0.4.6.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "sshnpd-0.4.5.tar", max compression
+gzip compressed data, was "sshnpd-0.4.6.tar", max compression
```

## Comparing `sshnpd-0.4.5.tar` & `sshnpd-0.4.6.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3238 206d 7469 6d65 3d31 3730 3930 3334  28 mtime=1709034
-00000210: 3838 352e 3932 3134 3435 310a 0000 0000  885.9214451.....
+00000200: 3238 206d 7469 6d65 3d31 3731 3531 3834  28 mtime=1715184
+00000210: 3235 382e 3231 3436 3333 370a 0000 0000  258.2146337.....
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -58,24 +58,24 @@
 00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000400: 7373 686e 7064 2d30 2e34 2e35 2f4c 4943  sshnpd-0.4.5/LIC
+00000400: 7373 686e 7064 2d30 2e34 2e36 2f4c 4943  sshnpd-0.4.6/LIC
 00000410: 454e 5345 0000 0000 0000 0000 0000 0000  ENSE............
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00000470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000480: 3030 3032 3737 3100 3134 3536 3733 3436  0002771.14567346
-00000490: 3630 3600 3031 3130 3032 0020 3000 0000  606.011002. 0...
+00000480: 3030 3032 3737 3100 3134 3631 3637 3231  0002771.14616721
+00000490: 3230 3200 3031 3037 3633 0020 3000 0000  202.010763. 0...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -218,16 +218,16 @@
 00000d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000e00: 3238 206d 7469 6d65 3d31 3730 3930 3334  28 mtime=1709034
-00000e10: 3838 352e 3932 3134 3435 310a 0000 0000  885.9214451.....
+00000e00: 3238 206d 7469 6d65 3d31 3731 3531 3834  28 mtime=1715184
+00000e10: 3235 382e 3231 3436 3333 370a 0000 0000  258.2146337.....
 00000e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -250,24 +250,24 @@
 00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001000: 7373 686e 7064 2d30 2e34 2e35 2f52 4541  sshnpd-0.4.5/REA
+00001000: 7373 686e 7064 2d30 2e34 2e36 2f52 4541  sshnpd-0.4.6/REA
 00001010: 444d 452e 6d64 0000 0000 0000 0000 0000  DME.md..........
 00001020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00001070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00001080: 3030 3033 3233 3500 3134 3536 3733 3436  0003235.14567346
-00001090: 3630 3600 3031 3132 3530 0020 3000 0000  606.011250. 0...
+00001080: 3030 3033 3233 3500 3134 3631 3637 3231  0003235.14616721
+00001090: 3230 3200 3031 3132 3331 0020 3000 0000  202.011231. 0...
 000010a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -442,16 +442,16 @@
 00001b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001c00: 3238 206d 7469 6d65 3d31 3730 3930 3334  28 mtime=1709034
-00001c10: 3838 352e 3932 3134 3435 310a 0000 0000  885.9214451.....
+00001c00: 3238 206d 7469 6d65 3d31 3731 3531 3834  28 mtime=1715184
+00001c10: 3235 382e 3231 3436 3333 370a 0000 0000  258.2146337.....
 00001c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -474,24 +474,24 @@
 00001d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001e00: 7373 686e 7064 2d30 2e34 2e35 2f70 7970  sshnpd-0.4.5/pyp
+00001e00: 7373 686e 7064 2d30 2e34 2e36 2f70 7970  sshnpd-0.4.6/pyp
 00001e10: 726f 6a65 6374 2e74 6f6d 6c00 0000 0000  roject.toml.....
 00001e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00001e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00001e80: 3030 3031 3035 3100 3134 3536 3733 3436  0001051.14567346
-00001e90: 3630 3600 3031 3236 3737 0020 3000 0000  606.012677. 0...
+00001e80: 3030 3031 3035 3200 3134 3631 3637 3231  0001052.14616721
+00001e90: 3230 3200 3031 3236 3631 0020 3000 0000  202.012661. 0...
 00001ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -508,15 +508,15 @@
 00001fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002000: 5b74 6f6f 6c2e 706f 6574 7279 5d0a 6e61  [tool.poetry].na
 00002010: 6d65 203d 2022 7373 686e 7064 220a 7665  me = "sshnpd".ve
-00002020: 7273 696f 6e20 3d20 2230 2e34 2e35 220a  rsion = "0.4.5".
+00002020: 7273 696f 6e20 3d20 2230 2e34 2e36 220a  rsion = "0.4.6".
 00002030: 6465 7363 7269 7074 696f 6e20 3d20 2250  description = "P
 00002040: 7974 686f 6e20 696d 706c 656d 656e 7461  ython implementa
 00002050: 7469 6f6e 206f 6620 5353 4820 4e6f 2050  tion of SSH No P
 00002060: 6f72 7473 2064 6165 6d6f 6e22 0a61 7574  orts daemon".aut
 00002070: 686f 7273 203d 205b 2258 6176 6965 7220  hors = ["Xavier 
 00002080: 4c69 6e20 3c78 6176 6965 722e 6c69 6e40  Lin <xavier.lin@
 00002090: 6174 7369 676e 2e63 6f6d 203e 225d 0a6d  atsign.com >"].m
@@ -530,25 +530,25 @@
 00002110: 7469 6f6e 2f6e 6f70 6f72 7473 220a 0a5b  tion/noports"..[
 00002120: 746f 6f6c 2e70 6f65 7472 792e 7363 7269  tool.poetry.scri
 00002130: 7074 735d 0a73 7368 6e70 6420 3d20 2773  pts].sshnpd = 's
 00002140: 7368 6e70 643a 6d61 696e 270a 0a5b 746f  shnpd:main'..[to
 00002150: 6f6c 2e70 6f65 7472 792e 6465 7065 6e64  ol.poetry.depend
 00002160: 656e 6369 6573 5d0a 7079 7468 6f6e 203d  encies].python =
 00002170: 2022 5e33 2e31 3022 0a61 7473 646b 203d   "^3.10".atsdk =
-00002180: 2022 302e 322e 3622 0a62 6372 7970 7420   "0.2.6".bcrypt 
-00002190: 3d20 2234 2e31 2e32 220a 7061 7261 6d69  = "4.1.2".parami
-000021a0: 6b6f 203d 2022 332e 342e 3022 0a50 794e  ko = "3.4.0".PyN
-000021b0: 6143 6c20 3d20 2231 2e35 2e30 220a 7365  aCl = "1.5.0".se
-000021c0: 7475 7074 6f6f 6c73 203d 2022 3639 2e31  tuptools = "69.1
-000021d0: 2e31 220a 0a5b 6275 696c 642d 7379 7374  .1"..[build-syst
-000021e0: 656d 5d0a 7265 7175 6972 6573 203d 205b  em].requires = [
-000021f0: 2270 6f65 7472 792d 636f 7265 225d 0a62  "poetry-core"].b
-00002200: 7569 6c64 2d62 6163 6b65 6e64 203d 2022  uild-backend = "
-00002210: 706f 6574 7279 2e63 6f72 652e 6d61 736f  poetry.core.maso
-00002220: 6e72 792e 6170 6922 0a00 0000 0000 0000  nry.api"........
+00002180: 2022 302e 322e 3133 220a 6263 7279 7074   "0.2.13".bcrypt
+00002190: 203d 2022 342e 312e 3322 0a70 6172 616d   = "4.1.3".param
+000021a0: 696b 6f20 3d20 2233 2e34 2e30 220a 5079  iko = "3.4.0".Py
+000021b0: 4e61 436c 203d 2022 312e 352e 3022 0a73  NaCl = "1.5.0".s
+000021c0: 6574 7570 746f 6f6c 7320 3d20 2236 392e  etuptools = "69.
+000021d0: 352e 3122 0a0a 5b62 7569 6c64 2d73 7973  5.1"..[build-sys
+000021e0: 7465 6d5d 0a72 6571 7569 7265 7320 3d20  tem].requires = 
+000021f0: 5b22 706f 6574 7279 2d63 6f72 6522 5d0a  ["poetry-core"].
+00002200: 6275 696c 642d 6261 636b 656e 6420 3d20  build-backend = 
+00002210: 2270 6f65 7472 792e 636f 7265 2e6d 6173  "poetry.core.mas
+00002220: 6f6e 7279 2e61 7069 220a 0000 0000 0000  onry.api".......
 00002230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -578,16 +578,16 @@
 00002410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00002470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00002480: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00002490: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00002480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00002490: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 000024a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000024f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -602,16 +602,16 @@
 00002590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000025a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000025b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000025c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000025d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000025e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000025f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002600: 3237 206d 7469 6d65 3d31 3730 3930 3334  27 mtime=1709034
-00002610: 3838 352e 3932 3534 3435 0a00 0000 0000  885.925445......
+00002600: 3238 206d 7469 6d65 3d31 3731 3531 3834  28 mtime=1715184
+00002610: 3235 382e 3231 3436 3333 370a 0000 0000  258.2146337.....
 00002620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -634,24 +634,24 @@
 00002790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000027a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000027b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000027c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000027d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000027e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000027f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002800: 7373 686e 7064 2d30 2e34 2e35 2f73 7368  sshnpd-0.4.5/ssh
+00002800: 7373 686e 7064 2d30 2e34 2e36 2f73 7368  sshnpd-0.4.6/ssh
 00002810: 6e70 642e 7079 0000 0000 0000 0000 0000  npd.py..........
 00002820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002860: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
 00002870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00002880: 3030 3436 3331 3000 3134 3536 3733 3436  0046310.14567346
-00002890: 3630 3600 3031 3136 3436 0020 3000 0000  606.011646. 0...
+00002880: 3030 3332 3135 3100 3134 3631 3637 3231  0032151.14616721
+00002890: 3230 3200 3031 3136 3235 0020 3000 0000  202.011625. 0...
 000028a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000028b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000028c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000028d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000028e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000028f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -666,1243 +666,1243 @@
 00002990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002a00: 2321 2f62 696e 2f65 6e76 2070 7974 686f  #!/bin/env pytho
-00002a10: 6e33 0a69 6d70 6f72 7420 6f73 2c20 7468  n3.import os, th
-00002a20: 7265 6164 696e 672c 2067 6574 7061 7373  reading, getpass
-00002a30: 2c20 6a73 6f6e 2c20 6c6f 6767 696e 672c  , json, logging,
-00002a40: 2073 7562 7072 6f63 6573 732c 2061 7267   subprocess, arg
-00002a50: 7061 7273 652c 2065 7272 6e6f 0a66 726f  parse, errno.fro
-00002a60: 6d20 696f 2069 6d70 6f72 7420 5374 7269  m io import Stri
-00002a70: 6e67 494f 0a66 726f 6d20 7175 6575 6520  ngIO.from queue 
-00002a80: 696d 706f 7274 2045 6d70 7479 2c20 5175  import Empty, Qu
-00002a90: 6575 650a 6672 6f6d 2074 696d 6520 696d  eue.from time im
-00002aa0: 706f 7274 2073 6c65 6570 0a66 726f 6d20  port sleep.from 
-00002ab0: 7468 7265 6164 696e 6720 696d 706f 7274  threading import
-00002ac0: 2045 7665 6e74 0a66 726f 6d20 7061 7261   Event.from para
-00002ad0: 6d69 6b6f 2069 6d70 6f72 7420 5353 4843  miko import SSHC
-00002ae0: 6c69 656e 742c 2053 5348 4578 6365 7074  lient, SSHExcept
-00002af0: 696f 6e2c 2057 6172 6e69 6e67 506f 6c69  ion, WarningPoli
-00002b00: 6379 0a66 726f 6d20 7061 7261 6d69 6b6f  cy.from paramiko
-00002b10: 2e65 6432 3535 3139 6b65 7920 696d 706f  .ed25519key impo
-00002b20: 7274 2045 6432 3535 3139 4b65 790a 0a66  rt Ed25519Key..f
-00002b30: 726f 6d20 7365 6c65 6374 2069 6d70 6f72  rom select impor
-00002b40: 7420 7365 6c65 6374 0a66 726f 6d20 736f  t select.from so
-00002b50: 636b 6574 2069 6d70 6f72 7420 736f 636b  cket import sock
-00002b60: 6574 2c20 6765 7468 6f73 7462 796e 616d  et, gethostbynam
-00002b70: 652c 2067 6574 686f 7374 6e61 6d65 2c20  e, gethostname, 
-00002b80: 6372 6561 7465 5f63 6f6e 6e65 6374 696f  create_connectio
-00002b90: 6e2c 2065 7272 6f72 0a0a 6672 6f6d 2061  n, error..from a
-00002ba0: 745f 636c 6965 6e74 2069 6d70 6f72 7420  t_client import 
-00002bb0: 4174 436c 6965 6e74 0a66 726f 6d20 6174  AtClient.from at
-00002bc0: 5f63 6c69 656e 742e 636f 6d6d 6f6e 2069  _client.common i
-00002bd0: 6d70 6f72 7420 4174 5369 676e 0a66 726f  mport AtSign.fro
-00002be0: 6d20 6174 5f63 6c69 656e 742e 7574 696c  m at_client.util
-00002bf0: 2069 6d70 6f72 7420 456e 6372 7970 7469   import Encrypti
-00002c00: 6f6e 5574 696c 2c20 4b65 7973 5574 696c  onUtil, KeysUtil
-00002c10: 0a66 726f 6d20 6174 5f63 6c69 656e 742e  .from at_client.
-00002c20: 636f 6d6d 6f6e 2e6b 6579 7320 696d 706f  common.keys impo
-00002c30: 7274 2041 744b 6579 2c20 4d65 7461 6461  rt AtKey, Metada
-00002c40: 7461 2c20 5368 6172 6564 4b65 790a 6672  ta, SharedKey.fr
-00002c50: 6f6d 2061 745f 636c 6965 6e74 2e63 6f6e  om at_client.con
-00002c60: 6e65 6374 696f 6e73 2e6e 6f74 6966 6963  nections.notific
-00002c70: 6174 696f 6e2e 6174 6576 656e 7473 2069  ation.atevents i
-00002c80: 6d70 6f72 7420 4174 4576 656e 742c 2041  mport AtEvent, A
-00002c90: 7445 7665 6e74 5479 7065 0a0a 0a63 6c61  tEventType...cla
-00002ca0: 7373 2053 6f63 6b65 7443 6f6e 6e65 6374  ss SocketConnect
-00002cb0: 6f72 3a0a 2020 2020 5f6c 6f67 6765 7220  or:.    _logger 
-00002cc0: 3d20 6c6f 6767 696e 672e 6765 744c 6f67  = logging.getLog
-00002cd0: 6765 7228 2273 7368 7276 207c 2073 6f63  ger("sshrv | soc
-00002ce0: 6b65 745f 636f 6e6e 6563 746f 7222 290a  ket_connector").
-00002cf0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00002d00: 2873 656c 662c 2073 6572 7665 7231 5f69  (self, server1_i
-00002d10: 702c 2073 6572 7665 7231 5f70 6f72 742c  p, server1_port,
-00002d20: 2073 6572 7665 7232 5f69 702c 2073 6572   server2_ip, ser
-00002d30: 7665 7232 5f70 6f72 742c 2076 6572 626f  ver2_port, verbo
-00002d40: 7365 203d 2046 616c 7365 293a 0a20 2020  se = False):.   
-00002d50: 2020 2020 2073 656c 662e 5f6c 6f67 6765       self._logge
-00002d60: 722e 7365 744c 6576 656c 286c 6f67 6769  r.setLevel(loggi
-00002d70: 6e67 2e49 4e46 4f29 0a20 2020 2020 2020  ng.INFO).       
-00002d80: 2073 656c 662e 5f6c 6f67 6765 722e 6164   self._logger.ad
-00002d90: 6448 616e 646c 6572 286c 6f67 6769 6e67  dHandler(logging
-00002da0: 2e53 7472 6561 6d48 616e 646c 6572 2829  .StreamHandler()
-00002db0: 290a 2020 2020 2020 2020 6966 2076 6572  ).        if ver
-00002dc0: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
-00002dd0: 2020 7365 6c66 2e5f 6c6f 6767 6572 2e73    self._logger.s
-00002de0: 6574 4c65 7665 6c28 6c6f 6767 696e 672e  etLevel(logging.
-00002df0: 4445 4255 4729 0a20 2020 2020 2020 200a  DEBUG).        .
-00002e00: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
-00002e10: 2073 6f63 6b65 7473 2066 6f72 2062 6f74   sockets for bot
-00002e20: 6820 7365 7276 6572 730a 2020 2020 2020  h servers.      
-00002e30: 2020 7365 6c66 2e73 6f63 6b65 7441 203d    self.socketA =
-00002e40: 2063 7265 6174 655f 636f 6e6e 6563 7469   create_connecti
-00002e50: 6f6e 2828 7365 7276 6572 315f 6970 2c20  on((server1_ip, 
-00002e60: 7365 7276 6572 315f 706f 7274 2929 0a20  server1_port)). 
-00002e70: 2020 2020 2020 2073 656c 662e 736f 636b         self.sock
-00002e80: 6574 4220 3d20 6372 6561 7465 5f63 6f6e  etB = create_con
-00002e90: 6e65 6374 696f 6e28 2873 6572 7665 7232  nection((server2
-00002ea0: 5f69 702c 2073 6572 7665 7232 5f70 6f72  _ip, server2_por
-00002eb0: 7429 290a 2020 2020 2020 2020 7365 6c66  t)).        self
-00002ec0: 2e73 6f63 6b65 7441 2e73 6574 626c 6f63  .socketA.setbloc
-00002ed0: 6b69 6e67 2830 290a 2020 2020 2020 2020  king(0).        
-00002ee0: 7365 6c66 2e73 6f63 6b65 7442 2e73 6574  self.socketB.set
-00002ef0: 626c 6f63 6b69 6e67 2830 290a 2020 2020  blocking(0).    
-00002f00: 2020 2020 7365 6c66 2e5f 6c6f 6767 6572      self._logger
-00002f10: 2e69 6e66 6f28 2253 6f63 6b65 7473 2063  .info("Sockets c
-00002f20: 6f6e 6e65 6374 6564 2e22 290a 2020 2020  onnected.").    
-00002f30: 2020 2020 7365 6c66 2e5f 6c6f 6767 6572      self._logger
-00002f40: 2e64 6562 7567 2866 2243 7265 6174 6564  .debug(f"Created
-00002f50: 2073 6f63 6b65 7473 2066 6f72 207b 7365   sockets for {se
-00002f60: 7276 6572 315f 6970 7d3a 7b73 6572 7665  rver1_ip}:{serve
-00002f70: 7231 5f70 6f72 747d 2061 6e64 207b 7365  r1_port} and {se
-00002f80: 7276 6572 325f 6970 7d3a 7b73 6572 7665  rver2_ip}:{serve
-00002f90: 7232 5f70 6f72 747d 2229 0a20 2020 2020  r2_port}").     
-00002fa0: 2020 2073 656c 662e 7365 7276 6572 315f     self.server1_
-00002fb0: 6970 203d 2073 6572 7665 7231 5f69 700a  ip = server1_ip.
-00002fc0: 2020 2020 2020 2020 7365 6c66 2e73 6572          self.ser
-00002fd0: 7665 7231 5f70 6f72 7420 3d20 7365 7276  ver1_port = serv
-00002fe0: 6572 315f 706f 7274 0a20 2020 2020 2020  er1_port.       
-00002ff0: 2073 656c 662e 7365 7276 6572 325f 6970   self.server2_ip
-00003000: 203d 2073 6572 7665 7232 5f69 700a 2020   = server2_ip.  
-00003010: 2020 2020 2020 7365 6c66 2e73 6572 7665        self.serve
-00003020: 7232 5f70 6f72 7420 3d20 7365 7276 6572  r2_port = server
-00003030: 325f 706f 7274 0a0a 2020 2020 6465 6620  2_port..    def 
-00003040: 636f 6e6e 6563 7428 7365 6c66 293a 0a20  connect(self):. 
-00003050: 2020 2020 2020 2073 6f63 6b65 7473 5f74         sockets_t
-00003060: 6f5f 6d6f 6e69 746f 7220 3d20 5b73 656c  o_monitor = [sel
-00003070: 662e 736f 636b 6574 412c 2073 656c 662e  f.socketA, self.
-00003080: 736f 636b 6574 425d 0a20 2020 2020 2020  socketB].       
-00003090: 2074 696d 656f 7574 203d 2030 0a20 2020   timeout = 0.   
-000030a0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-000030b0: 2020 2020 2020 7768 696c 6520 5472 7565        while True
-000030c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000030d0: 2020 666f 7220 736f 636b 2069 6e20 736f    for sock in so
-000030e0: 636b 6574 735f 746f 5f6d 6f6e 6974 6f72  ckets_to_monitor
-000030f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00003100: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00003110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003120: 2020 2064 6174 6120 3d20 736f 636b 2e72     data = sock.r
-00003130: 6563 7628 3130 3234 290a 2020 2020 2020  ecv(1024).      
-00003140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003150: 2020 6966 206e 6f74 2064 6174 6120 616e    if not data an
-00003160: 6420 7469 6d65 6f75 7420 3e20 3130 303a  d timeout > 100:
-00003170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003180: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00003190: 6e74 2822 436f 6e6e 6563 7469 6f6e 2063  nt("Connection c
-000031a0: 6c6f 7365 642e 2229 0a20 2020 2020 2020  losed.").       
-000031b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000031c0: 2020 2020 2073 6f63 6b65 7473 5f74 6f5f       sockets_to_
-000031d0: 6d6f 6e69 746f 722e 7265 6d6f 7665 2873  monitor.remove(s
-000031e0: 6f63 6b29 0a20 2020 2020 2020 2020 2020  ock).           
-000031f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003200: 2073 6f63 6b2e 636c 6f73 6528 290a 2020   sock.close().  
+00002a00: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+00002a10: 7974 686f 6e33 0a69 6d70 6f72 7420 6172  ython3.import ar
+00002a20: 6770 6172 7365 0a69 6d70 6f72 7420 6572  gparse.import er
+00002a30: 726e 6f0a 696d 706f 7274 2067 6574 7061  rno.import getpa
+00002a40: 7373 0a69 6d70 6f72 7420 6a73 6f6e 0a69  ss.import json.i
+00002a50: 6d70 6f72 7420 6c6f 6767 696e 670a 696d  mport logging.im
+00002a60: 706f 7274 206f 730a 696d 706f 7274 2073  port os.import s
+00002a70: 7562 7072 6f63 6573 730a 696d 706f 7274  ubprocess.import
+00002a80: 2073 7973 0a69 6d70 6f72 7420 7468 7265   sys.import thre
+00002a90: 6164 696e 670a 6672 6f6d 2071 7565 7565  ading.from queue
+00002aa0: 2069 6d70 6f72 7420 456d 7074 792c 2051   import Empty, Q
+00002ab0: 7565 7565 0a66 726f 6d20 7469 6d65 2069  ueue.from time i
+00002ac0: 6d70 6f72 7420 736c 6565 700a 0a66 726f  mport sleep..fro
+00002ad0: 6d20 736f 636b 6574 2069 6d70 6f72 7420  m socket import 
+00002ae0: 6765 7468 6f73 7462 796e 616d 652c 2063  gethostbyname, c
+00002af0: 7265 6174 655f 636f 6e6e 6563 7469 6f6e  reate_connection
+00002b00: 2c20 6572 726f 720a 0a66 726f 6d20 6174  , error..from at
+00002b10: 5f63 6c69 656e 7420 696d 706f 7274 2041  _client import A
+00002b20: 7443 6c69 656e 740a 6672 6f6d 2061 745f  tClient.from at_
+00002b30: 636c 6965 6e74 2e63 6f6d 6d6f 6e20 696d  client.common im
+00002b40: 706f 7274 2041 7453 6967 6e0a 6672 6f6d  port AtSign.from
+00002b50: 2061 745f 636c 6965 6e74 2e75 7469 6c20   at_client.util 
+00002b60: 696d 706f 7274 2045 6e63 7279 7074 696f  import Encryptio
+00002b70: 6e55 7469 6c2c 204b 6579 7355 7469 6c0a  nUtil, KeysUtil.
+00002b80: 6672 6f6d 2061 745f 636c 6965 6e74 2e63  from at_client.c
+00002b90: 6f6d 6d6f 6e2e 6b65 7973 2069 6d70 6f72  ommon.keys impor
+00002ba0: 7420 4174 4b65 792c 204d 6574 6164 6174  t AtKey, Metadat
+00002bb0: 612c 2053 6861 7265 644b 6579 0a66 726f  a, SharedKey.fro
+00002bc0: 6d20 6174 5f63 6c69 656e 742e 636f 6e6e  m at_client.conn
+00002bd0: 6563 7469 6f6e 732e 6e6f 7469 6669 6361  ections.notifica
+00002be0: 7469 6f6e 2e61 7465 7665 6e74 7320 696d  tion.atevents im
+00002bf0: 706f 7274 2041 7445 7665 6e74 2c20 4174  port AtEvent, At
+00002c00: 4576 656e 7454 7970 650a 0a0a 636c 6173  EventType...clas
+00002c10: 7320 536f 636b 6574 436f 6e6e 6563 746f  s SocketConnecto
+00002c20: 723a 0a20 2020 205f 6c6f 6767 6572 203d  r:.    _logger =
+00002c30: 206c 6f67 6769 6e67 2e67 6574 4c6f 6767   logging.getLogg
+00002c40: 6572 2822 7373 6872 7620 7c20 736f 636b  er("sshrv | sock
+00002c50: 6574 5f63 6f6e 6e65 6374 6f72 2229 0a0a  et_connector")..
+00002c60: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+00002c70: 2873 656c 662c 2073 6572 7665 7231 5f69  (self, server1_i
+00002c80: 702c 2073 6572 7665 7231 5f70 6f72 742c  p, server1_port,
+00002c90: 2073 6572 7665 7232 5f69 702c 2073 6572   server2_ip, ser
+00002ca0: 7665 7232 5f70 6f72 742c 2076 6572 626f  ver2_port, verbo
+00002cb0: 7365 3d46 616c 7365 293a 0a20 2020 2020  se=False):.     
+00002cc0: 2020 2073 656c 662e 5f6c 6f67 6765 722e     self._logger.
+00002cd0: 7365 744c 6576 656c 286c 6f67 6769 6e67  setLevel(logging
+00002ce0: 2e49 4e46 4f29 0a20 2020 2020 2020 2073  .INFO).        s
+00002cf0: 656c 662e 5f6c 6f67 6765 722e 6164 6448  elf._logger.addH
+00002d00: 616e 646c 6572 286c 6f67 6769 6e67 2e53  andler(logging.S
+00002d10: 7472 6561 6d48 616e 646c 6572 2829 290a  treamHandler()).
+00002d20: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+00002d30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00002d40: 7365 6c66 2e5f 6c6f 6767 6572 2e73 6574  self._logger.set
+00002d50: 4c65 7665 6c28 6c6f 6767 696e 672e 4445  Level(logging.DE
+00002d60: 4255 4729 0a20 2020 2020 2020 2023 2043  BUG).        # C
+00002d70: 7265 6174 6520 736f 636b 6574 7320 666f  reate sockets fo
+00002d80: 7220 626f 7468 2073 6572 7665 7273 0a20  r both servers. 
+00002d90: 2020 2020 2020 2073 656c 662e 736f 636b         self.sock
+00002da0: 6574 4120 3d20 6372 6561 7465 5f63 6f6e  etA = create_con
+00002db0: 6e65 6374 696f 6e28 2873 6572 7665 7231  nection((server1
+00002dc0: 5f69 702c 2073 6572 7665 7231 5f70 6f72  _ip, server1_por
+00002dd0: 7429 290a 2020 2020 2020 2020 7365 6c66  t)).        self
+00002de0: 2e73 6f63 6b65 7442 203d 2063 7265 6174  .socketB = creat
+00002df0: 655f 636f 6e6e 6563 7469 6f6e 2828 7365  e_connection((se
+00002e00: 7276 6572 325f 6970 2c20 7365 7276 6572  rver2_ip, server
+00002e10: 325f 706f 7274 2929 0a20 2020 2020 2020  2_port)).       
+00002e20: 2073 656c 662e 736f 636b 6574 412e 7365   self.socketA.se
+00002e30: 7462 6c6f 636b 696e 6728 3029 0a20 2020  tblocking(0).   
+00002e40: 2020 2020 2073 656c 662e 736f 636b 6574       self.socket
+00002e50: 422e 7365 7462 6c6f 636b 696e 6728 3029  B.setblocking(0)
+00002e60: 0a20 2020 2020 2020 2073 656c 662e 5f6c  .        self._l
+00002e70: 6f67 6765 722e 6465 6275 6728 6622 4372  ogger.debug(f"Cr
+00002e80: 6561 7465 6420 736f 636b 6574 7320 666f  eated sockets fo
+00002e90: 7220 7b73 6572 7665 7231 5f69 707d 3a7b  r {server1_ip}:{
+00002ea0: 7365 7276 6572 315f 706f 7274 7d20 616e  server1_port} an
+00002eb0: 6420 7b73 6572 7665 7232 5f69 707d 3a7b  d {server2_ip}:{
+00002ec0: 7365 7276 6572 325f 706f 7274 7d22 290a  server2_port}").
+00002ed0: 2020 2020 2020 2020 7365 6c66 2e73 6572          self.ser
+00002ee0: 7665 7231 5f69 7020 3d20 7365 7276 6572  ver1_ip = server
+00002ef0: 315f 6970 0a20 2020 2020 2020 2073 656c  1_ip.        sel
+00002f00: 662e 7365 7276 6572 315f 706f 7274 203d  f.server1_port =
+00002f10: 2073 6572 7665 7231 5f70 6f72 740a 2020   server1_port.  
+00002f20: 2020 2020 2020 7365 6c66 2e73 6572 7665        self.serve
+00002f30: 7232 5f69 7020 3d20 7365 7276 6572 325f  r2_ip = server2_
+00002f40: 6970 0a20 2020 2020 2020 2073 656c 662e  ip.        self.
+00002f50: 7365 7276 6572 325f 706f 7274 203d 2073  server2_port = s
+00002f60: 6572 7665 7232 5f70 6f72 740a 0a20 2020  erver2_port..   
+00002f70: 2064 6566 2063 6f6e 6e65 6374 2873 656c   def connect(sel
+00002f80: 6629 3a0a 2020 2020 2020 2020 736f 636b  f):.        sock
+00002f90: 6574 735f 746f 5f6d 6f6e 6974 6f72 203d  ets_to_monitor =
+00002fa0: 205b 7365 6c66 2e73 6f63 6b65 7441 2c20   [self.socketA, 
+00002fb0: 7365 6c66 2e73 6f63 6b65 7442 5d0a 2020  self.socketB].  
+00002fc0: 2020 2020 2020 7469 6d65 6f75 7420 3d20        timeout = 
+00002fd0: 300a 2020 2020 2020 2020 7472 793a 0a20  0.        try:. 
+00002fe0: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+00002ff0: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
+00003000: 2020 2020 2020 2066 6f72 2073 6f63 6b20         for sock 
+00003010: 696e 2073 6f63 6b65 7473 5f74 6f5f 6d6f  in sockets_to_mo
+00003020: 6e69 746f 723a 0a20 2020 2020 2020 2020  nitor:.         
+00003030: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00003040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003050: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
+00003060: 6f63 6b2e 7265 6376 2831 3032 3429 0a20  ock.recv(1024). 
+00003070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003080: 2020 2020 2020 2069 6620 6e6f 7420 6461         if not da
+00003090: 7461 2061 6e64 2074 696d 656f 7574 203e  ta and timeout >
+000030a0: 2031 3030 3a0a 2020 2020 2020 2020 2020   100:.          
+000030b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030c0: 2020 7072 696e 7428 2243 6f6e 6e65 6374    print("Connect
+000030d0: 696f 6e20 636c 6f73 6564 2e22 290a 2020  ion closed.").  
+000030e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030f0: 2020 2020 2020 2020 2020 736f 636b 6574            socket
+00003100: 735f 746f 5f6d 6f6e 6974 6f72 2e72 656d  s_to_monitor.rem
+00003110: 6f76 6528 736f 636b 290a 2020 2020 2020  ove(sock).      
+00003120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003130: 2020 2020 2020 736f 636b 2e63 6c6f 7365        sock.close
+00003140: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00003150: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00003160: 6574 7572 6e0a 2020 2020 2020 2020 2020  eturn.          
+00003170: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00003180: 6966 206e 6f74 2064 6174 613a 0a20 2020  if not data:.   
+00003190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000031a0: 2020 2020 2020 2020 2074 696d 656f 7574           timeout
+000031b0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+000031c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000031d0: 2020 736c 6565 7028 302e 3129 0a20 2020    sleep(0.1).   
+000031e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000031f0: 2020 2020 2069 6620 6461 7461 203d 3d20       if data == 
+00003200: 6227 273a 0a20 2020 2020 2020 2020 2020  b'':.           
 00003210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003220: 2020 2020 2020 656c 6966 206e 6f74 2064        elif not d
-00003230: 6174 613a 200a 2020 2020 2020 2020 2020  ata: .          
-00003240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003250: 2020 7469 6d65 6f75 7420 2b3d 2031 0a20    timeout += 1. 
-00003260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003270: 2020 2020 2020 2020 2020 2073 6c65 6570             sleep
-00003280: 2830 2e31 290a 2020 2020 2020 2020 2020  (0.1).          
-00003290: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000032a0: 2064 6174 6120 3d3d 2062 2727 3a0a 2020   data == b'':.  
-000032b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000032c0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-000032d0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-000032e0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000032f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003300: 2020 2020 2020 2020 2020 2020 2023 2046               # F
-00003310: 6f72 7761 7264 2064 6174 6120 746f 2074  orward data to t
-00003320: 6865 206f 7468 6572 2073 6572 7665 720a  he other server.
-00003330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003340: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00003350: 6f63 6b20 6973 2073 656c 662e 736f 636b  ock is self.sock
-00003360: 6574 413a 0a20 2020 2020 2020 2020 2020  etA:.           
-00003370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003380: 2020 2020 2073 656c 662e 5f6c 6f67 6765       self._logge
-00003390: 722e 6465 6275 6728 2253 454e 4420 4120  r.debug("SEND A 
-000033a0: 2d3e 2042 203a 2022 202b 2073 7472 2864  -> B : " + str(d
-000033b0: 6174 6129 290a 2020 2020 2020 2020 2020  ata)).          
-000033c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000033d0: 2020 2020 2020 7365 6c66 2e73 6f63 6b65        self.socke
-000033e0: 7442 2e73 656e 6428 6461 7461 290a 2020  tB.send(data).  
-000033f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003400: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00003410: 6f63 6b20 6973 2073 656c 662e 736f 636b  ock is self.sock
-00003420: 6574 423a 0a20 2020 2020 2020 2020 2020  etB:.           
+00003220: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+00003230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003240: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00003250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003260: 2020 2020 2320 466f 7277 6172 6420 6461      # Forward da
+00003270: 7461 2074 6f20 7468 6520 6f74 6865 7220  ta to the other 
+00003280: 7365 7276 6572 0a20 2020 2020 2020 2020  server.         
+00003290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000032a0: 2020 2069 6620 736f 636b 2069 7320 7365     if sock is se
+000032b0: 6c66 2e73 6f63 6b65 7441 3a0a 2020 2020  lf.socketA:.    
+000032c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000032d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000032e0: 2e5f 6c6f 6767 6572 2e64 6562 7567 2822  ._logger.debug("
+000032f0: 5345 4e44 2041 202d 3e20 4220 3a20 2220  SEND A -> B : " 
+00003300: 2b20 7374 7228 6461 7461 2929 0a20 2020  + str(data)).   
+00003310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003320: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00003330: 662e 736f 636b 6574 422e 7365 6e64 2864  f.socketB.send(d
+00003340: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
+00003350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003360: 2065 6c69 6620 736f 636b 2069 7320 7365   elif sock is se
+00003370: 6c66 2e73 6f63 6b65 7442 3a0a 2020 2020  lf.socketB:.    
+00003380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003390: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000033a0: 2e5f 6c6f 6767 6572 2e64 6562 7567 2822  ._logger.debug("
+000033b0: 5245 4356 2042 202d 3e20 4120 3a20 2220  RECV B -> A : " 
+000033c0: 2b20 7374 7228 6461 7461 2929 0a20 2020  + str(data)).   
+000033d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000033e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000033f0: 662e 736f 636b 6574 412e 7365 6e64 2864  f.socketA.send(d
+00003400: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
+00003410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003420: 2074 696d 656f 7574 203d 2030 0a20 2020   timeout = 0.   
 00003430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003440: 2020 2020 2073 656c 662e 5f6c 6f67 6765       self._logge
-00003450: 722e 6465 6275 6728 2252 4543 5620 4220  r.debug("RECV B 
-00003460: 2d3e 2041 203a 2022 202b 2073 7472 2864  -> A : " + str(d
-00003470: 6174 6129 290a 2020 2020 2020 2020 2020  ata)).          
-00003480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003490: 2020 2020 2020 7365 6c66 2e73 6f63 6b65        self.socke
-000034a0: 7441 2e73 656e 6428 6461 7461 290a 2020  tA.send(data).  
-000034b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034c0: 2020 2020 2020 2020 2020 7469 6d65 6f75            timeou
-000034d0: 7420 3d20 300a 2020 2020 2020 2020 2020  t = 0.          
-000034e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034f0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00003500: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00003510: 7420 6572 726f 7220 6173 2065 3a0a 2020  t error as e:.  
-00003520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003530: 2020 2020 2020 6966 2065 2e65 7272 6e6f        if e.errno
-00003540: 203d 3d20 6572 726e 6f2e 4557 4f55 4c44   == errno.EWOULD
-00003550: 424c 4f43 4b3a 0a20 2020 2020 2020 2020  BLOCK:.         
-00003560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003570: 2020 2070 6173 7320 2023 204e 6f20 6461     pass  # No da
-00003580: 7461 2061 7661 696c 6162 6c65 2c20 636f  ta available, co
-00003590: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
-000035a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000035b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000035c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035d0: 2072 6169 7365 2020 2020 2020 2020 0a20   raise        . 
-000035e0: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
-000035f0: 6365 7074 696f 6e20 6173 2065 3a0a 2020  ception as e:.  
-00003600: 2020 2020 2020 2020 2020 7261 6973 6528            raise(
-00003610: 6529 0a0a 2020 2020 6465 6620 636c 6f73  e)..    def clos
-00003620: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00003630: 2073 656c 662e 736f 636b 6574 412e 636c   self.socketA.cl
-00003640: 6f73 6528 290a 2020 2020 2020 2020 7365  ose().        se
-00003650: 6c66 2e73 6f63 6b65 7442 2e63 6c6f 7365  lf.socketB.close
-00003660: 2829 0a0a 0a63 6c61 7373 2053 5348 5256  ()...class SSHRV
-00003670: 3a0a 2020 2020 6465 6620 5f5f 696e 6974  :.    def __init
-00003680: 5f5f 2873 656c 662c 2064 6573 7469 6e61  __(self, destina
-00003690: 7469 6f6e 2c20 706f 7274 2c20 6c6f 6361  tion, port, loca
-000036a0: 6c5f 706f 7274 203d 2032 322c 2076 6572  l_port = 22, ver
-000036b0: 626f 7365 203d 2046 616c 7365 293a 0a20  bose = False):. 
-000036c0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-000036d0: 6572 203d 206c 6f67 6769 6e67 2e67 6574  er = logging.get
-000036e0: 4c6f 6767 6572 2822 7373 6872 7622 290a  Logger("sshrv").
-000036f0: 2020 2020 2020 2020 7365 6c66 2e68 6f73          self.hos
-00003700: 7420 3d20 2222 0a20 2020 2020 2020 2073  t = "".        s
-00003710: 656c 662e 6465 7374 696e 6174 696f 6e20  elf.destination 
-00003720: 3d20 6465 7374 696e 6174 696f 6e0a 2020  = destination.  
-00003730: 2020 2020 2020 7365 6c66 2e6c 6f63 616c        self.local
-00003740: 5f73 7368 5f70 6f72 7420 3d20 6c6f 6361  _ssh_port = loca
-00003750: 6c5f 706f 7274 0a20 2020 2020 2020 2073  l_port.        s
-00003760: 656c 662e 7374 7265 616d 696e 675f 706f  elf.streaming_po
-00003770: 7274 203d 2070 6f72 740a 2020 2020 2020  rt = port.      
-00003780: 2020 7365 6c66 2e73 6f63 6b65 745f 636f    self.socket_co
-00003790: 6e6e 6563 746f 7220 3d20 4e6f 6e65 0a20  nnector = None. 
-000037a0: 2020 2020 2020 2073 656c 662e 7665 7262         self.verb
-000037b0: 6f73 6520 3d20 7665 7262 6f73 650a 0a20  ose = verbose.. 
-000037c0: 2020 2064 6566 2072 756e 2873 656c 6629     def run(self)
-000037d0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-000037e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000037f0: 686f 7374 203d 2067 6574 686f 7374 6279  host = gethostby
-00003800: 6e61 6d65 2867 6574 686f 7374 6e61 6d65  name(gethostname
-00003810: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-00003820: 736f 636b 6574 5f63 6f6e 6e65 6374 6f72  socket_connector
-00003830: 203d 2053 6f63 6b65 7443 6f6e 6e65 6374   = SocketConnect
-00003840: 6f72 2873 656c 662e 686f 7374 2c20 7365  or(self.host, se
-00003850: 6c66 2e6c 6f63 616c 5f73 7368 5f70 6f72  lf.local_ssh_por
-00003860: 742c 2073 656c 662e 6465 7374 696e 6174  t, self.destinat
-00003870: 696f 6e2c 2073 656c 662e 7374 7265 616d  ion, self.stream
-00003880: 696e 675f 706f 7274 2c20 7665 7262 6f73  ing_port, verbos
-00003890: 653d 7365 6c66 2e76 6572 626f 7365 290a  e=self.verbose).
-000038a0: 2020 2020 2020 2020 2020 2020 7431 203d              t1 =
-000038b0: 2074 6872 6561 6469 6e67 2e54 6872 6561   threading.Threa
-000038c0: 6428 7461 7267 6574 3d73 6f63 6b65 745f  d(target=socket_
-000038d0: 636f 6e6e 6563 746f 722e 636f 6e6e 6563  connector.connec
-000038e0: 7429 0a20 2020 2020 2020 2020 2020 2074  t).            t
-000038f0: 312e 7374 6172 7428 290a 2020 2020 2020  1.start().      
-00003900: 2020 2020 2020 7365 6c66 2e73 6f63 6b65        self.socke
-00003910: 745f 636f 6e6e 6563 746f 7220 3d20 7431  t_connector = t1
-00003920: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00003930: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
-00003940: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-00003950: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00003960: 6f6e 2061 7320 653a 0a20 2020 2020 2020  on as e:.       
-00003970: 2020 2020 206c 6f67 6769 6e67 2e65 7272       logging.err
-00003980: 6f72 2822 5353 4852 5620 4572 726f 723a  or("SSHRV Error:
-00003990: 2022 202b 2073 7472 2865 2929 0a20 2020   " + str(e)).   
-000039a0: 2020 2020 2020 2020 200a 2020 2020 6465           .    de
-000039b0: 6620 6973 5f61 6c69 7665 2873 656c 6629  f is_alive(self)
-000039c0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000039d0: 2073 656c 662e 736f 636b 6574 5f63 6f6e   self.socket_con
-000039e0: 6e65 6374 6f72 2e69 735f 616c 6976 6528  nector.is_alive(
-000039f0: 290a 0a0a 636c 6173 7320 5353 484e 5044  )...class SSHNPD
-00003a00: 436c 6965 6e74 3a0a 2020 2020 2343 7572  Client:.    #Cur
-00003a10: 7265 6e74 206f 7065 6e65 6420 7468 7265  rent opened thre
-00003a20: 6164 730a 2020 2020 7468 7265 6164 7320  ads.    threads 
-00003a30: 3d20 5b5d 0a0a 2020 2020 6465 6620 5f5f  = []..    def __
-00003a40: 696e 6974 5f5f 2873 656c 662c 2061 7473  init__(self, ats
-00003a50: 6967 6e2c 206d 616e 6167 6572 5f61 7473  ign, manager_ats
-00003a60: 6967 6e2c 2064 6576 6963 652c 2075 7365  ign, device, use
-00003a70: 726e 616d 653d 4e6f 6e65 2c20 7665 7262  rname=None, verb
-00003a80: 6f73 653d 4661 6c73 652c 2065 7870 6563  ose=False, expec
-00003a90: 7469 6e67 5f73 7368 5f6b 6579 7320 3d20  ting_ssh_keys = 
-00003aa0: 4661 6c73 6529 3a20 200a 2020 2020 2020  False):  .      
-00003ab0: 2020 2354 6872 6561 6469 6e67 2053 7475    #Threading Stu
-00003ac0: 6666 0a20 2020 2020 2020 2073 656c 662e  ff.        self.
-00003ad0: 636c 6f73 696e 6720 3d20 4576 656e 7428  closing = Event(
-00003ae0: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-00003af0: 6c6f 7369 6e67 2e63 6c65 6172 2829 0a20  losing.clear(). 
-00003b00: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00003b10: 2341 7443 6c69 656e 7420 5374 7566 660a  #AtClient Stuff.
-00003b20: 2020 2020 2020 2020 7365 6c66 2e61 7473          self.ats
-00003b30: 6967 6e20 3d20 6174 7369 676e 0a20 2020  ign = atsign.   
-00003b40: 2020 2020 2073 656c 662e 6d61 6e61 6765       self.manage
-00003b50: 725f 6174 7369 676e 203d 206d 616e 6167  r_atsign = manag
-00003b60: 6572 5f61 7473 6967 6e0a 2020 2020 2020  er_atsign.      
-00003b70: 2020 7365 6c66 2e64 6576 6963 6520 3d20    self.device = 
-00003b80: 6465 7669 6365 0a20 2020 2020 2020 2073  device.        s
-00003b90: 656c 662e 7573 6572 6e61 6d65 203d 2075  elf.username = u
-00003ba0: 7365 726e 616d 650a 2020 2020 2020 2020  sername.        
-00003bb0: 7365 6c66 2e64 6576 6963 655f 6e61 6d65  self.device_name
-00003bc0: 7370 6163 6520 3d20 6622 2e7b 6465 7669  space = f".{devi
-00003bd0: 6365 7d2e 7373 686e 7022 0a20 2020 2020  ce}.sshnp".     
-00003be0: 2020 2073 656c 662e 6174 5f63 6c69 656e     self.at_clien
-00003bf0: 7420 3d20 4174 436c 6965 6e74 2841 7453  t = AtClient(AtS
-00003c00: 6967 6e28 6174 7369 676e 292c 2071 7565  ign(atsign), que
-00003c10: 7565 3d51 7565 7565 286d 6178 7369 7a65  ue=Queue(maxsize
-00003c20: 3d32 3029 2c20 7665 7262 6f73 653d 7665  =20), verbose=ve
-00003c30: 7262 6f73 6529 0a20 2020 2020 2020 200a  rbose).        .
-00003c40: 2020 2020 2020 2020 2353 5348 2053 7475          #SSH Stu
-00003c50: 6666 0a20 2020 2020 2020 2073 656c 662e  ff.        self.
-00003c60: 7373 685f 636c 6965 6e74 203d 204e 6f6e  ssh_client = Non
-00003c70: 650a 2020 2020 2020 2020 7365 6c66 2e61  e.        self.a
-00003c80: 7574 6865 6e74 6963 6174 6564 203d 2046  uthenticated = F
-00003c90: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
-00003ca0: 662e 7276 203d 204e 6f6e 650a 2020 2020  f.rv = None.    
-00003cb0: 2020 2020 7365 6c66 2e65 7870 6563 7469      self.expecti
-00003cc0: 6e67 5f73 7368 5f6b 6579 7320 3d20 6578  ng_ssh_keys = ex
-00003cd0: 7065 6374 696e 675f 7373 685f 6b65 7973  pecting_ssh_keys
-00003ce0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00003cf0: 2020 234c 6f67 6765 720a 2020 2020 2020    #Logger.      
-00003d00: 2020 7365 6c66 2e6c 6f67 6765 7220 3d20    self.logger = 
-00003d10: 6c6f 6767 696e 672e 6765 744c 6f67 6765  logging.getLogge
-00003d20: 7228 2273 7368 6e70 6422 290a 2020 2020  r("sshnpd").    
-00003d30: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-00003d40: 7365 744c 6576 656c 2828 6c6f 6767 696e  setLevel((loggin
-00003d50: 672e 4445 4255 4720 6966 2076 6572 626f  g.DEBUG if verbo
-00003d60: 7365 2065 6c73 6520 6c6f 6767 696e 672e  se else logging.
-00003d70: 494e 464f 2929 0a20 2020 2020 2020 2073  INFO)).        s
-00003d80: 656c 662e 6c6f 6767 6572 2e61 6464 4861  elf.logger.addHa
-00003d90: 6e64 6c65 7228 6c6f 6767 696e 672e 5374  ndler(logging.St
-00003da0: 7265 616d 4861 6e64 6c65 7228 2929 0a20  reamHandler()). 
-00003db0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00003dc0: 2344 6972 6563 746f 7279 2053 7475 6666  #Directory Stuff
-00003dd0: 0a20 2020 2020 2020 2068 6f6d 655f 6469  .        home_di
-00003de0: 7220 3d20 2222 0a20 2020 2020 2020 2069  r = "".        i
-00003df0: 6620 6f73 2e6e 616d 6520 3d3d 2022 706f  f os.name == "po
-00003e00: 7369 7822 3a20 2023 2055 6e69 782d 6261  six":  # Unix-ba
-00003e10: 7365 6420 7379 7374 656d 7320 284c 696e  sed systems (Lin
-00003e20: 7578 2c20 6d61 634f 5329 0a20 2020 2020  ux, macOS).     
-00003e30: 2020 2020 2020 2068 6f6d 655f 6469 7220         home_dir 
-00003e40: 3d20 6f73 2e70 6174 682e 6578 7061 6e64  = os.path.expand
-00003e50: 7573 6572 2822 7e22 290a 2020 2020 2020  user("~").      
-00003e60: 2020 656c 6966 206f 732e 6e61 6d65 203d    elif os.name =
-00003e70: 3d20 226e 7422 3a20 2023 2057 696e 646f  = "nt":  # Windo
-00003e80: 7773 0a20 2020 2020 2020 2020 2020 2068  ws.            h
-00003e90: 6f6d 655f 6469 7220 3d20 6f73 2e70 6174  ome_dir = os.pat
-00003ea0: 682e 6578 7061 6e64 7573 6572 2822 7e22  h.expanduser("~"
-00003eb0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00003ec0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00003ed0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-00003ee0: 4572 726f 7228 2255 6e73 7570 706f 7274  Error("Unsupport
-00003ef0: 6564 206f 7065 7261 7469 6e67 2073 7973  ed operating sys
-00003f00: 7465 6d22 290a 2020 2020 2020 2020 7365  tem").        se
-00003f10: 6c66 2e73 7368 5f70 6174 6820 3d20 6622  lf.ssh_path = f"
-00003f20: 7b68 6f6d 655f 6469 727d 2f2e 7373 6822  {home_dir}/.ssh"
-00003f30: 0a0a 2020 2020 6465 6620 7374 6172 7428  ..    def start(
-00003f40: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
-00003f50: 6620 7365 6c66 2e75 7365 726e 616d 653a  f self.username:
-00003f60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00003f70: 662e 5f73 6574 5f75 7365 726e 616d 6528  f._set_username(
-00003f80: 290a 2020 2020 2020 2020 7468 7265 6164  ).        thread
-00003f90: 696e 672e 5468 7265 6164 2874 6172 6765  ing.Thread(targe
-00003fa0: 743d 7365 6c66 2e61 745f 636c 6965 6e74  t=self.at_client
-00003fb0: 2e73 7461 7274 5f6d 6f6e 6974 6f72 2c20  .start_monitor, 
-00003fc0: 6172 6773 3d28 7365 6c66 2e64 6576 6963  args=(self.devic
-00003fd0: 655f 6e61 6d65 7370 6163 652c 2929 2e73  e_namespace,)).s
-00003fe0: 7461 7274 2829 0a20 2020 2020 2020 2074  tart().        t
-00003ff0: 6872 6561 6469 6e67 2e54 6872 6561 6428  hreading.Thread(
-00004000: 7461 7267 6574 3d73 656c 662e 5f68 616e  target=self._han
-00004010: 646c 655f 6e6f 7469 6669 6361 7469 6f6e  dle_notification
-00004020: 732c 2061 7267 733d 2873 656c 662e 6174  s, args=(self.at
-00004030: 5f63 6c69 656e 742e 7175 6575 652c 292c  _client.queue,),
-00004040: 2064 6165 6d6f 6e3d 5472 7565 292e 7374   daemon=True).st
-00004050: 6172 7428 290a 2020 2020 2020 2020 6576  art().        ev
-00004060: 656e 745f 7468 7265 6164 203d 2074 6872  ent_thread = thr
-00004070: 6561 6469 6e67 2e54 6872 6561 6428 7461  eading.Thread(ta
-00004080: 7267 6574 3d73 656c 662e 5f68 616e 646c  rget=self._handl
-00004090: 655f 6576 656e 7473 2c20 6172 6773 3d28  e_events, args=(
-000040a0: 7365 6c66 2e61 745f 636c 6965 6e74 2e71  self.at_client.q
-000040b0: 7565 7565 2c29 290a 2020 2020 2020 2020  ueue,)).        
-000040c0: 6576 656e 745f 7468 7265 6164 2e73 7461  event_thread.sta
-000040d0: 7274 2829 0a20 2020 2020 2020 2053 5348  rt().        SSH
-000040e0: 4e50 4443 6c69 656e 742e 7468 7265 6164  NPDClient.thread
-000040f0: 732e 6170 7065 6e64 2865 7665 6e74 5f74  s.append(event_t
-00004100: 6872 6561 6429 0a0a 2020 2020 6465 6620  hread)..    def 
-00004110: 6973 5f61 6c69 7665 2873 656c 6629 3a0a  is_alive(self):.
-00004120: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00004130: 656c 662e 6175 7468 656e 7469 6361 7465  elf.authenticate
-00004140: 643a 0a20 2020 2020 2020 2020 2020 2072  d:.            r
-00004150: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
-00004160: 2020 2065 6c69 6620 6c65 6e28 5353 484e     elif len(SSHN
-00004170: 5044 436c 6965 6e74 2e74 6872 6561 6473  PDClient.threads
-00004180: 2920 3e3d 2032 2061 6e64 2073 656c 662e  ) >= 2 and self.
-00004190: 7373 685f 636c 6965 6e74 2e67 6574 5f74  ssh_client.get_t
-000041a0: 7261 6e73 706f 7274 2829 2e69 735f 6163  ransport().is_ac
-000041b0: 7469 7665 2829 3a0a 2020 2020 2020 2020  tive():.        
-000041c0: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-000041d0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-000041e0: 662e 7276 2e69 735f 616c 6976 6528 293a  f.rv.is_alive():
-000041f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00004200: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
-00004210: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00004220: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-00004230: 0a20 2020 2064 6566 206a 6f69 6e28 7365  .    def join(se
-00004240: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
-00004250: 662e 636c 6f73 696e 672e 7365 7428 290a  f.closing.set().
-00004260: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00004270: 7373 685f 636c 6965 6e74 3a0a 2020 2020  ssh_client:.    
-00004280: 2020 2020 2020 2020 7365 6c66 2e73 7368          self.ssh
-00004290: 5f63 6c69 656e 742e 636c 6f73 6528 290a  _client.close().
-000042a0: 2020 2020 2020 2020 7365 6c66 2e61 745f          self.at_
-000042b0: 636c 6965 6e74 2e73 746f 705f 6d6f 6e69  client.stop_moni
-000042c0: 746f 7228 290a 2020 2020 2020 2020 666f  tor().        fo
-000042d0: 7220 7468 7265 6164 2069 6e20 5353 484e  r thread in SSHN
-000042e0: 5044 436c 6965 6e74 2e74 6872 6561 6473  PDClient.threads
-000042f0: 3a0a 2020 2020 2020 2020 2020 2020 7468  :.            th
-00004300: 7265 6164 2e6a 6f69 6e28 290a 2020 2020  read.join().    
-00004310: 2020 2020 5353 484e 5044 436c 6965 6e74      SSHNPDClient
-00004320: 2e74 6872 6561 6473 2e63 6c65 6172 2829  .threads.clear()
-00004330: 0a0a 2020 2020 6465 6620 5f73 6574 5f75  ..    def _set_u
-00004340: 7365 726e 616d 6528 7365 6c66 293a 0a20  sername(self):. 
-00004350: 2020 2020 2020 2075 7365 726e 616d 6520         username 
-00004360: 3d20 6765 7470 6173 732e 6765 7475 7365  = getpass.getuse
-00004370: 7228 290a 2020 2020 2020 2020 7573 6572  r().        user
-00004380: 6e61 6d65 5f6b 6579 203d 2053 6861 7265  name_key = Share
-00004390: 644b 6579 280a 2020 2020 2020 2020 2020  dKey(.          
-000043a0: 2020 2275 7365 726e 616d 6522 2c20 4174    "username", At
-000043b0: 5369 676e 2873 656c 662e 6174 7369 676e  Sign(self.atsign
-000043c0: 292c 2041 7453 6967 6e28 7365 6c66 2e6d  ), AtSign(self.m
-000043d0: 616e 6167 6572 5f61 7473 6967 6e29 290a  anager_atsign)).
-000043e0: 2020 2020 2020 2020 7365 6c66 2e61 745f          self.at_
-000043f0: 636c 6965 6e74 2e70 7574 2875 7365 726e  client.put(usern
-00004400: 616d 655f 6b65 792c 2075 7365 726e 616d  ame_key, usernam
-00004410: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
-00004420: 7573 6572 6e61 6d65 203d 2075 7365 726e  username = usern
-00004430: 616d 650a 0a20 2020 2064 6566 205f 6861  ame..    def _ha
-00004440: 6e64 6c65 5f6e 6f74 6966 6963 6174 696f  ndle_notificatio
-00004450: 6e73 2873 656c 662c 2071 7565 7565 3a20  ns(self, queue: 
-00004460: 5175 6575 6529 3a0a 2020 2020 2020 2020  Queue):.        
-00004470: 7072 6976 6174 655f 6b65 7920 3d20 2222  private_key = ""
-00004480: 0a20 2020 2020 2020 2073 7368 5f70 7562  .        ssh_pub
-00004490: 6c69 635f 6b65 795f 7265 6365 6976 6564  lic_key_received
-000044a0: 203d 2054 7275 6520 6966 206e 6f74 2073   = True if not s
-000044b0: 656c 662e 6578 7065 6374 696e 675f 7373  elf.expecting_ss
-000044c0: 685f 6b65 7973 2065 6c73 6520 2846 616c  h_keys else (Fal
-000044d0: 7365 2069 6620 2222 2065 6c73 6520 5472  se if "" else Tr
-000044e0: 7565 2920 2373 6f72 7279 2066 6f72 206d  ue) #sorry for m
-000044f0: 616b 696e 6720 7468 6973 2073 6f20 6375  aking this so cu
-00004500: 7273 6564 0a20 2020 2020 2020 2073 7368  rsed.        ssh
-00004510: 5f6e 6f74 6966 6963 6174 696f 6e5f 7265  _notification_re
-00004520: 6369 6576 6564 203d 2046 616c 7365 0a20  cieved = False. 
-00004530: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00004540: 7768 696c 6520 6e6f 7420 7365 6c66 2e63  while not self.c
-00004550: 6c6f 7369 6e67 2e69 735f 7365 7428 293a  losing.is_set():
-00004560: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00004570: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00004580: 2020 6174 5f65 7665 6e74 203d 2071 7565    at_event = que
-00004590: 7565 2e67 6574 2862 6c6f 636b 3d46 616c  ue.get(block=Fal
-000045a0: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-000045b0: 2020 2020 6576 656e 745f 7479 7065 203d      event_type =
-000045c0: 2061 745f 6576 656e 742e 6576 656e 745f   at_event.event_
-000045d0: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
-000045e0: 2020 2020 2065 7665 6e74 5f64 6174 6120       event_data 
-000045f0: 3d20 6174 5f65 7665 6e74 2e65 7665 6e74  = at_event.event
-00004600: 5f64 6174 610a 2020 2020 2020 2020 2020  _data.          
-00004610: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00004620: 2020 2020 2020 2069 6620 6576 656e 745f         if event_
-00004630: 7479 7065 203d 3d20 4174 4576 656e 7454  type == AtEventT
-00004640: 7970 652e 5550 4441 5445 5f4e 4f54 4946  ype.UPDATE_NOTIF
-00004650: 4943 4154 494f 4e3a 0a20 2020 2020 2020  ICATION:.       
-00004660: 2020 2020 2020 2020 2020 2020 2071 7565               que
-00004670: 7565 2e70 7574 2861 745f 6576 656e 7429  ue.put(at_event)
-00004680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004690: 2020 2020 2073 6c65 6570 2831 290a 2020       sleep(1).  
-000046a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000046b0: 2065 7665 6e74 5f74 7970 6520 213d 2041   event_type != A
-000046c0: 7445 7665 6e74 5479 7065 2e44 4543 5259  tEventType.DECRY
-000046d0: 5054 4544 5f55 5044 4154 455f 4e4f 5449  PTED_UPDATE_NOTI
-000046e0: 4649 4341 5449 4f4e 3a0a 2020 2020 2020  FICATION:.      
-000046f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00004700: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
-00004710: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00004720: 2020 2020 2020 2020 6b65 7920 3d20 6576          key = ev
-00004730: 656e 745f 6461 7461 5b22 6b65 7922 5d2e  ent_data["key"].
-00004740: 7370 6c69 7428 223a 2229 5b31 5d2e 7370  split(":")[1].sp
-00004750: 6c69 7428 222e 2229 5b30 5d0a 2020 2020  lit(".")[0].    
-00004760: 2020 2020 2020 2020 2020 2020 6465 6372              decr
-00004770: 7970 7465 645f 7661 6c75 6520 3d20 7374  ypted_value = st
-00004780: 7228 6576 656e 745f 6461 7461 5b22 6465  r(event_data["de
-00004790: 6372 7970 7465 6456 616c 7565 225d 290a  cryptedValue"]).
-000047a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000047b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000047c0: 2069 6620 6b65 7920 3d3d 2022 7072 6976   if key == "priv
-000047d0: 6174 656b 6579 223a 0a20 2020 2020 2020  atekey":.       
-000047e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000047f0: 662e 6c6f 6767 6572 2e64 6562 7567 280a  f.logger.debug(.
-00004800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004810: 2020 2020 2020 2020 6627 7072 6976 6174          f'privat
-00004820: 6520 6b65 7920 7265 6365 6976 6564 2066  e key received f
-00004830: 726f 6d20 247b 6576 656e 745f 6461 7461  rom ${event_data
-00004840: 5b22 6672 6f6d 225d 7d20 6e6f 7469 6669  ["from"]} notifi
-00004850: 6361 7469 6f6e 2069 6420 3a20 247b 6576  cation id : ${ev
-00004860: 656e 745f 6461 7461 5b22 6964 225d 7d27  ent_data["id"]}'
-00004870: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00004880: 2020 2020 2020 7072 6976 6174 655f 6b65        private_ke
-00004890: 7920 3d20 6465 6372 7970 7465 645f 7661  y = decrypted_va
-000048a0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-000048b0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-000048c0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000048d0: 2020 6966 206b 6579 203d 3d20 2273 7368    if key == "ssh
-000048e0: 7075 626c 6963 6b65 7922 3a0a 2020 2020  publickey":.    
-000048f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004900: 7365 6c66 2e6c 6f67 6765 722e 6465 6275  self.logger.debu
-00004910: 6728 6627 7373 6820 5075 626c 6963 204b  g(f'ssh Public K
-00004920: 6579 2072 6563 6569 7665 6420 6672 6f6d  ey received from
-00004930: 2024 7b65 7665 6e74 5f64 6174 615b 2266   ${event_data["f
-00004940: 726f 6d22 5d7d 206e 6f74 6966 6963 6174  rom"]} notificat
-00004950: 696f 6e20 6964 203a 2024 7b65 7665 6e74  ion id : ${event
-00004960: 5f64 6174 615b 2269 6422 5d7d 2729 0a20  _data["id"]}'). 
-00004970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004980: 2020 2073 656c 662e 5f68 616e 646c 655f     self._handle_
-00004990: 7373 685f 7075 626c 6963 5f6b 6579 2864  ssh_public_key(d
-000049a0: 6563 7279 7074 6564 5f76 616c 7565 290a  ecrypted_value).
-000049b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000049c0: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-000049d0: 2020 2020 2020 2020 2020 2020 2023 7265               #re
-000049e0: 7665 7273 6520 7373 680a 2020 2020 2020  verse ssh.      
-000049f0: 2020 2020 2020 2020 2020 6966 206b 6579            if key
-00004a00: 203d 3d20 2273 7368 6422 3a0a 2020 2020   == "sshd":.    
-00004a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a20: 7365 6c66 2e6c 6f67 6765 722e 6465 6275  self.logger.debu
-00004a30: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-00004a40: 2020 2020 2020 2020 2020 2066 2773 7368             f'ssh
-00004a50: 2063 616c 6c62 6163 6b20 7265 7175 6573   callback reques
-00004a60: 7465 6420 6672 6f6d 207b 6576 656e 745f  ted from {event_
-00004a70: 6461 7461 5b22 6672 6f6d 225d 7d20 6e6f  data["from"]} no
-00004a80: 7469 6669 6361 7469 6f6e 2069 6420 3a20  tification id : 
-00004a90: 7b65 7665 6e74 5f64 6174 615b 2269 6422  {event_data["id"
-00004aa0: 5d7d 2729 0a20 2020 2020 2020 2020 2020  ]}').           
-00004ab0: 2020 2020 2020 2020 2073 7368 5f6e 6f74           ssh_not
-00004ac0: 6966 6963 6174 696f 6e5f 7265 6369 6576  ification_reciev
-00004ad0: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
-00004ae0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-00004af0: 6c6c 6261 636b 4172 6773 203d 205b 0a20  llbackArgs = [. 
-00004b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004b10: 2020 2020 2020 2061 745f 6576 656e 742c         at_event,
-00004b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004b30: 2020 2020 2020 2020 2070 7269 7661 7465           private
-00004b40: 5f6b 6579 2c0a 2020 2020 2020 2020 2020  _key,.          
-00004b50: 2020 2020 2020 2020 2020 2020 2020 4661                Fa
-00004b60: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00004b70: 2020 2020 2020 2020 5d20 0a20 2020 2020          ] .     
-00004b80: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00004b90: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00004ba0: 2020 2020 2020 2020 2020 2020 7468 7265              thre
-00004bb0: 6164 696e 672e 5468 7265 6164 2874 6172  ading.Thread(tar
-00004bc0: 6765 743d 7365 6c66 2e73 7368 6e70 5f63  get=self.sshnp_c
-00004bd0: 616c 6c62 6163 6b2c 2061 7267 733d 2863  allback, args=(c
-00004be0: 616c 6c62 6163 6b41 7267 7329 292e 7374  allbackArgs)).st
-00004bf0: 6172 7428 290a 2020 2020 2020 2020 2020  art().          
-00004c00: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00004c10: 2045 7863 6570 7469 6f6e 2061 7320 653a   Exception as e:
-00004c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004c30: 2020 2020 2020 2020 2072 6169 7365 2065           raise e
-00004c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004c50: 2023 6469 7265 6374 2073 7368 0a20 2020   #direct ssh.   
-00004c60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00004c70: 6b65 7920 3d3d 2027 7373 685f 7265 7175  key == 'ssh_requ
-00004c80: 6573 7427 3a0a 2020 2020 2020 2020 2020  est':.          
-00004c90: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00004ca0: 6f67 6765 722e 6465 6275 6728 0a20 2020  ogger.debug(.   
-00004cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004cc0: 2020 2020 2066 2773 7368 2063 616c 6c62       f'ssh callb
-00004cd0: 6163 6b20 7265 7175 6573 7465 6420 6672  ack requested fr
-00004ce0: 6f6d 207b 6576 656e 745f 6461 7461 5b22  om {event_data["
-00004cf0: 6672 6f6d 225d 7d20 6e6f 7469 6669 6361  from"]} notifica
-00004d00: 7469 6f6e 2069 6420 3a20 7b65 7665 6e74  tion id : {event
-00004d10: 5f64 6174 615b 2269 6422 5d7d 2729 0a20  _data["id"]}'). 
-00004d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004d30: 2020 2063 616c 6c62 6163 6b41 7267 7320     callbackArgs 
-00004d40: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-00004d50: 2020 2020 2020 2020 2020 2020 6174 5f65              at_e
-00004d60: 7665 6e74 2c0a 2020 2020 2020 2020 2020  vent,.          
-00004d70: 2020 2020 2020 2020 2020 2020 2020 2222                ""
-00004d80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00004d90: 2020 2020 2020 2020 2020 5472 7565 0a20            True. 
-00004da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004db0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00004dc0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00004dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004de0: 2020 2020 2020 7468 7265 6164 696e 672e        threading.
-00004df0: 5468 7265 6164 2874 6172 6765 743d 7365  Thread(target=se
-00004e00: 6c66 2e73 7368 6e70 5f63 616c 6c62 6163  lf.sshnp_callbac
-00004e10: 6b2c 2061 7267 733d 2863 616c 6c62 6163  k, args=(callbac
-00004e20: 6b41 7267 7329 292e 7374 6172 7428 290a  kArgs)).start().
-00004e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e40: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-00004e50: 7469 6f6e 2061 7320 653a 0a20 2020 2020  tion as e:.     
-00004e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e70: 2020 2072 6169 7365 2065 0a20 2020 2020     raise e.     
-00004e80: 2020 2020 2020 2065 7863 6570 7420 456d         except Em
-00004e90: 7074 793a 0a20 2020 2020 2020 2020 2020  pty:.           
-00004ea0: 2020 2020 2070 6173 730a 0a20 2020 2023       pass..    #
-00004eb0: 5275 6e6e 696e 6720 696e 2061 2074 6872  Running in a thr
-00004ec0: 6561 640a 2020 2020 6465 6620 5f68 616e  ead.    def _han
-00004ed0: 646c 655f 6576 656e 7473 2873 656c 662c  dle_events(self,
-00004ee0: 2071 7565 7565 3a20 5175 6575 6529 3a20   queue: Queue): 
-00004ef0: 200a 2020 2020 2020 2020 7768 696c 6520   .        while 
-00004f00: 6e6f 7420 7365 6c66 2e63 6c6f 7369 6e67  not self.closing
-00004f10: 2e69 735f 7365 7428 293a 0a20 2020 2020  .is_set():.     
-00004f20: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00004f30: 2020 2020 2020 2020 2020 2020 6174 5f65              at_e
-00004f40: 7665 6e74 203d 2071 7565 7565 2e67 6574  vent = queue.get
-00004f50: 2862 6c6f 636b 3d46 616c 7365 290a 2020  (block=False).  
-00004f60: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-00004f70: 656e 745f 7479 7065 203d 2061 745f 6576  ent_type = at_ev
-00004f80: 656e 742e 6576 656e 745f 7479 7065 0a20  ent.event_type. 
-00004f90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00004fa0: 2074 6865 204d 6169 6e20 7468 7265 6164   the Main thread
-00004fb0: 206e 6565 6473 2074 6f20 6163 6365 7373   needs to access
-00004fc0: 2074 6865 2071 7565 7565 2041 4654 4552   the queue AFTER
-00004fd0: 2074 6865 2068 616e 646c 6520 7468 7265   the handle thre
-00004fe0: 6164 2068 6173 2066 696e 6973 6865 6420  ad has finished 
-00004ff0: 7769 7468 2069 740a 2020 2020 2020 2020  with it.        
-00005000: 2020 2020 2020 2020 6966 2065 7665 6e74          if event
-00005010: 5f74 7970 6520 3d3d 2041 7445 7665 6e74  _type == AtEvent
-00005020: 5479 7065 2e44 4543 5259 5054 4544 5f55  Type.DECRYPTED_U
-00005030: 5044 4154 455f 4e4f 5449 4649 4341 5449  PDATE_NOTIFICATI
-00005040: 4f4e 3a0a 2020 2020 2020 2020 2020 2020  ON:.            
-00005050: 2020 2020 2020 2020 7175 6575 652e 7075          queue.pu
-00005060: 7428 6174 5f65 7665 6e74 290a 2020 2020  t(at_event).    
-00005070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005080: 736c 6565 7028 3129 0a20 2020 2020 2020  sleep(1).       
-00005090: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000050a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050b0: 2020 2069 6620 6576 656e 745f 7479 7065     if event_type
-000050c0: 203d 3d20 4174 4576 656e 7454 7970 652e   == AtEventType.
-000050d0: 5550 4441 5445 5f4e 4f54 4946 4943 4154  UPDATE_NOTIFICAT
-000050e0: 494f 4e3a 0a20 2020 2020 2020 2020 2020  ION:.           
-000050f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00005100: 662e 6174 5f63 6c69 656e 742e 7365 636f  f.at_client.seco
-00005110: 6e64 6172 795f 636f 6e6e 6563 7469 6f6e  ndary_connection
-00005120: 2e65 7865 6375 7465 5f63 6f6d 6d61 6e64  .execute_command
-00005130: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00005140: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-00005150: 6f74 6966 793a 7265 6d6f 7665 3a22 202b  otify:remove:" +
-00005160: 2061 745f 6576 656e 742e 6576 656e 745f   at_event.event_
-00005170: 6461 7461 5b22 6964 225d 0a20 2020 2020  data["id"].     
-00005180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005190: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000051a0: 2020 2020 2020 2020 2073 656c 662e 6174           self.at
-000051b0: 5f63 6c69 656e 742e 6861 6e64 6c65 5f65  _client.handle_e
-000051c0: 7665 6e74 2871 7565 7565 2c20 6174 5f65  vent(queue, at_e
-000051d0: 7665 6e74 290a 2020 2020 2020 2020 2020  vent).          
-000051e0: 2020 6578 6365 7074 2045 6d70 7479 3a0a    except Empty:.
-000051f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005200: 7061 7373 2020 0a0a 2020 2020 6465 6620  pass  ..    def 
-00005210: 5f64 6972 6563 745f 7373 6828 7365 6c66  _direct_ssh(self
-00005220: 2c20 686f 7374 6e61 6d65 2c20 706f 7274  , hostname, port
-00005230: 2c20 7365 7373 696f 6e49 6429 3a0a 2020  , sessionId):.  
-00005240: 2020 2020 2020 7373 6872 7620 3d20 5353        sshrv = SS
-00005250: 4852 5628 686f 7374 6e61 6d65 2c20 706f  HRV(hostname, po
-00005260: 7274 290a 2020 2020 2020 2020 7373 6872  rt).        sshr
-00005270: 762e 7275 6e28 290a 2020 2020 2020 2020  v.run().        
-00005280: 7365 6c66 2e72 7620 3d20 7373 6872 760a  self.rv = sshrv.
-00005290: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-000052a0: 6765 722e 696e 666f 2822 7373 6872 7620  ger.info("sshrv 
-000052b0: 7374 6172 7465 6420 4020 2220 202b 2068  started @ "  + h
-000052c0: 6f73 746e 616d 6520 2b20 2220 6f6e 2070  ostname + " on p
-000052d0: 6f72 7420 2220 2b20 7374 7228 706f 7274  ort " + str(port
-000052e0: 2929 0a20 2020 2020 2020 2028 7075 626c  )).        (publ
-000052f0: 6963 5f6b 6579 2c20 7072 6976 6174 655f  ic_key, private_
-00005300: 6b65 7929 3d20 7365 6c66 2e5f 6765 6e65  key)= self._gene
-00005310: 7261 7465 5f73 7368 5f6b 6579 7328 7365  rate_ssh_keys(se
-00005320: 7373 696f 6e49 6429 0a20 2020 2020 2020  ssionId).       
-00005330: 2070 7269 7661 7465 5f6b 6579 203d 2070   private_key = p
-00005340: 7269 7661 7465 5f6b 6579 2e72 6570 6c61  rivate_key.repla
-00005350: 6365 2822 5c6e 222c 2022 5c5c 6e22 290a  ce("\n", "\\n").
-00005360: 2020 2020 2020 2020 7365 6c66 2e5f 6861          self._ha
-00005370: 6e64 6c65 5f73 7368 5f70 7562 6c69 635f  ndle_ssh_public_
-00005380: 6b65 7928 7075 626c 6963 5f6b 6579 290a  key(public_key).
-00005390: 2020 2020 2020 2020 6461 7461 203d 2066          data = f
-000053a0: 277b 7b22 7374 6174 7573 223a 2263 6f6e  '{{"status":"con
-000053b0: 6e65 6374 6564 222c 2273 6573 7369 6f6e  nected","session
-000053c0: 4964 223a 227b 7365 7373 696f 6e49 647d  Id":"{sessionId}
-000053d0: 222c 2265 7068 656d 6572 616c 5072 6976  ","ephemeralPriv
-000053e0: 6174 654b 6579 223a 227b 7072 6976 6174  ateKey":"{privat
-000053f0: 655f 6b65 797d 227d 7d27 0a20 2020 2020  e_key}"}}'.     
-00005400: 2020 2073 6967 6e61 7475 7265 203d 2020     signature =  
-00005410: 456e 6372 7970 7469 6f6e 5574 696c 2e73  EncryptionUtil.s
-00005420: 6967 6e5f 7368 6132 3536 5f72 7361 2864  ign_sha256_rsa(d
-00005430: 6174 612c 2073 656c 662e 6174 5f63 6c69  ata, self.at_cli
-00005440: 656e 742e 6b65 7973 5b4b 6579 7355 7469  ent.keys[KeysUti
-00005450: 6c2e 656e 6372 7970 7469 6f6e 5f70 7269  l.encryption_pri
-00005460: 7661 7465 5f6b 6579 5f6e 616d 655d 290a  vate_key_name]).
-00005470: 2020 2020 2020 2020 656e 7665 6c6f 7065          envelope
-00005480: 203d 2066 277b 7b22 7061 796c 6f61 6422   = f'{{"payload"
-00005490: 3a7b 6461 7461 7d2c 2273 6967 6e61 7475  :{data},"signatu
-000054a0: 7265 223a 227b 7369 676e 6174 7572 657d  re":"{signature}
-000054b0: 222c 2268 6173 6869 6e67 416c 676f 223a  ","hashingAlgo":
-000054c0: 2273 6861 3235 3622 2c22 7369 676e 696e  "sha256","signin
-000054d0: 6741 6c67 6f22 3a22 7273 6132 3034 3822  gAlgo":"rsa2048"
-000054e0: 7d7d 270a 2020 2020 2020 2020 7265 7475  }}'.        retu
-000054f0: 726e 2065 6e76 656c 6f70 650a 0a20 2020  rn envelope..   
-00005500: 2064 6566 2073 7368 6e70 5f63 616c 6c62   def sshnp_callb
-00005510: 6163 6b28 0a20 2020 2020 2020 2073 656c  ack(.        sel
-00005520: 662c 2020 200a 2020 2020 2020 2020 6576  f,   .        ev
-00005530: 656e 743a 2041 7445 7665 6e74 2c0a 2020  ent: AtEvent,.  
-00005540: 2020 2020 2020 7072 6976 6174 655f 6b65        private_ke
-00005550: 793d 2222 2c0a 2020 2020 2020 2020 6469  y="",.        di
-00005560: 7265 6374 3d46 616c 7365 2c0a 2020 2020  rect=False,.    
-00005570: 293a 0a20 2020 2020 2020 2075 7569 6420  ):.        uuid 
-00005580: 3d20 6576 656e 742e 6576 656e 745f 6461  = event.event_da
-00005590: 7461 5b22 6964 225d 0a20 2020 2020 2020  ta["id"].       
-000055a0: 2069 6620 6469 7265 6374 3a0a 2020 2020   if direct:.    
-000055b0: 2020 2020 2020 2020 7373 685f 6c69 7374          ssh_list
-000055c0: 203d 206a 736f 6e2e 6c6f 6164 7328 6576   = json.loads(ev
-000055d0: 656e 742e 6576 656e 745f 6461 7461 5b22  ent.event_data["
-000055e0: 6465 6372 7970 7465 6456 616c 7565 225d  decryptedValue"]
-000055f0: 295b 2770 6179 6c6f 6164 275d 0a20 2020  )['payload'].   
-00005600: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00005610: 2020 2020 2020 2073 7368 5f6c 6973 7420         ssh_list 
-00005620: 3d20 6576 656e 742e 6576 656e 745f 6461  = event.event_da
-00005630: 7461 5b22 6465 6372 7970 7465 6456 616c  ta["decryptedVal
-00005640: 7565 225d 2e73 706c 6974 2822 2022 290a  ue"].split(" ").
-00005650: 2020 2020 2020 2020 6976 5f6e 6f6e 6365          iv_nonce
-00005660: 203d 2045 6e63 7279 7074 696f 6e55 7469   = EncryptionUti
-00005670: 6c2e 6765 6e65 7261 7465 5f69 765f 6e6f  l.generate_iv_no
-00005680: 6e63 6528 290a 2020 2020 2020 2020 6d65  nce().        me
-00005690: 7461 6461 7461 203d 204d 6574 6164 6174  tadata = Metadat
-000056a0: 6128 0a20 2020 2020 2020 2020 2020 2074  a(.            t
-000056b0: 746c 3d31 3030 3030 2c0a 2020 2020 2020  tl=10000,.      
-000056c0: 2020 2020 2020 7474 723d 2d31 2c0a 2020        ttr=-1,.  
-000056d0: 2020 2020 2020 2020 2020 6976 5f6e 6f6e            iv_non
-000056e0: 6365 3d69 765f 6e6f 6e63 652c 0a20 2020  ce=iv_nonce,.   
-000056f0: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
-00005700: 745f 6b65 7920 3d20 4174 4b65 7928 6622  t_key = AtKey(f"
-00005710: 7b75 7569 647d 2e7b 7365 6c66 2e64 6576  {uuid}.{self.dev
-00005720: 6963 657d 222c 2073 656c 662e 6174 7369  ice}", self.atsi
-00005730: 676e 290a 2020 2020 2020 2020 6174 5f6b  gn).        at_k
-00005740: 6579 2e73 6861 7265 645f 7769 7468 203d  ey.shared_with =
-00005750: 2041 7453 6967 6e28 7365 6c66 2e6d 616e   AtSign(self.man
-00005760: 6167 6572 5f61 7473 6967 6e29 0a20 2020  ager_atsign).   
-00005770: 2020 2020 2061 745f 6b65 792e 6d65 7461       at_key.meta
-00005780: 6461 7461 203d 206d 6574 6164 6174 610a  data = metadata.
-00005790: 2020 2020 2020 2020 6174 5f6b 6579 2e6e          at_key.n
-000057a0: 616d 6573 7061 6365 203d 2073 656c 662e  amespace = self.
-000057b0: 6465 7669 6365 5f6e 616d 6573 7061 6365  device_namespace
-000057c0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-000057d0: 7373 685f 6c69 7374 2920 3d3d 2035 206f  ssh_list) == 5 o
-000057e0: 7220 6469 7265 6374 3a0a 2020 2020 2020  r direct:.      
-000057f0: 2020 2020 2020 7575 6964 203d 2020 7373        uuid =  ss
-00005800: 685f 6c69 7374 5b27 7365 7373 696f 6e49  h_list['sessionI
-00005810: 6427 5d20 6966 2064 6972 6563 7420 656c  d'] if direct el
-00005820: 7365 2073 7368 5f6c 6973 745b 345d 0a20  se ssh_list[4]. 
-00005830: 2020 2020 2020 2020 2020 2061 745f 6b65             at_ke
-00005840: 7920 3d20 4174 4b65 7928 6622 7b75 7569  y = AtKey(f"{uui
-00005850: 647d 222c 2073 656c 662e 6174 7369 676e  d}", self.atsign
-00005860: 290a 2020 2020 2020 2020 2020 2020 6174  ).            at
-00005870: 5f6b 6579 2e73 6861 7265 645f 7769 7468  _key.shared_with
-00005880: 203d 2041 7453 6967 6e28 7365 6c66 2e6d   = AtSign(self.m
-00005890: 616e 6167 6572 5f61 7473 6967 6e29 0a20  anager_atsign). 
-000058a0: 2020 2020 2020 2020 2020 2061 745f 6b65             at_ke
-000058b0: 792e 6d65 7461 6461 7461 203d 206d 6574  y.metadata = met
-000058c0: 6164 6174 610a 2020 2020 2020 2020 2020  adata.          
-000058d0: 2020 6174 5f6b 6579 2e6e 616d 6573 7061    at_key.namespa
-000058e0: 6365 203d 7365 6c66 2e64 6576 6963 655f  ce =self.device_
-000058f0: 6e61 6d65 7370 6163 650a 2020 2020 2020  namespace.      
-00005900: 2020 7373 685f 7265 7370 6f6e 7365 203d    ssh_response =
-00005910: 204e 6f6e 650a 2020 2020 2020 2020 0a20   None.        . 
-00005920: 2020 2020 2020 2069 6620 6469 7265 6374         if direct
-00005930: 3a0a 2020 2020 2020 2020 2020 2020 7373  :.            ss
-00005940: 685f 7265 7370 6f6e 7365 203d 2073 656c  h_response = sel
-00005950: 662e 5f64 6972 6563 745f 7373 6828 7373  f._direct_ssh(ss
-00005960: 685f 6c69 7374 5b27 686f 7374 275d 2c20  h_list['host'], 
-00005970: 7373 685f 6c69 7374 5b27 706f 7274 275d  ssh_list['port']
-00005980: 2c20 7373 685f 6c69 7374 5b27 7365 7373  , ssh_list['sess
-00005990: 696f 6e49 6427 5d29 0a20 2020 2020 2020  ionId']).       
-000059a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000059b0: 2020 2073 7368 5f72 6573 706f 6e73 6520     ssh_response 
-000059c0: 3d20 7365 6c66 2e5f 7265 7665 7273 655f  = self._reverse_
-000059d0: 7373 685f 636c 6965 6e74 2873 7368 5f6c  ssh_client(ssh_l
-000059e0: 6973 742c 2070 7269 7661 7465 5f6b 6579  ist, private_key
-000059f0: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-00005a00: 2020 2069 6620 7373 685f 7265 7370 6f6e     if ssh_respon
-00005a10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00005a20: 6e6f 7469 6679 5f72 6573 706f 6e73 6520  notify_response 
-00005a30: 3d20 7365 6c66 2e61 745f 636c 6965 6e74  = self.at_client
-00005a40: 2e6e 6f74 6966 7928 6174 5f6b 6579 2c20  .notify(at_key, 
-00005a50: 7373 685f 7265 7370 6f6e 7365 2c20 7365  ssh_response, se
-00005a60: 7373 696f 6e5f 6964 3d75 7569 6429 0a20  ssion_id=uuid). 
-00005a70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005a80: 6c6f 6767 6572 2e69 6e66 6f28 2273 656e  logger.info("sen
-00005a90: 7420 7373 6820 6e6f 7469 6669 6361 7469  t ssh notificati
-00005aa0: 6f6e 2074 6f20 2220 2b20 6174 5f6b 6579  on to " + at_key
-00005ab0: 2e73 6861 7265 645f 7769 7468 2e74 6f5f  .shared_with.to_
-00005ac0: 7374 7269 6e67 2829 202b 2022 2077 6974  string() + " wit
-00005ad0: 6820 6964 3a22 202b 2075 7569 6429 0a20  h id:" + uuid). 
-00005ae0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005af0: 6175 7468 656e 7469 6361 7465 6420 3d20  authenticated = 
-00005b00: 5472 7565 0a20 2020 2020 2020 2069 6620  True.        if 
-00005b10: 6469 7265 6374 3a0a 2020 2020 2020 2020  direct:.        
-00005b20: 2020 2020 7365 6c66 2e5f 6570 6865 6d65      self._epheme
-00005b30: 7261 6c5f 636c 6561 6e75 7028 7575 6964  ral_cleanup(uuid
-00005b40: 290a 0a20 2020 2023 5275 6e6e 696e 6720  )..    #Running 
-00005b50: 696e 2061 2074 6872 6561 640a 2020 2020  in a thread.    
-00005b60: 6465 6620 5f66 6f72 7761 7264 5f73 6f63  def _forward_soc
-00005b70: 6b65 745f 6861 6e64 6c65 7228 7365 6c66  ket_handler(self
-00005b80: 2c20 6368 616e 2c20 6465 7374 293a 0a20  , chan, dest):. 
-00005b90: 2020 2020 2020 2073 6f63 6b20 3d20 736f         sock = so
-00005ba0: 636b 6574 2829 0a20 2020 2020 2020 2074  cket().        t
-00005bb0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00005bc0: 736f 636b 2e63 6f6e 6e65 6374 2864 6573  sock.connect(des
-00005bd0: 7429 0a20 2020 2020 2020 2065 7863 6570  t).        excep
-00005be0: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00005bf0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00005c00: 6c66 2e6c 6f67 6765 722e 6572 726f 7228  lf.logger.error(
-00005c10: 6622 466f 7277 6172 6469 6e67 2072 6571  f"Forwarding req
-00005c20: 7565 7374 2074 6f20 7b64 6573 747d 2066  uest to {dest} f
-00005c30: 6169 6c65 643a 207b 657d 2229 0a20 2020  ailed: {e}").   
-00005c40: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-00005c50: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00005c60: 6767 6572 2e69 6e66 6f28 0a20 2020 2020  gger.info(.     
-00005c70: 2020 2020 2020 2066 2243 6f6e 6e65 6374         f"Connect
-00005c80: 6564 2120 2054 756e 6e65 6c20 6f70 656e  ed!  Tunnel open
-00005c90: 207b 6368 616e 2e6f 7269 6769 6e5f 6164   {chan.origin_ad
-00005ca0: 6472 7d20 2d3e 207b 6368 616e 2e67 6574  dr} -> {chan.get
-00005cb0: 7065 6572 6e61 6d65 2829 7d20 2d3e 207b  peername()} -> {
-00005cc0: 6465 7374 7d22 0a20 2020 2020 2020 2029  dest}".        )
-00005cd0: 0a0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
-00005ce0: 6e6f 7420 7365 6c66 2e63 6c6f 7369 6e67  not self.closing
-00005cf0: 2e69 735f 7365 7428 293a 0a20 2020 2020  .is_set():.     
-00005d00: 2020 2020 2020 2072 2c20 772c 2078 203d         r, w, x =
-00005d10: 2073 656c 6563 7428 5b73 6f63 6b2c 2063   select([sock, c
-00005d20: 6861 6e5d 2c20 5b5d 2c20 5b5d 290a 2020  han], [], []).  
-00005d30: 2020 2020 2020 2020 2020 6966 2073 6f63            if soc
-00005d40: 6b20 696e 2072 3a0a 2020 2020 2020 2020  k in r:.        
-00005d50: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
-00005d60: 6f63 6b2e 7265 6376 2831 3032 3429 0a20  ock.recv(1024). 
-00005d70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00005d80: 6620 6c65 6e28 6461 7461 2920 3d3d 2030  f len(data) == 0
-00005d90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00005da0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-00005db0: 2020 2020 2020 2020 2020 2020 6368 616e              chan
-00005dc0: 2e73 656e 6428 6461 7461 290a 2020 2020  .send(data).    
-00005dd0: 2020 2020 2020 2020 6966 2063 6861 6e20          if chan 
-00005de0: 696e 2072 3a0a 2020 2020 2020 2020 2020  in r:.          
-00005df0: 2020 2020 2020 6461 7461 203d 2063 6861        data = cha
-00005e00: 6e2e 7265 6376 2831 3032 3429 0a20 2020  n.recv(1024).   
-00005e10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00005e20: 6c65 6e28 6461 7461 2920 3d3d 2030 3a0a  len(data) == 0:.
-00005e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e40: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-00005e50: 2020 2020 2020 2020 2020 736f 636b 2e73            sock.s
-00005e60: 656e 6428 6461 7461 290a 2020 2020 2020  end(data).      
-00005e70: 2020 6368 616e 2e63 6c6f 7365 2829 0a20    chan.close(). 
-00005e80: 2020 2020 2020 2073 6f63 6b2e 636c 6f73         sock.clos
-00005e90: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
-00005ea0: 2e6c 6f67 6765 722e 696e 666f 2866 2254  .logger.info(f"T
-00005eb0: 756e 6e65 6c20 636c 6f73 6564 2066 726f  unnel closed fro
-00005ec0: 6d20 7b63 6861 6e2e 6f72 6967 696e 5f61  m {chan.origin_a
-00005ed0: 6464 727d 2229 0a0a 2020 2020 2372 756e  ddr}")..    #run
-00005ee0: 6e69 6e67 2069 6e20 6120 7468 7265 6164  ning in a thread
-00005ef0: 0a20 2020 2064 6566 205f 666f 7277 6172  .    def _forwar
-00005f00: 645f 736f 636b 6574 2873 656c 662c 2074  d_socket(self, t
-00005f10: 702c 2064 6573 7429 3a0a 2020 2020 2020  p, dest):.      
-00005f20: 2020 7768 696c 6520 6e6f 7420 7365 6c66    while not self
-00005f30: 2e63 6c6f 7369 6e67 2e69 735f 7365 7428  .closing.is_set(
-00005f40: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-00005f50: 6861 6e20 3d20 7470 2e61 6363 6570 7428  han = tp.accept(
-00005f60: 3130 3030 290a 2020 2020 2020 2020 2020  1000).          
-00005f70: 2020 6966 2063 6861 6e20 6973 204e 6f6e    if chan is Non
-00005f80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00005f90: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
-00005fa0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00005fb0: 2020 2020 2074 6872 6561 6420 3d20 7468       thread = th
-00005fc0: 7265 6164 696e 672e 5468 7265 6164 280a  reading.Thread(.
-00005fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005fe0: 7461 7267 6574 3d73 656c 662e 5f66 6f72  target=self._for
-00005ff0: 7761 7264 5f73 6f63 6b65 745f 6861 6e64  ward_socket_hand
-00006000: 6c65 722c 0a20 2020 2020 2020 2020 2020  ler,.           
-00006010: 2020 2020 2061 7267 733d 2863 6861 6e2c       args=(chan,
-00006020: 2064 6573 7429 2c0a 2020 2020 2020 2020   dest),.        
-00006030: 2020 2020 2020 2020 6461 656d 6f6e 3d54          daemon=T
-00006040: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-00006050: 2029 0a20 2020 2020 2020 2020 2020 2074   ).            t
-00006060: 6872 6561 642e 7374 6172 7428 290a 2020  hread.start().  
-00006070: 2020 2020 2020 2020 2020 5353 484e 5044            SSHNPD
-00006080: 436c 6965 6e74 2e74 6872 6561 6473 2e61  Client.threads.a
-00006090: 7070 656e 6428 7468 7265 6164 290a 0a20  ppend(thread).. 
-000060a0: 2020 2064 6566 205f 7265 7665 7273 655f     def _reverse_
-000060b0: 7373 685f 636c 6965 6e74 2873 656c 662c  ssh_client(self,
-000060c0: 2073 7368 5f6c 6973 743a 206c 6973 742c   ssh_list: list,
-000060d0: 2070 7269 7661 7465 5f6b 6579 3a20 7374   private_key: st
-000060e0: 7229 3a0a 2020 2020 2020 2020 6c6f 6361  r):.        loca
-000060f0: 6c5f 706f 7274 203d 2073 7368 5f6c 6973  l_port = ssh_lis
-00006100: 745b 305d 0a20 2020 2020 2020 2070 6f72  t[0].        por
-00006110: 7420 3d20 7373 685f 6c69 7374 5b31 5d0a  t = ssh_list[1].
-00006120: 2020 2020 2020 2020 7573 6572 6e61 6d65          username
-00006130: 203d 2073 7368 5f6c 6973 745b 325d 0a20   = ssh_list[2]. 
-00006140: 2020 2020 2020 2068 6f73 746e 616d 6520         hostname 
-00006150: 3d20 7373 685f 6c69 7374 5b33 5d0a 2020  = ssh_list[3].  
-00006160: 2020 2020 2020 6966 2022 5c5c 2220 696e        if "\\" in
-00006170: 2075 7365 726e 616d 653a 0a20 2020 2020   username:.     
-00006180: 2020 2020 2020 2075 7365 726e 616d 6520         username 
-00006190: 3d20 7573 6572 6e61 6d65 2e73 706c 6974  = username.split
-000061a0: 2822 2f22 295b 2d31 5d0a 2020 2020 2020  ("/")[-1].      
-000061b0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-000061c0: 666f 2822 7373 6820 7365 7373 696f 6e20  fo("ssh session 
-000061d0: 7374 6172 7465 6420 666f 7220 2220 2b20  started for " + 
-000061e0: 7573 6572 6e61 6d65 202b 2022 2040 2022  username + " @ "
-000061f0: 202b 2068 6f73 746e 616d 6520 2b20 2220   + hostname + " 
-00006200: 6f6e 2070 6f72 7420 2220 2b20 706f 7274  on port " + port
-00006210: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-00006220: 662e 7373 685f 636c 6965 6e74 203d 3d20  f.ssh_client == 
-00006230: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00006240: 2020 7373 685f 636c 6965 6e74 203d 2053    ssh_client = S
-00006250: 5348 436c 6965 6e74 2829 0a20 2020 2020  SHClient().     
-00006260: 2020 2020 2020 2073 7368 5f63 6c69 656e         ssh_clien
-00006270: 742e 6c6f 6164 5f73 7973 7465 6d5f 686f  t.load_system_ho
-00006280: 7374 5f6b 6579 7328 6622 7b73 656c 662e  st_keys(f"{self.
-00006290: 7373 685f 7061 7468 7d2f 6b6e 6f77 6e5f  ssh_path}/known_
-000062a0: 686f 7374 7322 290a 2020 2020 2020 2020  hosts").        
-000062b0: 2020 2020 7373 685f 636c 6965 6e74 2e73      ssh_client.s
-000062c0: 6574 5f6d 6973 7369 6e67 5f68 6f73 745f  et_missing_host_
-000062d0: 6b65 795f 706f 6c69 6379 2857 6172 6e69  key_policy(Warni
-000062e0: 6e67 506f 6c69 6379 2829 290a 2020 2020  ngPolicy()).    
-000062f0: 2020 2020 2020 2020 6669 6c65 5f6c 696b          file_lik
-00006300: 6520 3d20 5374 7269 6e67 494f 2870 7269  e = StringIO(pri
-00006310: 7661 7465 5f6b 6579 290a 2020 2020 2020  vate_key).      
-00006320: 2020 2020 2020 7061 7261 6d69 6b6f 5f6c        paramiko_l
-00006330: 6f67 203d 206c 6f67 6769 6e67 2e67 6574  og = logging.get
-00006340: 4c6f 6767 6572 2822 7061 7261 6d69 6b6f  Logger("paramiko
-00006350: 2e74 7261 6e73 706f 7274 2229 0a20 2020  .transport").   
-00006360: 2020 2020 2020 2020 2070 6172 616d 696b           paramik
-00006370: 6f5f 6c6f 672e 7365 744c 6576 656c 2873  o_log.setLevel(s
-00006380: 656c 662e 6c6f 6767 6572 2e6c 6576 656c  elf.logger.level
-00006390: 290a 2020 2020 2020 2020 2020 2020 7061  ).            pa
-000063a0: 7261 6d69 6b6f 5f6c 6f67 2e61 6464 4861  ramiko_log.addHa
-000063b0: 6e64 6c65 7228 6c6f 6767 696e 672e 5374  ndler(logging.St
-000063c0: 7265 616d 4861 6e64 6c65 7228 2929 0a20  reamHandler()). 
-000063d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000063e0: 7373 685f 636c 6965 6e74 203d 2073 7368  ssh_client = ssh
-000063f0: 5f63 6c69 656e 740a 2020 2020 2020 2020  _client.        
-00006400: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-00006410: 2020 2020 2020 2020 2020 706b 6579 203d            pkey =
-00006420: 2045 6432 3535 3139 4b65 792e 6672 6f6d   Ed25519Key.from
-00006430: 5f70 7269 7661 7465 5f6b 6579 2866 696c  _private_key(fil
-00006440: 655f 6f62 6a3d 6669 6c65 5f6c 696b 6529  e_obj=file_like)
-00006450: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006460: 662e 7373 685f 636c 6965 6e74 2e63 6f6e  f.ssh_client.con
-00006470: 6e65 6374 280a 2020 2020 2020 2020 2020  nect(.          
-00006480: 2020 2020 2020 686f 7374 6e61 6d65 3d68        hostname=h
-00006490: 6f73 746e 616d 652c 0a20 2020 2020 2020  ostname,.       
-000064a0: 2020 2020 2020 2020 2070 6f72 743d 706f           port=po
-000064b0: 7274 2c0a 2020 2020 2020 2020 2020 2020  rt,.            
-000064c0: 2020 2020 7573 6572 6e61 6d65 3d75 7365      username=use
-000064d0: 726e 616d 652c 0a20 2020 2020 2020 2020  rname,.         
-000064e0: 2020 2020 2020 2070 6b65 793d 706b 6579         pkey=pkey
-000064f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006500: 2020 616c 6c6f 775f 6167 656e 743d 4661    allow_agent=Fa
-00006510: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00006520: 2020 2020 2074 696d 656f 7574 3d31 302c       timeout=10,
-00006530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006540: 2064 6973 6162 6c65 645f 616c 676f 7269   disabled_algori
-00006550: 7468 6d73 3d7b 2270 7562 6b65 7973 223a  thms={"pubkeys":
-00006560: 205b 2272 7361 2d73 6861 322d 3531 3222   ["rsa-sha2-512"
-00006570: 2c20 2272 7361 2d73 6861 322d 3235 3622  , "rsa-sha2-256"
-00006580: 5d7d 2c0a 2020 2020 2020 2020 2020 2020  ]},.            
-00006590: 290a 2020 2020 2020 2020 2020 2020 7470  ).            tp
-000065a0: 203d 2073 656c 662e 7373 685f 636c 6965   = self.ssh_clie
-000065b0: 6e74 2e67 6574 5f74 7261 6e73 706f 7274  nt.get_transport
-000065c0: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-000065d0: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
-000065e0: 2246 6f72 7761 7264 696e 6720 706f 7274  "Forwarding port
-000065f0: 2022 202b 206c 6f63 616c 5f70 6f72 7420   " + local_port 
-00006600: 2b20 2220 746f 2022 202b 2068 6f73 746e  + " to " + hostn
-00006610: 616d 6520 2b20 223a 2220 2b20 706f 7274  ame + ":" + port
-00006620: 290a 2020 2020 2020 2020 2020 2020 7470  ).            tp
-00006630: 2e72 6571 7565 7374 5f70 6f72 745f 666f  .request_port_fo
-00006640: 7277 6172 6428 2222 2c20 696e 7428 6c6f  rward("", int(lo
-00006650: 6361 6c5f 706f 7274 2929 0a20 2020 2020  cal_port)).     
-00006660: 2020 2020 2020 2074 6872 6561 6420 3d20         thread = 
-00006670: 7468 7265 6164 696e 672e 5468 7265 6164  threading.Thread
-00006680: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00006690: 2020 7461 7267 6574 3d73 656c 662e 5f66    target=self._f
-000066a0: 6f72 7761 7264 5f73 6f63 6b65 742c 0a20  orward_socket,. 
-000066b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000066c0: 7267 733d 2874 702c 2028 226c 6f63 616c  rgs=(tp, ("local
-000066d0: 686f 7374 222c 2032 3229 292c 0a20 2020  host", 22)),.   
-000066e0: 2020 2020 2020 2020 2020 2020 2064 6165               dae
-000066f0: 6d6f 6e3d 5472 7565 2c0a 2020 2020 2020  mon=True,.      
-00006700: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00006710: 2020 2020 7468 7265 6164 2e73 7461 7274      thread.start
-00006720: 2829 0a20 2020 2020 2020 2020 2020 2053  ().            S
-00006730: 5348 4e50 4443 6c69 656e 742e 7468 7265  SHNPDClient.thre
-00006740: 6164 732e 6170 7065 6e64 2874 6872 6561  ads.append(threa
-00006750: 6429 0a20 2020 2020 2020 200a 2020 2020  d).        .    
-00006760: 2020 2020 2349 276c 6c20 656e 6420 7570      #I'll end up
-00006770: 2064 6f69 6e67 206d 6f72 6520 7769 7468   doing more with
-00006780: 2074 6869 7320 4920 7468 696e 6b0a 2020   this I think.  
-00006790: 2020 2020 2020 6578 6365 7074 2020 5353        except  SS
-000067a0: 4845 7863 6570 7469 6f6e 2061 7320 653a  HException as e:
-000067b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000067c0: 7365 2866 2753 5348 4572 726f 7220 284d  se(f'SSHError (M
-000067d0: 616b 6520 7375 7265 2079 6f75 2064 6f20  ake sure you do 
-000067e0: 6e6f 7420 6861 7665 2061 6e6f 7468 6572  not have another
-000067f0: 2073 7368 6e70 6420 7275 6e6e 696e 6729   sshnpd running)
-00006800: 3a20 2465 2729 0a20 2020 2020 2020 2065  : $e').        e
-00006810: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00006820: 6173 2065 3a0a 2020 2020 2020 2020 2020  as e:.          
-00006830: 2020 7261 6973 6528 6529 0a20 2020 2020    raise(e).     
-00006840: 2020 200a 2020 2020 2020 2020 7265 7475     .        retu
-00006850: 726e 2022 636f 6e6e 6563 7465 6422 0a0a  rn "connected"..
-00006860: 2020 2020 6465 6620 5f67 656e 6572 6174      def _generat
-00006870: 655f 7373 685f 6b65 7973 2873 656c 662c  e_ssh_keys(self,
-00006880: 2073 6573 7369 6f6e 5f69 6429 3a0a 2020   session_id):.  
-00006890: 2020 2020 2020 2320 4765 6e65 7261 7465        # Generate
-000068a0: 2053 5348 204b 6579 730a 2020 2020 2020   SSH Keys.      
-000068b0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
-000068c0: 666f 2822 4765 6e65 7261 7469 6e67 2053  fo("Generating S
-000068d0: 5348 204b 6579 7322 290a 2020 2020 2020  SH Keys").      
-000068e0: 2020 6966 206e 6f74 206f 732e 7061 7468    if not os.path
-000068f0: 2e65 7869 7374 7328 6622 7b73 656c 662e  .exists(f"{self.
-00006900: 7373 685f 7061 7468 7d2f 746d 702f 2229  ssh_path}/tmp/")
-00006910: 3a0a 2020 2020 2020 2020 2020 2020 6f73  :.            os
-00006920: 2e6d 616b 6564 6972 7328 6622 7b73 656c  .makedirs(f"{sel
-00006930: 662e 7373 685f 7061 7468 7d2f 746d 702f  f.ssh_path}/tmp/
-00006940: 2229 0a20 2020 2020 2020 2020 2020 200a  ").            .
-00006950: 2020 2020 2020 2020 7373 685f 6b65 7967          ssh_keyg
-00006960: 656e 203d 2073 7562 7072 6f63 6573 732e  en = subprocess.
-00006970: 506f 7065 6e28 0a20 2020 2020 2020 2020  Popen(.         
-00006980: 2020 205b 2273 7368 2d6b 6579 6765 6e22     ["ssh-keygen"
-00006990: 2c20 222d 7422 2c20 2265 6432 3535 3139  , "-t", "ed25519
-000069a0: 222c 2022 2d61 222c 2022 3130 3022 2c20  ", "-a", "100", 
-000069b0: 222d 6622 2c20 6622 7b73 6573 7369 6f6e  "-f", f"{session
-000069c0: 5f69 647d 5f73 7368 6e70 222c 2022 2d71  _id}_sshnp", "-q
-000069d0: 222c 2022 2d4e 222c 2022 225d 2c0a 2020  ", "-N", ""],.  
-000069e0: 2020 2020 2020 2020 2020 6377 643d 6627            cwd=f'
-000069f0: 7b73 656c 662e 7373 685f 7061 7468 7d2f  {self.ssh_path}/
-00006a00: 746d 702f 272c 0a20 2020 2020 2020 2020  tmp/',.         
-00006a10: 2020 2073 7464 6f75 743d 7375 6270 726f     stdout=subpro
-00006a20: 6365 7373 2e50 4950 452c 0a20 2020 2020  cess.PIPE,.     
-00006a30: 2020 2020 2020 2073 7464 6572 723d 7375         stderr=su
-00006a40: 6270 726f 6365 7373 2e50 4950 452c 0a20  bprocess.PIPE,. 
-00006a50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00006a60: 200a 2020 2020 2020 2020 7374 646f 7574   .        stdout
-00006a70: 2c20 7374 6465 7272 203d 2073 7368 5f6b  , stderr = ssh_k
-00006a80: 6579 6765 6e2e 636f 6d6d 756e 6963 6174  eygen.communicat
-00006a90: 6528 290a 2020 2020 2020 2020 6966 2073  e().        if s
-00006aa0: 7368 5f6b 6579 6765 6e2e 7265 7475 726e  sh_keygen.return
-00006ab0: 636f 6465 2021 3d20 303a 0a20 2020 2020  code != 0:.     
-00006ac0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00006ad0: 6572 2e65 7272 6f72 2822 5353 4820 4b65  er.error("SSH Ke
-00006ae0: 7920 6765 6e65 7261 7469 6f6e 2066 6169  y generation fai
-00006af0: 6c65 6422 290a 2020 2020 2020 2020 2020  led").          
-00006b00: 2020 7365 6c66 2e6c 6f67 6765 722e 6572    self.logger.er
-00006b10: 726f 7228 7374 6465 7272 2e64 6563 6f64  ror(stderr.decod
-00006b20: 6528 2275 7466 2d38 2229 290a 2020 2020  e("utf-8")).    
-00006b30: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-00006b40: 616c 7365 0a20 2020 2020 2020 200a 2020  alse.        .  
-00006b50: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00006b60: 722e 696e 666f 2822 5353 4820 4b65 7973  r.info("SSH Keys
-00006b70: 2047 656e 6572 6174 6564 2229 0a20 2020   Generated").   
-00006b80: 2020 2020 2073 7368 5f70 7562 6c69 635f       ssh_public_
-00006b90: 6b65 7920 3d20 2222 0a20 2020 2020 2020  key = "".       
-00006ba0: 2073 7368 5f70 7269 7661 7465 5f6b 6579   ssh_private_key
-00006bb0: 203d 2022 220a 2020 2020 2020 2020 7472   = "".        tr
-00006bc0: 793a 0a20 2020 2020 2020 2020 2020 2077  y:.            w
-00006bd0: 6974 6820 6f70 656e 2866 227b 7365 6c66  ith open(f"{self
-00006be0: 2e73 7368 5f70 6174 687d 2f74 6d70 2f7b  .ssh_path}/tmp/{
-00006bf0: 7365 7373 696f 6e5f 6964 7d5f 7373 686e  session_id}_sshn
-00006c00: 702e 7075 6222 2c20 2772 2729 2061 7320  p.pub", 'r') as 
-00006c10: 7075 626c 6963 5f6b 6579 5f66 696c 653a  public_key_file:
-00006c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006c30: 2073 7368 5f70 7562 6c69 635f 6b65 7920   ssh_public_key 
-00006c40: 3d20 7075 626c 6963 5f6b 6579 5f66 696c  = public_key_fil
-00006c50: 652e 7265 6164 2829 0a0a 2020 2020 2020  e.read()..      
-00006c60: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
-00006c70: 6622 7b73 656c 662e 7373 685f 7061 7468  f"{self.ssh_path
-00006c80: 7d2f 746d 702f 7b73 6573 7369 6f6e 5f69  }/tmp/{session_i
-00006c90: 647d 5f73 7368 6e70 222c 2027 7227 2920  d}_sshnp", 'r') 
-00006ca0: 6173 2070 7269 7661 7465 5f6b 6579 5f66  as private_key_f
-00006cb0: 696c 653a 0a20 2020 2020 2020 2020 2020  ile:.           
-00006cc0: 2020 2020 2073 7368 5f70 7269 7661 7465       ssh_private
-00006cd0: 5f6b 6579 203d 2070 7269 7661 7465 5f6b  _key = private_k
-00006ce0: 6579 5f66 696c 652e 7265 6164 2829 0a20  ey_file.read(). 
-00006cf0: 2020 2020 2020 2020 2020 2020 2020 200a                 .
-00006d00: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-00006d10: 7863 6570 7469 6f6e 2061 7320 653a 0a20  xception as e:. 
-00006d20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006d30: 6c6f 6767 6572 2e65 7272 6f72 2865 290a  logger.error(e).
-00006d40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00006d50: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
-00006d60: 200a 2020 2020 2020 2020 7265 7475 726e   .        return
-00006d70: 2028 7373 685f 7075 626c 6963 5f6b 6579   (ssh_public_key
-00006d80: 2c20 7373 685f 7072 6976 6174 655f 6b65  , ssh_private_ke
-00006d90: 7929 0a0a 2020 2020 6465 6620 5f65 7068  y)..    def _eph
-00006da0: 656d 6572 616c 5f63 6c65 616e 7570 2873  emeral_cleanup(s
-00006db0: 656c 662c 2073 6573 7369 6f6e 5f69 6429  elf, session_id)
-00006dc0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-00006dd0: 2020 2020 2020 2020 2020 206f 732e 7265             os.re
-00006de0: 6d6f 7665 2866 227b 7365 6c66 2e73 7368  move(f"{self.ssh
-00006df0: 5f70 6174 687d 2f74 6d70 2f7b 7365 7373  _path}/tmp/{sess
-00006e00: 696f 6e5f 6964 7d5f 7373 686e 702e 7075  ion_id}_sshnp.pu
-00006e10: 6222 290a 2020 2020 2020 2020 2020 2020  b").            
-00006e20: 6f73 2e72 656d 6f76 6528 6622 7b73 656c  os.remove(f"{sel
-00006e30: 662e 7373 685f 7061 7468 7d2f 746d 702f  f.ssh_path}/tmp/
-00006e40: 7b73 6573 7369 6f6e 5f69 647d 5f73 7368  {session_id}_ssh
-00006e50: 6e70 2229 0a20 2020 2020 2020 2020 2020  np").           
-00006e60: 2073 656c 662e 6c6f 6767 6572 2e69 6e66   self.logger.inf
-00006e70: 6f28 2265 7068 656d 6572 616c 2073 7368  o("ephemeral ssh
-00006e80: 206b 6579 7320 636c 6561 6e65 6420 7570   keys cleaned up
-00006e90: 2229 0a20 2020 2020 2020 2065 7863 6570  ").        excep
-00006ea0: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00006eb0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00006ec0: 6c66 2e6c 6f67 6765 722e 6572 726f 7228  lf.logger.error(
-00006ed0: 6529 0a0a 2020 2020 6465 6620 5f68 616e  e)..    def _han
-00006ee0: 646c 655f 7373 685f 7075 626c 6963 5f6b  dle_ssh_public_k
-00006ef0: 6579 2873 656c 662c 2073 7368 5f70 7562  ey(self, ssh_pub
-00006f00: 6c69 635f 6b65 7929 3a0a 2020 2020 2020  lic_key):.      
-00006f10: 2020 2320 2f2f 2043 6865 636b 2074 6f20    # // Check to 
-00006f20: 7365 6520 6966 2074 6865 2073 7368 2050  see if the ssh P
-00006f30: 7562 6c69 636b 6579 2069 7320 616c 7265  ublickey is alre
-00006f40: 6164 7920 696e 2074 6865 2066 696c 6520  ady in the file 
-00006f50: 6966 206e 6f74 2061 7070 656e 6420 746f  if not append to
-00006f60: 2074 6865 207e 2f2e 7373 682f 6175 7468   the ~/.ssh/auth
-00006f70: 6f72 697a 6564 5f6b 6579 7320 6669 6c65  orized_keys file
-00006f80: 0a20 2020 2020 2020 2077 7269 7465 4b65  .        writeKe
-00006f90: 7920 3d20 4661 6c73 650a 2020 2020 2020  y = False.      
-00006fa0: 2020 6669 6c65 6461 7461 203d 2022 220a    filedata = "".
-00006fb0: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-00006fc0: 6e28 6622 7b73 656c 662e 7373 685f 7061  n(f"{self.ssh_pa
-00006fd0: 7468 7d2f 6175 7468 6f72 697a 6564 5f6b  th}/authorized_k
-00006fe0: 6579 7322 2c20 2272 2229 2061 7320 7265  eys", "r") as re
-00006ff0: 6164 3a0a 2020 2020 2020 2020 2020 2020  ad:.            
-00007000: 6669 6c65 6461 7461 203d 2072 6561 642e  filedata = read.
-00007010: 7265 6164 2829 0a20 2020 2020 2020 2020  read().         
-00007020: 2020 2069 6620 7373 685f 7075 626c 6963     if ssh_public
-00007030: 5f6b 6579 206e 6f74 2069 6e20 6669 6c65  _key not in file
-00007040: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
-00007050: 2020 2020 2020 7772 6974 654b 6579 203d        writeKey =
-00007060: 2054 7275 650a 2020 2020 2020 2020 6966   True.        if
-00007070: 2077 7269 7465 4b65 793a 0a20 2020 2020   writeKey:.     
-00007080: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
-00007090: 2866 227b 7365 6c66 2e73 7368 5f70 6174  (f"{self.ssh_pat
-000070a0: 687d 2f61 7574 686f 7269 7a65 645f 6b65  h}/authorized_ke
-000070b0: 7973 222c 2022 7722 2920 6173 2077 7269  ys", "w") as wri
-000070c0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-000070d0: 2020 2020 7772 6974 652e 7772 6974 6528      write.write(
-000070e0: 6622 7b66 696c 6564 6174 617d 5c6e 7b73  f"{filedata}\n{s
-000070f0: 7368 5f70 7562 6c69 635f 6b65 797d 2229  sh_public_key}")
-00007100: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00007110: 662e 6c6f 6767 6572 2e64 6562 7567 2822  f.logger.debug("
-00007120: 6b65 7920 7772 6974 7465 6e22 2029 0a0a  key written" )..
-00007130: 0a64 6566 206d 6169 6e28 293a 0a20 2020  .def main():.   
-00007140: 2070 6172 7365 7220 3d20 6172 6770 6172   parser = argpar
-00007150: 7365 2e41 7267 756d 656e 7450 6172 7365  se.ArgumentParse
-00007160: 7228 2273 7368 6e70 6422 290a 2020 2020  r("sshnpd").    
-00007170: 7265 7175 6972 6564 4e61 6d65 6420 3d20  requiredNamed = 
-00007180: 7061 7273 6572 2e61 6464 5f61 7267 756d  parser.add_argum
-00007190: 656e 745f 6772 6f75 7028 2772 6571 7569  ent_group('requi
-000071a0: 7265 6420 6e61 6d65 6420 6172 6775 6d65  red named argume
-000071b0: 6e74 7327 290a 2020 2020 7265 7175 6972  nts').    requir
-000071c0: 6564 4e61 6d65 642e 6164 645f 6172 6775  edNamed.add_argu
-000071d0: 6d65 6e74 2822 2d6d 222c 2022 2d2d 6d61  ment("-m", "--ma
-000071e0: 6e61 6765 7222 2c20 6465 7374 3d22 6d61  nager", dest="ma
-000071f0: 6e61 6765 725f 6174 7369 676e 222c 2074  nager_atsign", t
-00007200: 7970 653d 7374 722c 2068 656c 703d 2243  ype=str, help="C
-00007210: 6c69 656e 7420 4174 7369 676e 2028 7373  lient Atsign (ss
-00007220: 686e 7027 7320 6174 7369 676e 2922 2c20  hnp's atsign)", 
-00007230: 7265 7175 6972 6564 3d54 7275 6529 0a20  required=True). 
-00007240: 2020 2072 6571 7569 7265 644e 616d 6564     requiredNamed
-00007250: 2e61 6464 5f61 7267 756d 656e 7428 222d  .add_argument("-
-00007260: 6122 2c20 222d 2d61 7473 6967 6e22 2c20  a", "--atsign", 
-00007270: 6465 7374 3d22 6174 7369 676e 222c 2074  dest="atsign", t
-00007280: 7970 653d 7374 722c 2068 656c 703d 2244  ype=str, help="D
-00007290: 6576 6963 6520 4174 7369 676e 2028 7373  evice Atsign (ss
-000072a0: 686e 7064 2773 2061 7473 6967 6e29 222c  hnpd's atsign)",
-000072b0: 2072 6571 7569 7265 643d 5472 7565 290a   required=True).
-000072c0: 2020 2020 7265 7175 6972 6564 4e61 6d65      requiredName
-000072d0: 642e 6164 645f 6172 6775 6d65 6e74 2822  d.add_argument("
-000072e0: 2d64 222c 2022 2d2d 6465 7669 6365 222c  -d", "--device",
-000072f0: 2064 6573 743d 2264 6576 6963 6522 2c20   dest="device", 
-00007300: 7479 7065 3d73 7472 2c20 6865 6c70 3d22  type=str, help="
-00007310: 4465 7669 6365 204e 616d 6522 2c20 7265  Device Name", re
-00007320: 7175 6972 6564 3d54 7275 6529 0a20 2020  quired=True).   
-00007330: 206f 7074 696f 6e61 6c20 3d20 7061 7273   optional = pars
-00007340: 6572 2e61 6464 5f61 7267 756d 656e 745f  er.add_argument_
-00007350: 6772 6f75 7028 276f 7074 696f 6e61 6c20  group('optional 
-00007360: 6172 6775 6d65 6e74 7327 290a 2020 2020  arguments').    
-00007370: 6f70 7469 6f6e 616c 2e61 6464 5f61 7267  optional.add_arg
-00007380: 756d 656e 7428 222d 7522 2c20 2061 6374  ument("-u",  act
-00007390: 696f 6e3d 2773 746f 7265 5f74 7275 6527  ion='store_true'
-000073a0: 2c20 6465 7374 3d22 7573 6572 6e61 6d65  , dest="username
-000073b0: 222c 2020 6865 6c70 3d22 5573 6572 6e61  ",  help="Userna
-000073c0: 6d65 222c 2064 6566 6175 6c74 3d22 6465  me", default="de
-000073d0: 6661 756c 7422 290a 2020 2020 6f70 7469  fault").    opti
-000073e0: 6f6e 616c 2e61 6464 5f61 7267 756d 656e  onal.add_argumen
-000073f0: 7428 222d 7622 2c20 6163 7469 6f6e 3d27  t("-v", action='
-00007400: 7374 6f72 655f 7472 7565 272c 2064 6573  store_true', des
-00007410: 743d 2276 6572 626f 7365 222c 2068 656c  t="verbose", hel
-00007420: 703d 2256 6572 626f 7365 2229 0a20 2020  p="Verbose").   
-00007430: 206f 7074 696f 6e61 6c2e 6164 645f 6172   optional.add_ar
-00007440: 6775 6d65 6e74 2822 2d73 222c 2061 6374  gument("-s", act
-00007450: 696f 6e3d 2273 746f 7265 5f74 7275 6522  ion="store_true"
-00007460: 2c20 6465 7374 3d22 6578 7065 6374 696e  , dest="expectin
-00007470: 675f 7373 685f 6b65 7973 222c 2068 656c  g_ssh_keys", hel
-00007480: 703d 2253 5348 204b 6579 7061 6972 2c20  p="SSH Keypair, 
-00007490: 7573 6520 7468 6973 2069 6620 796f 7520  use this if you 
-000074a0: 7761 6e74 2074 6f20 7573 6520 796f 7572  want to use your
-000074b0: 206f 776e 2073 7368 206b 6579 7061 6972   own ssh keypair
-000074c0: 2229 0a20 2020 200a 2020 2020 6172 6773  ").    .    args
-000074d0: 203d 2070 6172 7365 722e 7061 7273 655f   = parser.parse_
-000074e0: 6172 6773 2829 0a0a 2020 2020 7373 686e  args()..    sshn
-000074f0: 7064 203d 2053 5348 4e50 4443 6c69 656e  pd = SSHNPDClien
-00007500: 7428 6172 6773 2e61 7473 6967 6e2c 2061  t(args.atsign, a
-00007510: 7267 732e 6d61 6e61 6765 725f 6174 7369  rgs.manager_atsi
-00007520: 676e 2c20 6172 6773 2e64 6576 6963 652c  gn, args.device,
-00007530: 2061 7267 732e 7573 6572 6e61 6d65 2c20   args.username, 
-00007540: 6172 6773 2e76 6572 626f 7365 2c20 6172  args.verbose, ar
-00007550: 6773 2e65 7870 6563 7469 6e67 5f73 7368  gs.expecting_ssh
-00007560: 5f6b 6579 7329 0a20 2020 200a 2020 2020  _keys).    .    
-00007570: 7472 793a 0a20 2020 2020 2020 2074 6872  try:.        thr
-00007580: 6561 6469 6e67 2e54 6872 6561 6428 7461  eading.Thread(ta
-00007590: 7267 6574 3d73 7368 6e70 642e 7374 6172  rget=sshnpd.star
-000075a0: 7429 2e73 7461 7274 2829 0a20 2020 2020  t).start().     
-000075b0: 2020 2077 6869 6c65 206c 656e 2853 5348     while len(SSH
-000075c0: 4e50 4443 6c69 656e 742e 7468 7265 6164  NPDClient.thread
-000075d0: 7329 203e 2030 3a0a 2020 2020 2020 2020  s) > 0:.        
-000075e0: 2020 2020 6966 206e 6f74 2073 7368 6e70      if not sshnp
-000075f0: 642e 6973 5f61 6c69 7665 2829 3a0a 2020  d.is_alive():.  
-00007600: 2020 2020 2020 2020 2020 2020 2020 7373                ss
-00007610: 686e 7064 2e6a 6f69 6e28 290a 2020 2020  hnpd.join().    
-00007620: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00007630: 2020 2020 2020 2020 2020 2020 2020 736c                sl
-00007640: 6565 7028 3130 290a 2020 2020 2020 2020  eep(10).        
-00007650: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-00007660: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00007670: 6f6e 2061 7320 653a 0a20 2020 2020 2020  on as e:.       
-00007680: 2070 7269 6e74 2865 290a 2020 2020 2020   print(e).      
-00007690: 2020 7373 686e 7064 2e6a 6f69 6e28 290a    sshnpd.join().
-000076a0: 0a0a 6966 205f 5f6e 616d 655f 5f20 3d3d  ..if __name__ ==
-000076b0: 2022 5f5f 6d61 696e 5f5f 223a 0a20 2020   "__main__":.   
-000076c0: 206d 6169 6e28 290a 0000 0000 0000 0000   main().........
+00003440: 2065 7863 6570 7420 6572 726f 7220 6173   except error as
+00003450: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
+00003460: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+00003470: 2e65 7272 6e6f 203d 3d20 6572 726e 6f2e  .errno == errno.
+00003480: 4557 4f55 4c44 424c 4f43 4b3a 0a20 2020  EWOULDBLOCK:.   
+00003490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000034a0: 2020 2020 2020 2020 2070 6173 7320 2023           pass  #
+000034b0: 204e 6f20 6461 7461 2061 7661 696c 6162   No data availab
+000034c0: 6c65 2c20 636f 6e74 696e 7565 0a20 2020  le, continue.   
+000034d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000034e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000034f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003500: 2020 2020 2020 2072 6169 7365 2065 0a20         raise e. 
+00003510: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
+00003520: 6365 7074 696f 6e20 6173 2065 3a0a 2020  ception as e:.  
+00003530: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00003540: 2266 6169 6c65 6420 746f 2063 6f6e 6e65  "failed to conne
+00003550: 6374 2229 0a20 2020 2020 2020 2020 2020  ct").           
+00003560: 2072 6169 7365 2065 0a0a 2020 2020 6465   raise e..    de
+00003570: 6620 636c 6f73 6528 7365 6c66 293a 0a20  f close(self):. 
+00003580: 2020 2020 2020 2073 656c 662e 736f 636b         self.sock
+00003590: 6574 412e 636c 6f73 6528 290a 2020 2020  etA.close().    
+000035a0: 2020 2020 7365 6c66 2e73 6f63 6b65 7442      self.socketB
+000035b0: 2e63 6c6f 7365 2829 0a0a 0a63 6c61 7373  .close()...class
+000035c0: 2053 5348 5256 3a0a 2020 2020 6465 6620   SSHRV:.    def 
+000035d0: 5f5f 696e 6974 5f5f 2873 656c 662c 2064  __init__(self, d
+000035e0: 6573 7469 6e61 7469 6f6e 2c20 706f 7274  estination, port
+000035f0: 2c20 6c6f 6361 6c5f 706f 7274 3d32 322c  , local_port=22,
+00003600: 2076 6572 626f 7365 3d46 616c 7365 293a   verbose=False):
+00003610: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
+00003620: 6767 6572 203d 206c 6f67 6769 6e67 2e67  gger = logging.g
+00003630: 6574 4c6f 6767 6572 2822 7373 6872 7622  etLogger("sshrv"
+00003640: 290a 2020 2020 2020 2020 7365 6c66 2e68  ).        self.h
+00003650: 6f73 7420 3d20 2222 0a20 2020 2020 2020  ost = "".       
+00003660: 2073 656c 662e 6465 7374 696e 6174 696f   self.destinatio
+00003670: 6e20 3d20 6465 7374 696e 6174 696f 6e0a  n = destination.
+00003680: 2020 2020 2020 2020 7365 6c66 2e6c 6f63          self.loc
+00003690: 616c 5f73 7368 5f70 6f72 7420 3d20 6c6f  al_ssh_port = lo
+000036a0: 6361 6c5f 706f 7274 0a20 2020 2020 2020  cal_port.       
+000036b0: 2073 656c 662e 7374 7265 616d 696e 675f   self.streaming_
+000036c0: 706f 7274 203d 2070 6f72 740a 2020 2020  port = port.    
+000036d0: 2020 2020 7365 6c66 2e73 6f63 6b65 745f      self.socket_
+000036e0: 636f 6e6e 6563 746f 7220 3d20 4e6f 6e65  connector = None
+000036f0: 0a20 2020 2020 2020 2073 656c 662e 7665  .        self.ve
+00003700: 7262 6f73 6520 3d20 7665 7262 6f73 650a  rbose = verbose.
+00003710: 0a20 2020 2064 6566 2072 756e 2873 656c  .    def run(sel
+00003720: 6629 3a0a 2020 2020 2020 2020 7472 793a  f):.        try:
+00003730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00003740: 662e 686f 7374 203d 2067 6574 686f 7374  f.host = gethost
+00003750: 6279 6e61 6d65 2827 6c6f 6361 6c68 6f73  byname('localhos
+00003760: 7427 290a 2020 2020 2020 2020 2020 2020  t').            
+00003770: 736f 636b 6574 5f63 6f6e 6e65 6374 6f72  socket_connector
+00003780: 203d 2053 6f63 6b65 7443 6f6e 6e65 6374   = SocketConnect
+00003790: 6f72 2873 656c 662e 686f 7374 2c20 7365  or(self.host, se
+000037a0: 6c66 2e6c 6f63 616c 5f73 7368 5f70 6f72  lf.local_ssh_por
+000037b0: 742c 2073 656c 662e 6465 7374 696e 6174  t, self.destinat
+000037c0: 696f 6e2c 2073 656c 662e 7374 7265 616d  ion, self.stream
+000037d0: 696e 675f 706f 7274 2c20 7665 7262 6f73  ing_port, verbos
+000037e0: 653d 7365 6c66 2e76 6572 626f 7365 290a  e=self.verbose).
+000037f0: 2020 2020 2020 2020 2020 2020 7431 203d              t1 =
+00003800: 2074 6872 6561 6469 6e67 2e54 6872 6561   threading.Threa
+00003810: 6428 7461 7267 6574 3d73 6f63 6b65 745f  d(target=socket_
+00003820: 636f 6e6e 6563 746f 722e 636f 6e6e 6563  connector.connec
+00003830: 7429 0a20 2020 2020 2020 2020 2020 2074  t).            t
+00003840: 312e 7374 6172 7428 290a 2020 2020 2020  1.start().      
+00003850: 2020 2020 2020 7365 6c66 2e73 6f63 6b65        self.socke
+00003860: 745f 636f 6e6e 6563 746f 7220 3d20 7431  t_connector = t1
+00003870: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00003880: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
+00003890: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+000038a0: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
+000038b0: 2020 2020 7261 6973 6520 650a 0a20 2020      raise e..   
+000038c0: 2064 6566 2069 735f 616c 6976 6528 7365   def is_alive(se
+000038d0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+000038e0: 7572 6e20 7365 6c66 2e73 6f63 6b65 745f  urn self.socket_
+000038f0: 636f 6e6e 6563 746f 722e 6973 5f61 6c69  connector.is_ali
+00003900: 7665 2829 0a0a 0a63 6c61 7373 2053 5348  ve()...class SSH
+00003910: 4e50 4443 6c69 656e 743a 0a20 2020 2064  NPDClient:.    d
+00003920: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+00003930: 2c20 6174 7369 676e 2c20 6d61 6e61 6765  , atsign, manage
+00003940: 725f 6174 7369 676e 2c20 6465 7669 6365  r_atsign, device
+00003950: 3d22 6465 6661 756c 7422 2c20 7573 6572  ="default", user
+00003960: 6e61 6d65 3d4e 6f6e 652c 2076 6572 626f  name=None, verbo
+00003970: 7365 3d46 616c 7365 2c20 6578 7065 6374  se=False, expect
+00003980: 696e 675f 7373 685f 6b65 7973 3d46 616c  ing_ssh_keys=Fal
+00003990: 7365 293a 0a20 2020 2020 2020 2023 2041  se):.        # A
+000039a0: 7443 6c69 656e 7420 5374 7566 660a 2020  tClient Stuff.  
+000039b0: 2020 2020 2020 7365 6c66 2e61 7473 6967        self.atsig
+000039c0: 6e20 3d20 6174 7369 676e 0a20 2020 2020  n = atsign.     
+000039d0: 2020 2073 656c 662e 6d61 6e61 6765 725f     self.manager_
+000039e0: 6174 7369 676e 203d 206d 616e 6167 6572  atsign = manager
+000039f0: 5f61 7473 6967 6e0a 2020 2020 2020 2020  _atsign.        
+00003a00: 7365 6c66 2e64 6576 6963 6520 3d20 6465  self.device = de
+00003a10: 7669 6365 0a20 2020 2020 2020 2073 656c  vice.        sel
+00003a20: 662e 7573 6572 6e61 6d65 203d 2075 7365  f.username = use
+00003a30: 726e 616d 650a 2020 2020 2020 2020 7365  rname.        se
+00003a40: 6c66 2e64 6576 6963 655f 6e61 6d65 7370  lf.device_namesp
+00003a50: 6163 6520 3d20 6622 2e7b 6465 7669 6365  ace = f".{device
+00003a60: 7d2e 7373 686e 7022 0a20 2020 2020 2020  }.sshnp".       
+00003a70: 2073 656c 662e 6174 5f63 6c69 656e 7420   self.at_client 
+00003a80: 3d20 4174 436c 6965 6e74 2841 7453 6967  = AtClient(AtSig
+00003a90: 6e28 6174 7369 676e 292c 2071 7565 7565  n(atsign), queue
+00003aa0: 3d51 7565 7565 286d 6178 7369 7a65 3d32  =Queue(maxsize=2
+00003ab0: 3029 2c20 7665 7262 6f73 653d 7665 7262  0), verbose=verb
+00003ac0: 6f73 6529 0a20 2020 2020 2020 2023 2053  ose).        # S
+00003ad0: 5348 2053 7475 6666 0a20 2020 2020 2020  SH Stuff.       
+00003ae0: 2073 656c 662e 7373 685f 636c 6965 6e74   self.ssh_client
+00003af0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00003b00: 7365 6c66 2e72 7620 3d20 4e6f 6e65 0a20  self.rv = None. 
+00003b10: 2020 2020 2020 2073 656c 662e 6578 7065         self.expe
+00003b20: 6374 696e 675f 7373 685f 6b65 7973 203d  cting_ssh_keys =
+00003b30: 2065 7870 6563 7469 6e67 5f73 7368 5f6b   expecting_ssh_k
+00003b40: 6579 730a 2020 2020 2020 2020 2320 4c6f  eys.        # Lo
+00003b50: 6767 6572 0a20 2020 2020 2020 2073 656c  gger.        sel
+00003b60: 662e 6c6f 6767 6572 203d 206c 6f67 6769  f.logger = loggi
+00003b70: 6e67 2e67 6574 4c6f 6767 6572 2822 7373  ng.getLogger("ss
+00003b80: 686e 7064 2229 0a20 2020 2020 2020 2073  hnpd").        s
+00003b90: 656c 662e 6c6f 6767 6572 2e73 6574 4c65  elf.logger.setLe
+00003ba0: 7665 6c28 286c 6f67 6769 6e67 2e44 4542  vel((logging.DEB
+00003bb0: 5547 2069 6620 7665 7262 6f73 6520 656c  UG if verbose el
+00003bc0: 7365 206c 6f67 6769 6e67 2e49 4e46 4f29  se logging.INFO)
+00003bd0: 290a 2020 2020 2020 2020 7365 6c66 2e6c  ).        self.l
+00003be0: 6f67 6765 722e 6164 6448 616e 646c 6572  ogger.addHandler
+00003bf0: 286c 6f67 6769 6e67 2e53 7472 6561 6d48  (logging.StreamH
+00003c00: 616e 646c 6572 2829 290a 2020 2020 2020  andler()).      
+00003c10: 2020 2320 4469 7265 6374 6f72 7920 5374    # Directory St
+00003c20: 7566 660a 2020 2020 2020 2020 686f 6d65  uff.        home
+00003c30: 5f64 6972 203d 206f 732e 7061 7468 2e65  _dir = os.path.e
+00003c40: 7870 616e 6475 7365 7228 227e 2229 0a20  xpanduser("~"). 
+00003c50: 2020 2020 2020 2073 656c 662e 7373 685f         self.ssh_
+00003c60: 7061 7468 203d 2066 227b 686f 6d65 5f64  path = f"{home_d
+00003c70: 6972 7d2f 2e73 7368 220a 0a20 2020 2020  ir}/.ssh"..     
+00003c80: 2020 2073 656c 662e 7468 7265 6164 7320     self.threads 
+00003c90: 3d20 5b5d 0a20 2020 2020 2020 2073 656c  = [].        sel
+00003ca0: 662e 656e 6372 7970 7465 645f 7175 6575  f.encrypted_queu
+00003cb0: 6520 3d20 5175 6575 6528 290a 0a20 2020  e = Queue()..   
+00003cc0: 2064 6566 2073 7461 7274 2873 656c 6629   def start(self)
+00003cd0: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+00003ce0: 662e 7573 6572 6e61 6d65 3a0a 2020 2020  f.username:.    
+00003cf0: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+00003d00: 5f75 7365 726e 616d 6528 290a 0a20 2020  _username()..   
+00003d10: 2020 2020 2073 656c 662e 7468 7265 6164       self.thread
+00003d20: 732e 6170 7065 6e64 2874 6872 6561 6469  s.append(threadi
+00003d30: 6e67 2e54 6872 6561 6428 7461 7267 6574  ng.Thread(target
+00003d40: 3d73 656c 662e 6174 5f63 6c69 656e 742e  =self.at_client.
+00003d50: 7374 6172 745f 6d6f 6e69 746f 722c 2061  start_monitor, a
+00003d60: 7267 733d 2873 656c 662e 6465 7669 6365  rgs=(self.device
+00003d70: 5f6e 616d 6573 7061 6365 2c29 2c20 6461  _namespace,), da
+00003d80: 656d 6f6e 3d54 7275 6529 290a 2020 2020  emon=True)).    
+00003d90: 2020 2020 7365 6c66 2e74 6872 6561 6473      self.threads
+00003da0: 2e61 7070 656e 6428 7468 7265 6164 696e  .append(threadin
+00003db0: 672e 5468 7265 6164 2874 6172 6765 743d  g.Thread(target=
+00003dc0: 7365 6c66 2e68 616e 646c 655f 6e6f 7469  self.handle_noti
+00003dd0: 6669 6361 7469 6f6e 732c 2020 6461 656d  fications,  daem
+00003de0: 6f6e 3d54 7275 6529 290a 2020 2020 2020  on=True)).      
+00003df0: 2020 7365 6c66 2e74 6872 6561 6473 2e61    self.threads.a
+00003e00: 7070 656e 6428 7468 7265 6164 696e 672e  ppend(threading.
+00003e10: 5468 7265 6164 2874 6172 6765 743d 7365  Thread(target=se
+00003e20: 6c66 2e68 616e 646c 655f 6576 656e 7473  lf.handle_events
+00003e30: 2c20 2064 6165 6d6f 6e3d 5472 7565 2929  ,  daemon=True))
+00003e40: 0a0a 2020 2020 2020 2020 666f 7220 7468  ..        for th
+00003e50: 7265 6164 2069 6e20 7365 6c66 2e74 6872  read in self.thr
+00003e60: 6561 6473 3a0a 2020 2020 2020 2020 2020  eads:.          
+00003e70: 2020 7468 7265 6164 2e73 7461 7274 2829    thread.start()
+00003e80: 0a0a 2020 2020 6465 6620 636c 6f73 6528  ..    def close(
+00003e90: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
+00003ea0: 656c 662e 7468 7265 6164 732e 636c 6561  elf.threads.clea
+00003eb0: 7228 290a 2020 2020 2020 2020 7379 732e  r().        sys.
+00003ec0: 6578 6974 2829 0a0a 2020 2020 6465 6620  exit()..    def 
+00003ed0: 6973 5f61 6c69 7665 2873 656c 6629 3a0a  is_alive(self):.
+00003ee0: 2020 2020 2020 2020 666f 7265 6163 685f          foreach_
+00003ef0: 7468 7265 6164 203d 205b 7468 7265 6164  thread = [thread
+00003f00: 2e69 735f 616c 6976 6528 2920 666f 7220  .is_alive() for 
+00003f10: 7468 7265 6164 2069 6e20 7365 6c66 2e74  thread in self.t
+00003f20: 6872 6561 6473 5d0a 2020 2020 2020 2020  hreads].        
+00003f30: 7265 7475 726e 2061 6c6c 2866 6f72 6561  return all(forea
+00003f40: 6368 5f74 6872 6561 6429 0a0a 2020 2020  ch_thread)..    
+00003f50: 6465 6620 7365 745f 7573 6572 6e61 6d65  def set_username
+00003f60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00003f70: 7573 6572 6e61 6d65 203d 2067 6574 7061  username = getpa
+00003f80: 7373 2e67 6574 7573 6572 2829 0a20 2020  ss.getuser().   
+00003f90: 2020 2020 2075 7365 726e 616d 655f 6b65       username_ke
+00003fa0: 7920 3d20 5368 6172 6564 4b65 7928 0a20  y = SharedKey(. 
+00003fb0: 2020 2020 2020 2020 2020 2066 2275 7365             f"use
+00003fc0: 726e 616d 652e 7b73 656c 662e 6465 7669  rname.{self.devi
+00003fd0: 6365 7d2e 7373 686e 7022 2c20 4174 5369  ce}.sshnp", AtSi
+00003fe0: 676e 2873 656c 662e 6174 7369 676e 292c  gn(self.atsign),
+00003ff0: 2041 7453 6967 6e28 7365 6c66 2e6d 616e   AtSign(self.man
+00004000: 6167 6572 5f61 7473 6967 6e29 290a 2020  ager_atsign)).  
+00004010: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
+00004020: 204d 6574 6164 6174 6128 6976 5f6e 6f6e   Metadata(iv_non
+00004030: 6365 3d45 6e63 7279 7074 696f 6e55 7469  ce=EncryptionUti
+00004040: 6c2e 6765 6e65 7261 7465 5f69 765f 6e6f  l.generate_iv_no
+00004050: 6e63 6528 292c 2069 735f 7075 626c 6963  nce(), is_public
+00004060: 3d46 616c 7365 2c20 6973 5f65 6e63 7279  =False, is_encry
+00004070: 7074 6564 3d54 7275 652c 2069 735f 6869  pted=True, is_hi
+00004080: 6464 656e 3d46 616c 7365 290a 2020 2020  dden=False).    
+00004090: 2020 2020 7573 6572 6e61 6d65 5f6b 6579      username_key
+000040a0: 2e6d 6574 6164 6174 6120 3d20 6d65 7461  .metadata = meta
+000040b0: 6461 7461 0a20 2020 2020 2020 2075 7365  data.        use
+000040c0: 726e 616d 655f 6b65 792e 6361 6368 6528  rname_key.cache(
+000040d0: 2d31 2c20 5472 7565 290a 2020 2020 2020  -1, True).      
+000040e0: 2020 7365 6c66 2e61 745f 636c 6965 6e74    self.at_client
+000040f0: 2e70 7574 2875 7365 726e 616d 655f 6b65  .put(username_ke
+00004100: 792c 2075 7365 726e 616d 6529 0a20 2020  y, username).   
+00004110: 2020 2020 2073 656c 662e 7573 6572 6e61       self.userna
+00004120: 6d65 203d 2075 7365 726e 616d 650a 0a20  me = username.. 
+00004130: 2020 2023 2052 756e 6e69 6e67 2069 6e20     # Running in 
+00004140: 6120 7468 7265 6164 0a20 2020 2064 6566  a thread.    def
+00004150: 2068 616e 646c 655f 6e6f 7469 6669 6361   handle_notifica
+00004160: 7469 6f6e 7328 7365 6c66 293a 0a20 2020  tions(self):.   
+00004170: 2020 2020 2077 6869 6c65 2054 7275 653a       while True:
+00004180: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+00004190: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000041a0: 2020 6174 5f65 7665 6e74 203d 2073 656c    at_event = sel
+000041b0: 662e 6174 5f63 6c69 656e 742e 7175 6575  f.at_client.queu
+000041c0: 652e 6765 7428 626c 6f63 6b3d 4661 6c73  e.get(block=Fals
+000041d0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+000041e0: 2020 2065 7665 6e74 5f74 7970 6520 3d20     event_type = 
+000041f0: 6174 5f65 7665 6e74 2e65 7665 6e74 5f74  at_event.event_t
+00004200: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+00004210: 2020 2020 6576 656e 745f 6461 7461 203d      event_data =
+00004220: 2061 745f 6576 656e 742e 6576 656e 745f   at_event.event_
+00004230: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
+00004240: 2020 2020 2069 6620 6576 656e 745f 7479       if event_ty
+00004250: 7065 203d 3d20 4174 4576 656e 7454 7970  pe == AtEventTyp
+00004260: 652e 5550 4441 5445 5f4e 4f54 4946 4943  e.UPDATE_NOTIFIC
+00004270: 4154 494f 4e3a 0a20 2020 2020 2020 2020  ATION:.         
+00004280: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00004290: 656e 6372 7970 7465 645f 7175 6575 652e  encrypted_queue.
+000042a0: 7075 7428 6174 5f65 7665 6e74 290a 2020  put(at_event).  
+000042b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000042c0: 2065 7665 6e74 5f74 7970 6520 213d 2041   event_type != A
+000042d0: 7445 7665 6e74 5479 7065 2e44 4543 5259  tEventType.DECRY
+000042e0: 5054 4544 5f55 5044 4154 455f 4e4f 5449  PTED_UPDATE_NOTI
+000042f0: 4649 4341 5449 4f4e 3a0a 2020 2020 2020  FICATION:.      
+00004300: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00004310: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
+00004320: 2020 2020 2020 206b 6579 203d 2065 7665         key = eve
+00004330: 6e74 5f64 6174 615b 226b 6579 225d 2e73  nt_data["key"].s
+00004340: 706c 6974 2822 3a22 295b 315d 2e73 706c  plit(":")[1].spl
+00004350: 6974 2822 2e22 295b 305d 0a20 2020 2020  it(".")[0].     
+00004360: 2020 2020 2020 2020 2020 2064 6563 7279             decry
+00004370: 7074 6564 5f76 616c 7565 203d 2073 7472  pted_value = str
+00004380: 2865 7665 6e74 5f64 6174 615b 2264 6563  (event_data["dec
+00004390: 7279 7074 6564 5661 6c75 6522 5d29 0a0a  ryptedValue"])..
+000043a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000043b0: 6966 206b 6579 203d 3d20 2273 7368 7075  if key == "sshpu
+000043c0: 626c 6963 6b65 7922 3a0a 2020 2020 2020  blickey":.      
+000043d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000043e0: 6c66 2e6c 6f67 6765 722e 6465 6275 6728  lf.logger.debug(
+000043f0: 6627 7373 6820 5075 626c 6963 204b 6579  f'ssh Public Key
+00004400: 2072 6563 6569 7665 6420 6672 6f6d 2024   received from $
+00004410: 7b65 7665 6e74 5f64 6174 615b 2266 726f  {event_data["fro
+00004420: 6d22 5d7d 206e 6f74 6966 6963 6174 696f  m"]} notificatio
+00004430: 6e20 6964 203a 2024 7b65 7665 6e74 5f64  n id : ${event_d
+00004440: 6174 615b 2269 6422 5d7d 2729 0a20 2020  ata["id"]}').   
+00004450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004460: 2073 656c 662e 5f68 616e 646c 655f 7373   self._handle_ss
+00004470: 685f 7075 626c 6963 5f6b 6579 2864 6563  h_public_key(dec
+00004480: 7279 7074 6564 5f76 616c 7565 290a 2020  rypted_value).  
+00004490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044a0: 2020 636f 6e74 696e 7565 0a0a 2020 2020    continue..    
+000044b0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+000044c0: 6579 203d 3d20 2773 7368 5f72 6571 7565  ey == 'ssh_reque
+000044d0: 7374 273a 0a20 2020 2020 2020 2020 2020  st':.           
+000044e0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+000044f0: 6767 6572 2e64 6562 7567 280a 2020 2020  gger.debug(.    
+00004500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004510: 2020 2020 6627 7373 6820 6361 6c6c 6261      f'ssh callba
+00004520: 636b 2072 6571 7565 7374 6564 2066 726f  ck requested fro
+00004530: 6d20 7b65 7665 6e74 5f64 6174 615b 2266  m {event_data["f
+00004540: 726f 6d22 5d7d 206e 6f74 6966 6963 6174  rom"]} notificat
+00004550: 696f 6e20 6964 203a 207b 6576 656e 745f  ion id : {event_
+00004560: 6461 7461 5b22 6964 225d 7d27 290a 2020  data["id"]}').  
+00004570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004580: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00004590: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000045a0: 6872 6561 6469 6e67 2e54 6872 6561 6428  hreading.Thread(
+000045b0: 7461 7267 6574 3d73 656c 662e 6469 7265  target=self.dire
+000045c0: 6374 5f73 7368 2c20 6172 6773 3d28 6174  ct_ssh, args=(at
+000045d0: 5f65 7665 6e74 2c29 292e 7374 6172 7428  _event,)).start(
+000045e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000045f0: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00004600: 6570 7469 6f6e 2061 7320 653a 0a20 2020  eption as e:.   
+00004610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004620: 2020 2020 2072 6169 7365 2065 0a20 2020       raise e.   
+00004630: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00004640: 456d 7074 793a 0a20 2020 2020 2020 2020  Empty:.         
+00004650: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
+00004660: 2023 2052 756e 6e69 6e67 2069 6e20 6120   # Running in a 
+00004670: 7468 7265 6164 0a20 2020 2064 6566 2068  thread.    def h
+00004680: 616e 646c 655f 6576 656e 7473 2873 656c  andle_events(sel
+00004690: 6629 3a0a 2020 2020 2020 2020 7768 696c  f):.        whil
+000046a0: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
+000046b0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+000046c0: 2020 2020 2020 2020 2061 745f 6576 656e           at_even
+000046d0: 7420 3d20 7365 6c66 2e65 6e63 7279 7074  t = self.encrypt
+000046e0: 6564 5f71 7565 7565 2e67 6574 2862 6c6f  ed_queue.get(blo
+000046f0: 636b 3d46 616c 7365 290a 2020 2020 2020  ck=False).      
+00004700: 2020 2020 2020 2020 2020 6576 656e 745f            event_
+00004710: 7479 7065 203d 2061 745f 6576 656e 742e  type = at_event.
+00004720: 6576 656e 745f 7479 7065 0a20 2020 2020  event_type.     
+00004730: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
+00004740: 656e 745f 7479 7065 203d 3d20 4174 4576  ent_type == AtEv
+00004750: 656e 7454 7970 652e 5550 4441 5445 5f4e  entType.UPDATE_N
+00004760: 4f54 4946 4943 4154 494f 4e3a 0a20 2020  OTIFICATION:.   
+00004770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004780: 2073 656c 662e 6174 5f63 6c69 656e 742e   self.at_client.
+00004790: 7365 636f 6e64 6172 795f 636f 6e6e 6563  secondary_connec
+000047a0: 7469 6f6e 2e65 7865 6375 7465 5f63 6f6d  tion.execute_com
+000047b0: 6d61 6e64 280a 2020 2020 2020 2020 2020  mand(.          
+000047c0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+000047d0: 6f74 6966 793a 7265 6d6f 7665 3a22 202b  otify:remove:" +
+000047e0: 2061 745f 6576 656e 742e 6576 656e 745f   at_event.event_
+000047f0: 6461 7461 5b22 6964 225d 0a20 2020 2020  data["id"].     
+00004800: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00004810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004820: 2073 656c 662e 6174 5f63 6c69 656e 742e   self.at_client.
+00004830: 6861 6e64 6c65 5f65 7665 6e74 2873 656c  handle_event(sel
+00004840: 662e 6174 5f63 6c69 656e 742e 7175 6575  f.at_client.queu
+00004850: 652c 2061 745f 6576 656e 7429 0a20 2020  e, at_event).   
+00004860: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00004870: 456d 7074 793a 0a20 2020 2020 2020 2020  Empty:.         
+00004880: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
+00004890: 2064 6566 2064 6972 6563 745f 7373 6828   def direct_ssh(
+000048a0: 7365 6c66 2c20 6576 656e 743a 2041 7445  self, event: AtE
+000048b0: 7665 6e74 293a 0a20 2020 2020 2020 2075  vent):.        u
+000048c0: 7569 6420 3d20 6576 656e 742e 6576 656e  uid = event.even
+000048d0: 745f 6461 7461 5b22 6964 225d 0a20 2020  t_data["id"].   
+000048e0: 2020 2020 2073 7368 5f6c 6973 7420 3d20       ssh_list = 
+000048f0: 6a73 6f6e 2e6c 6f61 6473 2865 7665 6e74  json.loads(event
+00004900: 2e65 7665 6e74 5f64 6174 615b 2264 6563  .event_data["dec
+00004910: 7279 7074 6564 5661 6c75 6522 5d29 5b27  ryptedValue"])['
+00004920: 7061 796c 6f61 6427 5d0a 2020 2020 2020  payload'].      
+00004930: 2020 6976 5f6e 6f6e 6365 203d 2045 6e63    iv_nonce = Enc
+00004940: 7279 7074 696f 6e55 7469 6c2e 6765 6e65  ryptionUtil.gene
+00004950: 7261 7465 5f69 765f 6e6f 6e63 6528 290a  rate_iv_nonce().
+00004960: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00004970: 203d 204d 6574 6164 6174 6128 0a20 2020   = Metadata(.   
+00004980: 2020 2020 2020 2020 2074 746c 3d31 3030           ttl=100
+00004990: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+000049a0: 7474 723d 2d31 2c0a 2020 2020 2020 2020  ttr=-1,.        
+000049b0: 2020 2020 6976 5f6e 6f6e 6365 3d69 765f      iv_nonce=iv_
+000049c0: 6e6f 6e63 652c 0a20 2020 2020 2020 2029  nonce,.        )
+000049d0: 0a20 2020 2020 2020 2061 745f 6b65 7920  .        at_key 
+000049e0: 3d20 4174 4b65 7928 6622 7b75 7569 647d  = AtKey(f"{uuid}
+000049f0: 2e7b 7365 6c66 2e64 6576 6963 657d 222c  .{self.device}",
+00004a00: 2073 656c 662e 6174 7369 676e 290a 2020   self.atsign).  
+00004a10: 2020 2020 2020 6174 5f6b 6579 2e73 6861        at_key.sha
+00004a20: 7265 645f 7769 7468 203d 2041 7453 6967  red_with = AtSig
+00004a30: 6e28 7365 6c66 2e6d 616e 6167 6572 5f61  n(self.manager_a
+00004a40: 7473 6967 6e29 0a20 2020 2020 2020 2061  tsign).        a
+00004a50: 745f 6b65 792e 6d65 7461 6461 7461 203d  t_key.metadata =
+00004a60: 206d 6574 6164 6174 610a 2020 2020 2020   metadata.      
+00004a70: 2020 6174 5f6b 6579 2e6e 616d 6573 7061    at_key.namespa
+00004a80: 6365 203d 2073 656c 662e 6465 7669 6365  ce = self.device
+00004a90: 5f6e 616d 6573 7061 6365 0a20 2020 2020  _namespace.     
+00004aa0: 2020 2075 7569 6420 3d20 7373 685f 6c69     uuid = ssh_li
+00004ab0: 7374 5b27 7365 7373 696f 6e49 6427 5d0a  st['sessionId'].
+00004ac0: 2020 2020 2020 2020 6174 5f6b 6579 203d          at_key =
+00004ad0: 2041 744b 6579 2866 227b 7575 6964 7d22   AtKey(f"{uuid}"
+00004ae0: 2c20 7365 6c66 2e61 7473 6967 6e29 0a20  , self.atsign). 
+00004af0: 2020 2020 2020 2061 745f 6b65 792e 7368         at_key.sh
+00004b00: 6172 6564 5f77 6974 6820 3d20 4174 5369  ared_with = AtSi
+00004b10: 676e 2873 656c 662e 6d61 6e61 6765 725f  gn(self.manager_
+00004b20: 6174 7369 676e 290a 2020 2020 2020 2020  atsign).        
+00004b30: 6174 5f6b 6579 2e6d 6574 6164 6174 6120  at_key.metadata 
+00004b40: 3d20 6d65 7461 6461 7461 0a20 2020 2020  = metadata.     
+00004b50: 2020 2061 745f 6b65 792e 6e61 6d65 7370     at_key.namesp
+00004b60: 6163 6520 3d20 7365 6c66 2e64 6576 6963  ace = self.devic
+00004b70: 655f 6e61 6d65 7370 6163 650a 2020 2020  e_namespace.    
+00004b80: 2020 2020 686f 7374 6e61 6d65 203d 2073      hostname = s
+00004b90: 7368 5f6c 6973 745b 2768 6f73 7427 5d0a  sh_list['host'].
+00004ba0: 2020 2020 2020 2020 706f 7274 203d 2073          port = s
+00004bb0: 7368 5f6c 6973 745b 2770 6f72 7427 5d0a  sh_list['port'].
+00004bc0: 2020 2020 2020 2020 7365 7373 696f 6e5f          session_
+00004bd0: 6964 203d 2073 7368 5f6c 6973 745b 2773  id = ssh_list['s
+00004be0: 6573 7369 6f6e 4964 275d 0a20 2020 2020  essionId'].     
+00004bf0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00004c00: 2020 2020 7373 6872 7620 3d20 5353 4852      sshrv = SSHR
+00004c10: 5628 686f 7374 6e61 6d65 2c20 706f 7274  V(hostname, port
+00004c20: 290a 2020 2020 2020 2020 2020 2020 7373  ).            ss
+00004c30: 6872 762e 7275 6e28 290a 2020 2020 2020  hrv.run().      
+00004c40: 2020 2020 2020 7365 6c66 2e72 7620 3d20        self.rv = 
+00004c50: 7373 6872 760a 2020 2020 2020 2020 2020  sshrv.          
+00004c60: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+00004c70: 666f 2822 7373 6872 7620 7374 6172 7465  fo("sshrv starte
+00004c80: 6420 4020 2220 2b20 686f 7374 6e61 6d65  d @ " + hostname
+00004c90: 202b 2022 206f 6e20 706f 7274 2022 202b   + " on port " +
+00004ca0: 2073 7472 2870 6f72 7429 290a 2020 2020   str(port)).    
+00004cb0: 2020 2020 2020 2020 2870 7562 6c69 635f          (public_
+00004cc0: 6b65 792c 2070 7269 7661 7465 5f6b 6579  key, private_key
+00004cd0: 2920 3d20 7365 6c66 2e67 656e 6572 6174  ) = self.generat
+00004ce0: 655f 7373 685f 6b65 7973 2873 6573 7369  e_ssh_keys(sessi
+00004cf0: 6f6e 5f69 6429 0a20 2020 2020 2020 2020  on_id).         
+00004d00: 2020 2070 7269 7661 7465 5f6b 6579 203d     private_key =
+00004d10: 2070 7269 7661 7465 5f6b 6579 2e72 6570   private_key.rep
+00004d20: 6c61 6365 2822 5c6e 222c 2022 5c5c 6e22  lace("\n", "\\n"
+00004d30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00004d40: 6c66 2e68 616e 646c 655f 7373 685f 7075  lf.handle_ssh_pu
+00004d50: 626c 6963 5f6b 6579 2870 7562 6c69 635f  blic_key(public_
+00004d60: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
+00004d70: 2064 6174 6120 3d20 6627 7b7b 2273 7461   data = f'{{"sta
+00004d80: 7475 7322 3a22 636f 6e6e 6563 7465 6422  tus":"connected"
+00004d90: 2c22 7365 7373 696f 6e49 6422 3a22 7b73  ,"sessionId":"{s
+00004da0: 6573 7369 6f6e 5f69 647d 222c 2265 7068  ession_id}","eph
+00004db0: 656d 6572 616c 5072 6976 6174 654b 6579  emeralPrivateKey
+00004dc0: 223a 227b 7072 6976 6174 655f 6b65 797d  ":"{private_key}
+00004dd0: 227d 7d27 0a20 2020 2020 2020 2020 2020  "}}'.           
+00004de0: 2073 6967 6e61 7475 7265 203d 2045 6e63   signature = Enc
+00004df0: 7279 7074 696f 6e55 7469 6c2e 7369 676e  ryptionUtil.sign
+00004e00: 5f73 6861 3235 365f 7273 6128 6461 7461  _sha256_rsa(data
+00004e10: 2c20 7365 6c66 2e61 745f 636c 6965 6e74  , self.at_client
+00004e20: 2e6b 6579 735b 4b65 7973 5574 696c 2e65  .keys[KeysUtil.e
+00004e30: 6e63 7279 7074 696f 6e5f 7072 6976 6174  ncryption_privat
+00004e40: 655f 6b65 795f 6e61 6d65 5d29 0a20 2020  e_key_name]).   
+00004e50: 2020 2020 2020 2020 2072 6573 706f 6e73           respons
+00004e60: 6520 3d20 6627 7b7b 2270 6179 6c6f 6164  e = f'{{"payload
+00004e70: 223a 7b64 6174 617d 2c22 7369 676e 6174  ":{data},"signat
+00004e80: 7572 6522 3a22 7b73 6967 6e61 7475 7265  ure":"{signature
+00004e90: 7d22 2c22 6861 7368 696e 6741 6c67 6f22  }","hashingAlgo"
+00004ea0: 3a22 7368 6132 3536 222c 2273 6967 6e69  :"sha256","signi
+00004eb0: 6e67 416c 676f 223a 2272 7361 3230 3438  ngAlgo":"rsa2048
+00004ec0: 227d 7d27 0a20 2020 2020 2020 2020 2020  "}}'.           
+00004ed0: 2073 656c 662e 6174 5f63 6c69 656e 742e   self.at_client.
+00004ee0: 6e6f 7469 6679 2861 745f 6b65 792c 2072  notify(at_key, r
+00004ef0: 6573 706f 6e73 652c 2073 6573 7369 6f6e  esponse, session
+00004f00: 5f69 643d 7575 6964 290a 2020 2020 2020  _id=uuid).      
+00004f10: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
+00004f20: 722e 696e 666f 2822 7365 6e74 2073 7368  r.info("sent ssh
+00004f30: 206e 6f74 6966 6963 6174 696f 6e20 746f   notification to
+00004f40: 2022 202b 2061 745f 6b65 792e 7368 6172   " + at_key.shar
+00004f50: 6564 5f77 6974 682e 746f 5f73 7472 696e  ed_with.to_strin
+00004f60: 6728 2920 2b20 2220 7769 7468 2069 643a  g() + " with id:
+00004f70: 2220 2b20 7575 6964 290a 2020 2020 2020  " + uuid).      
+00004f80: 2020 2020 2020 7365 6c66 2e65 7068 656d        self.ephem
+00004f90: 6572 616c 5f63 6c65 616e 7570 2875 7569  eral_cleanup(uui
+00004fa0: 6429 0a0a 2020 2020 2020 2020 6578 6365  d)..        exce
+00004fb0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+00004fc0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00004fd0: 656c 662e 6c6f 6767 6572 2e65 7272 6f72  elf.logger.error
+00004fe0: 2865 290a 2020 2020 2020 2020 2020 2020  (e).            
+00004ff0: 7365 6c66 2e65 7068 656d 6572 616c 5f63  self.ephemeral_c
+00005000: 6c65 616e 7570 2875 7569 6429 0a0a 2020  leanup(uuid)..  
+00005010: 2020 6465 6620 6765 6e65 7261 7465 5f73    def generate_s
+00005020: 7368 5f6b 6579 7328 7365 6c66 2c20 7365  sh_keys(self, se
+00005030: 7373 696f 6e5f 6964 293a 0a20 2020 2020  ssion_id):.     
+00005040: 2020 2023 2047 656e 6572 6174 6520 5353     # Generate SS
+00005050: 4820 4b65 7973 0a20 2020 2020 2020 2073  H Keys.        s
+00005060: 656c 662e 6c6f 6767 6572 2e69 6e66 6f28  elf.logger.info(
+00005070: 2247 656e 6572 6174 696e 6720 5353 4820  "Generating SSH 
+00005080: 4b65 7973 2229 0a20 2020 2020 2020 2069  Keys").        i
+00005090: 6620 6e6f 7420 6f73 2e70 6174 682e 6578  f not os.path.ex
+000050a0: 6973 7473 2866 227b 7365 6c66 2e73 7368  ists(f"{self.ssh
+000050b0: 5f70 6174 687d 2f74 6d70 2f22 293a 0a20  _path}/tmp/"):. 
+000050c0: 2020 2020 2020 2020 2020 206f 732e 6d61             os.ma
+000050d0: 6b65 6469 7273 2866 227b 7365 6c66 2e73  kedirs(f"{self.s
+000050e0: 7368 5f70 6174 687d 2f74 6d70 2f22 290a  sh_path}/tmp/").
+000050f0: 2020 2020 2020 2020 7373 685f 6b65 7967          ssh_keyg
+00005100: 656e 203d 2073 7562 7072 6f63 6573 732e  en = subprocess.
+00005110: 506f 7065 6e28 0a20 2020 2020 2020 2020  Popen(.         
+00005120: 2020 205b 2273 7368 2d6b 6579 6765 6e22     ["ssh-keygen"
+00005130: 2c20 222d 7422 2c20 2265 6432 3535 3139  , "-t", "ed25519
+00005140: 222c 2022 2d61 222c 2022 3130 3022 2c20  ", "-a", "100", 
+00005150: 222d 6622 2c20 6622 7b73 6573 7369 6f6e  "-f", f"{session
+00005160: 5f69 647d 5f73 7368 6e70 222c 2022 2d71  _id}_sshnp", "-q
+00005170: 222c 2022 2d4e 222c 2022 225d 2c0a 2020  ", "-N", ""],.  
+00005180: 2020 2020 2020 2020 2020 6377 643d 6627            cwd=f'
+00005190: 7b73 656c 662e 7373 685f 7061 7468 7d2f  {self.ssh_path}/
+000051a0: 746d 702f 272c 0a20 2020 2020 2020 2020  tmp/',.         
+000051b0: 2020 2073 7464 6f75 743d 7375 6270 726f     stdout=subpro
+000051c0: 6365 7373 2e50 4950 452c 0a20 2020 2020  cess.PIPE,.     
+000051d0: 2020 2020 2020 2073 7464 6572 723d 7375         stderr=su
+000051e0: 6270 726f 6365 7373 2e50 4950 452c 0a20  bprocess.PIPE,. 
+000051f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00005200: 2073 7464 6f75 742c 2073 7464 6572 7220   stdout, stderr 
+00005210: 3d20 7373 685f 6b65 7967 656e 2e63 6f6d  = ssh_keygen.com
+00005220: 6d75 6e69 6361 7465 2829 0a20 2020 2020  municate().     
+00005230: 2020 2069 6620 7373 685f 6b65 7967 656e     if ssh_keygen
+00005240: 2e72 6574 7572 6e63 6f64 6520 213d 2030  .returncode != 0
+00005250: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00005260: 6c66 2e6c 6f67 6765 722e 6572 726f 7228  lf.logger.error(
+00005270: 2253 5348 204b 6579 2067 656e 6572 6174  "SSH Key generat
+00005280: 696f 6e20 6661 696c 6564 2229 0a20 2020  ion failed").   
+00005290: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+000052a0: 6767 6572 2e65 7272 6f72 2873 7464 6572  gger.error(stder
+000052b0: 722e 6465 636f 6465 2822 7574 662d 3822  r.decode("utf-8"
+000052c0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
+000052d0: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+000052e0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+000052f0: 696e 666f 2822 5353 4820 4b65 7973 2047  info("SSH Keys G
+00005300: 656e 6572 6174 6564 2229 0a20 2020 2020  enerated").     
+00005310: 2020 2073 7368 5f70 7562 6c69 635f 6b65     ssh_public_ke
+00005320: 7920 3d20 2222 0a20 2020 2020 2020 2073  y = "".        s
+00005330: 7368 5f70 7269 7661 7465 5f6b 6579 203d  sh_private_key =
+00005340: 2022 220a 2020 2020 2020 2020 7472 793a   "".        try:
+00005350: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+00005360: 6820 6f70 656e 2866 227b 7365 6c66 2e73  h open(f"{self.s
+00005370: 7368 5f70 6174 687d 2f74 6d70 2f7b 7365  sh_path}/tmp/{se
+00005380: 7373 696f 6e5f 6964 7d5f 7373 686e 702e  ssion_id}_sshnp.
+00005390: 7075 6222 2c20 2772 2729 2061 7320 7075  pub", 'r') as pu
+000053a0: 626c 6963 5f6b 6579 5f66 696c 653a 0a20  blic_key_file:. 
+000053b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000053c0: 7368 5f70 7562 6c69 635f 6b65 7920 3d20  sh_public_key = 
+000053d0: 7075 626c 6963 5f6b 6579 5f66 696c 652e  public_key_file.
+000053e0: 7265 6164 2829 0a0a 2020 2020 2020 2020  read()..        
+000053f0: 2020 2020 7769 7468 206f 7065 6e28 6622      with open(f"
+00005400: 7b73 656c 662e 7373 685f 7061 7468 7d2f  {self.ssh_path}/
+00005410: 746d 702f 7b73 6573 7369 6f6e 5f69 647d  tmp/{session_id}
+00005420: 5f73 7368 6e70 222c 2027 7227 2920 6173  _sshnp", 'r') as
+00005430: 2070 7269 7661 7465 5f6b 6579 5f66 696c   private_key_fil
+00005440: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00005450: 2020 2073 7368 5f70 7269 7661 7465 5f6b     ssh_private_k
+00005460: 6579 203d 2070 7269 7661 7465 5f6b 6579  ey = private_key
+00005470: 5f66 696c 652e 7265 6164 2829 0a20 2020  _file.read().   
+00005480: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+00005490: 7074 696f 6e20 6173 2065 3a0a 2020 2020  ption as e:.    
+000054a0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+000054b0: 6765 722e 6572 726f 7228 6529 0a20 2020  ger.error(e).   
+000054c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000054d0: 4661 6c73 650a 2020 2020 2020 2020 7265  False.        re
+000054e0: 7475 726e 2028 7373 685f 7075 626c 6963  turn (ssh_public
+000054f0: 5f6b 6579 2c20 7373 685f 7072 6976 6174  _key, ssh_privat
+00005500: 655f 6b65 7929 0a0a 2020 2020 6465 6620  e_key)..    def 
+00005510: 6570 6865 6d65 7261 6c5f 636c 6561 6e75  ephemeral_cleanu
+00005520: 7028 7365 6c66 2c20 7365 7373 696f 6e5f  p(self, session_
+00005530: 6964 293a 0a20 2020 2020 2020 2074 7279  id):.        try
+00005540: 3a0a 2020 2020 2020 2020 2020 2020 6f73  :.            os
+00005550: 2e72 656d 6f76 6528 6622 7b73 656c 662e  .remove(f"{self.
+00005560: 7373 685f 7061 7468 7d2f 746d 702f 7b73  ssh_path}/tmp/{s
+00005570: 6573 7369 6f6e 5f69 647d 5f73 7368 6e70  ession_id}_sshnp
+00005580: 2e70 7562 2229 0a20 2020 2020 2020 2020  .pub").         
+00005590: 2020 206f 732e 7265 6d6f 7665 2866 227b     os.remove(f"{
+000055a0: 7365 6c66 2e73 7368 5f70 6174 687d 2f74  self.ssh_path}/t
+000055b0: 6d70 2f7b 7365 7373 696f 6e5f 6964 7d5f  mp/{session_id}_
+000055c0: 7373 686e 7022 290a 2020 2020 2020 2020  sshnp").        
+000055d0: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
+000055e0: 696e 666f 2822 6570 6865 6d65 7261 6c20  info("ephemeral 
+000055f0: 7373 6820 6b65 7973 2063 6c65 616e 6564  ssh keys cleaned
+00005600: 2075 7022 290a 2020 2020 2020 2020 6578   up").        ex
+00005610: 6365 7074 2045 7863 6570 7469 6f6e 3a0a  cept Exception:.
+00005620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005630: 2e6c 6f67 6765 722e 696e 666f 2822 2229  .logger.info("")
+00005640: 0a0a 2020 2020 6465 6620 6861 6e64 6c65  ..    def handle
+00005650: 5f73 7368 5f70 7562 6c69 635f 6b65 7928  _ssh_public_key(
+00005660: 7365 6c66 2c20 7373 685f 7075 626c 6963  self, ssh_public
+00005670: 5f6b 6579 293a 0a20 2020 2020 2020 2023  _key):.        #
+00005680: 202f 2f20 4368 6563 6b20 746f 2073 6565   // Check to see
+00005690: 2069 6620 7468 6520 7373 6820 5075 626c   if the ssh Publ
+000056a0: 6963 6b65 7920 6973 2061 6c72 6561 6479  ickey is already
+000056b0: 2069 6e20 7468 6520 6669 6c65 2069 6620   in the file if 
+000056c0: 6e6f 7420 6170 7065 6e64 2074 6f20 7468  not append to th
+000056d0: 6520 7e2f 2e73 7368 2f61 7574 686f 7269  e ~/.ssh/authori
+000056e0: 7a65 645f 6b65 7973 2066 696c 650a 2020  zed_keys file.  
+000056f0: 2020 2020 2020 7772 6974 654b 6579 203d        writeKey =
+00005700: 2046 616c 7365 0a20 2020 2020 2020 2066   False.        f
+00005710: 696c 6564 6174 6120 3d20 2222 0a20 2020  iledata = "".   
+00005720: 2020 2020 2077 6974 6820 6f70 656e 2866       with open(f
+00005730: 227b 7365 6c66 2e73 7368 5f70 6174 687d  "{self.ssh_path}
+00005740: 2f61 7574 686f 7269 7a65 645f 6b65 7973  /authorized_keys
+00005750: 222c 2022 7222 2920 6173 2072 6561 643a  ", "r") as read:
+00005760: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
+00005770: 6564 6174 6120 3d20 7265 6164 2e72 6561  edata = read.rea
+00005780: 6428 290a 2020 2020 2020 2020 2020 2020  d().            
+00005790: 6966 2073 7368 5f70 7562 6c69 635f 6b65  if ssh_public_ke
+000057a0: 7920 6e6f 7420 696e 2066 696c 6564 6174  y not in filedat
+000057b0: 613a 0a20 2020 2020 2020 2020 2020 2020  a:.             
+000057c0: 2020 2077 7269 7465 4b65 7920 3d20 5472     writeKey = Tr
+000057d0: 7565 0a20 2020 2020 2020 2069 6620 7772  ue.        if wr
+000057e0: 6974 654b 6579 3a0a 2020 2020 2020 2020  iteKey:.        
+000057f0: 2020 2020 7769 7468 206f 7065 6e28 6622      with open(f"
+00005800: 7b73 656c 662e 7373 685f 7061 7468 7d2f  {self.ssh_path}/
+00005810: 6175 7468 6f72 697a 6564 5f6b 6579 7322  authorized_keys"
+00005820: 2c20 2277 2229 2061 7320 7772 6974 653a  , "w") as write:
+00005830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005840: 2077 7269 7465 2e77 7269 7465 2866 227b   write.write(f"{
+00005850: 6669 6c65 6461 7461 7d5c 6e7b 7373 685f  filedata}\n{ssh_
+00005860: 7075 626c 6963 5f6b 6579 7d22 290a 2020  public_key}").  
+00005870: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00005880: 6f67 6765 722e 6465 6275 6728 226b 6579  ogger.debug("key
+00005890: 2077 7269 7474 656e 2229 0a0a 0a64 6566   written")...def
+000058a0: 206d 6169 6e28 293a 0a20 2020 2070 6172   main():.    par
+000058b0: 7365 7220 3d20 6172 6770 6172 7365 2e41  ser = argparse.A
+000058c0: 7267 756d 656e 7450 6172 7365 7228 2273  rgumentParser("s
+000058d0: 7368 6e70 6422 290a 2020 2020 7265 7175  shnpd").    requ
+000058e0: 6972 6564 4e61 6d65 6420 3d20 7061 7273  iredNamed = pars
+000058f0: 6572 2e61 6464 5f61 7267 756d 656e 745f  er.add_argument_
+00005900: 6772 6f75 7028 2772 6571 7569 7265 6420  group('required 
+00005910: 6e61 6d65 6420 6172 6775 6d65 6e74 7327  named arguments'
+00005920: 290a 2020 2020 7265 7175 6972 6564 4e61  ).    requiredNa
+00005930: 6d65 642e 6164 645f 6172 6775 6d65 6e74  med.add_argument
+00005940: 2822 2d6d 222c 2022 2d2d 6d61 6e61 6765  ("-m", "--manage
+00005950: 7222 2c20 6465 7374 3d22 6d61 6e61 6765  r", dest="manage
+00005960: 725f 6174 7369 676e 222c 2074 7970 653d  r_atsign", type=
+00005970: 7374 722c 2068 656c 703d 2243 6c69 656e  str, help="Clien
+00005980: 7420 4174 7369 676e 2028 7373 686e 7027  t Atsign (sshnp'
+00005990: 7320 6174 7369 676e 2922 2c20 7265 7175  s atsign)", requ
+000059a0: 6972 6564 3d54 7275 6529 0a20 2020 2072  ired=True).    r
+000059b0: 6571 7569 7265 644e 616d 6564 2e61 6464  equiredNamed.add
+000059c0: 5f61 7267 756d 656e 7428 222d 6122 2c20  _argument("-a", 
+000059d0: 222d 2d61 7473 6967 6e22 2c20 6465 7374  "--atsign", dest
+000059e0: 3d22 6174 7369 676e 222c 2074 7970 653d  ="atsign", type=
+000059f0: 7374 722c 2068 656c 703d 2244 6576 6963  str, help="Devic
+00005a00: 6520 4174 7369 676e 2028 7373 686e 7064  e Atsign (sshnpd
+00005a10: 2773 2061 7473 6967 6e29 222c 2072 6571  's atsign)", req
+00005a20: 7569 7265 643d 5472 7565 290a 2020 2020  uired=True).    
+00005a30: 7265 7175 6972 6564 4e61 6d65 642e 6164  requiredNamed.ad
+00005a40: 645f 6172 6775 6d65 6e74 2822 2d64 222c  d_argument("-d",
+00005a50: 2022 2d2d 6465 7669 6365 222c 2064 6573   "--device", des
+00005a60: 743d 2264 6576 6963 6522 2c20 7479 7065  t="device", type
+00005a70: 3d73 7472 2c20 6865 6c70 3d22 4465 7669  =str, help="Devi
+00005a80: 6365 204e 616d 6522 2c20 6465 6661 756c  ce Name", defaul
+00005a90: 743d 2264 6566 6175 6c74 2229 0a20 2020  t="default").   
+00005aa0: 206f 7074 696f 6e61 6c20 3d20 7061 7273   optional = pars
+00005ab0: 6572 2e61 6464 5f61 7267 756d 656e 745f  er.add_argument_
+00005ac0: 6772 6f75 7028 276f 7074 696f 6e61 6c20  group('optional 
+00005ad0: 6172 6775 6d65 6e74 7327 290a 2020 2020  arguments').    
+00005ae0: 6f70 7469 6f6e 616c 2e61 6464 5f61 7267  optional.add_arg
+00005af0: 756d 656e 7428 222d 7322 2c20 6163 7469  ument("-s", acti
+00005b00: 6f6e 3d22 7374 6f72 655f 7472 7565 222c  on="store_true",
+00005b10: 2064 6573 743d 2265 7870 6563 7469 6e67   dest="expecting
+00005b20: 5f73 7368 5f6b 6579 7322 2c20 6865 6c70  _ssh_keys", help
+00005b30: 3d22 4164 6420 7373 6820 6b65 7920 696e  ="Add ssh key in
+00005b40: 746f 2061 7574 686f 7269 7a65 645f 6b65  to authorized_ke
+00005b50: 7973 222c 2064 6566 6175 6c74 3d46 616c  ys", default=Fal
+00005b60: 7365 290a 2020 2020 6f70 7469 6f6e 616c  se).    optional
+00005b70: 2e61 6464 5f61 7267 756d 656e 7428 222d  .add_argument("-
+00005b80: 7522 2c20 2061 6374 696f 6e3d 2773 746f  u",  action='sto
+00005b90: 7265 5f74 7275 6527 2c20 6465 7374 3d22  re_true', dest="
+00005ba0: 7573 6572 6e61 6d65 222c 2020 6865 6c70  username",  help
+00005bb0: 3d22 5573 6572 6e61 6d65 222c 2064 6566  ="Username", def
+00005bc0: 6175 6c74 3d22 6465 6661 756c 7422 2c20  ault="default", 
+00005bd0: 7265 7175 6972 6564 3d54 7275 6529 0a20  required=True). 
+00005be0: 2020 206f 7074 696f 6e61 6c2e 6164 645f     optional.add_
+00005bf0: 6172 6775 6d65 6e74 2822 2d76 222c 2061  argument("-v", a
+00005c00: 6374 696f 6e3d 2773 746f 7265 5f74 7275  ction='store_tru
+00005c10: 6527 2c20 6465 7374 3d22 7665 7262 6f73  e', dest="verbos
+00005c20: 6522 2c20 6865 6c70 3d22 5665 7262 6f73  e", help="Verbos
+00005c30: 6522 290a 2020 2020 6172 6773 203d 2070  e").    args = p
+00005c40: 6172 7365 722e 7061 7273 655f 6172 6773  arser.parse_args
+00005c50: 2829 0a20 2020 2073 7368 6e70 6420 3d20  ().    sshnpd = 
+00005c60: 5353 484e 5044 436c 6965 6e74 2861 7267  SSHNPDClient(arg
+00005c70: 732e 6174 7369 676e 2c20 6172 6773 2e6d  s.atsign, args.m
+00005c80: 616e 6167 6572 5f61 7473 6967 6e2c 2061  anager_atsign, a
+00005c90: 7267 732e 6465 7669 6365 2c20 6172 6773  rgs.device, args
+00005ca0: 2e75 7365 726e 616d 652c 2061 7267 732e  .username, args.
+00005cb0: 7665 7262 6f73 652c 2061 7267 732e 6578  verbose, args.ex
+00005cc0: 7065 6374 696e 675f 7373 685f 6b65 7973  pecting_ssh_keys
+00005cd0: 290a 2020 2020 7468 7265 6164 203d 204e  ).    thread = N
+00005ce0: 6f6e 650a 2020 2020 7768 696c 6520 5472  one.    while Tr
+00005cf0: 7565 3a0a 2020 2020 2020 2020 7472 793a  ue:.        try:
+00005d00: 0a20 2020 2020 2020 2020 2020 2074 6872  .            thr
+00005d10: 6561 6420 3d20 7468 7265 6164 696e 672e  ead = threading.
+00005d20: 5468 7265 6164 2874 6172 6765 743d 7373  Thread(target=ss
+00005d30: 686e 7064 2e73 7461 7274 290a 2020 2020  hnpd.start).    
+00005d40: 2020 2020 2020 2020 7468 7265 6164 2e73          thread.s
+00005d50: 7461 7274 2829 0a20 2020 2020 2020 2020  tart().         
+00005d60: 2020 2077 6869 6c65 2073 7368 6e70 642e     while sshnpd.
+00005d70: 6973 5f61 6c69 7665 2829 3a0a 2020 2020  is_alive():.    
+00005d80: 2020 2020 2020 2020 2020 2020 736c 6565              slee
+00005d90: 7028 3329 0a20 2020 2020 2020 2065 7863  p(3).        exc
+00005da0: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+00005db0: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
+00005dc0: 7468 7265 6164 2e6a 6f69 6e28 290a 2020  thread.join().  
+00005dd0: 2020 2020 2020 2020 2020 7373 686e 7064            sshnpd
+00005de0: 2e63 6c6f 7365 2829 0a20 2020 2020 2020  .close().       
+00005df0: 2020 2020 2070 7269 6e74 2865 290a 2020       print(e).  
+00005e00: 2020 2020 2020 7072 696e 7428 2252 6573        print("Res
+00005e10: 7461 7274 696e 6720 7373 686e 7064 2069  tarting sshnpd i
+00005e20: 6e20 3320 7365 636f 6e64 732e 2e22 290a  n 3 seconds..").
+00005e30: 2020 2020 2020 2020 736c 6565 7028 3329          sleep(3)
+00005e40: 0a0a 0a69 6620 5f5f 6e61 6d65 5f5f 203d  ...if __name__ =
+00005e50: 3d20 225f 5f6d 6169 6e5f 5f22 3a0a 2020  = "__main__":.  
+00005e60: 2020 6d61 696e 2829 0a00 0000 0000 0000    main()........
+00005e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006000: 7373 686e 7064 2d30 2e34 2e36 2f50 4b47  sshnpd-0.4.6/PKG
+00006010: 2d49 4e46 4f00 0000 0000 0000 0000 0000  -INFO...........
+00006020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00006070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00006080: 3030 3034 3534 3600 3030 3030 3030 3030  0004546.00000000
+00006090: 3030 3000 3031 3130 3135 0020 3000 0000  000.011015. 0...
+000060a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000060b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000060c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000060d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000060e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000060f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00006110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000061a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000061b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000061c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000061d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000061e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000061f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006200: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00006210: 3a20 322e 310a 4e61 6d65 3a20 7373 686e  : 2.1.Name: sshn
+00006220: 7064 0a56 6572 7369 6f6e 3a20 302e 342e  pd.Version: 0.4.
+00006230: 360a 5375 6d6d 6172 793a 2050 7974 686f  6.Summary: Pytho
+00006240: 6e20 696d 706c 656d 656e 7461 7469 6f6e  n implementation
+00006250: 206f 6620 5353 4820 4e6f 2050 6f72 7473   of SSH No Ports
+00006260: 2064 6165 6d6f 6e0a 486f 6d65 2d70 6167   daemon.Home-pag
+00006270: 653a 2068 7474 7073 3a2f 2f67 6974 6875  e: https://githu
+00006280: 622e 636f 6d2f 6174 7369 676e 2d66 6f75  b.com/atsign-fou
+00006290: 6e64 6174 696f 6e2f 6e6f 706f 7274 730a  ndation/noports.
+000062a0: 4175 7468 6f72 3a20 5861 7669 6572 204c  Author: Xavier L
+000062b0: 696e 0a41 7574 686f 722d 656d 6169 6c3a  in.Author-email:
+000062c0: 2078 6176 6965 722e 6c69 6e40 6174 7369   xavier.lin@atsi
+000062d0: 676e 2e63 6f6d 200a 4d61 696e 7461 696e  gn.com .Maintain
+000062e0: 6572 3a20 4368 7269 7320 5377 616e 0a4d  er: Chris Swan.M
+000062f0: 6169 6e74 6169 6e65 722d 656d 6169 6c3a  aintainer-email:
+00006300: 2063 6872 6973 4061 7473 6967 6e2e 636f   chris@atsign.co
+00006310: 6d0a 5265 7175 6972 6573 2d50 7974 686f  m.Requires-Pytho
+00006320: 6e3a 203e 3d33 2e31 302c 3c34 2e30 0a43  n: >=3.10,<4.0.C
+00006330: 6c61 7373 6966 6965 723a 2050 726f 6772  lassifier: Progr
+00006340: 616d 6d69 6e67 204c 616e 6775 6167 6520  amming Language 
+00006350: 3a3a 2050 7974 686f 6e20 3a3a 2033 0a43  :: Python :: 3.C
+00006360: 6c61 7373 6966 6965 723a 2050 726f 6772  lassifier: Progr
+00006370: 616d 6d69 6e67 204c 616e 6775 6167 6520  amming Language 
+00006380: 3a3a 2050 7974 686f 6e20 3a3a 2033 2e31  :: Python :: 3.1
+00006390: 300a 436c 6173 7369 6669 6572 3a20 5072  0.Classifier: Pr
+000063a0: 6f67 7261 6d6d 696e 6720 4c61 6e67 7561  ogramming Langua
+000063b0: 6765 203a 3a20 5079 7468 6f6e 203a 3a20  ge :: Python :: 
+000063c0: 332e 3131 0a43 6c61 7373 6966 6965 723a  3.11.Classifier:
+000063d0: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+000063e0: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
+000063f0: 3a3a 2033 2e31 320a 5265 7175 6972 6573  :: 3.12.Requires
+00006400: 2d44 6973 743a 2050 794e 6143 6c20 283d  -Dist: PyNaCl (=
+00006410: 3d31 2e35 2e30 290a 5265 7175 6972 6573  =1.5.0).Requires
+00006420: 2d44 6973 743a 2061 7473 646b 2028 3d3d  -Dist: atsdk (==
+00006430: 302e 322e 3133 290a 5265 7175 6972 6573  0.2.13).Requires
+00006440: 2d44 6973 743a 2062 6372 7970 7420 283d  -Dist: bcrypt (=
+00006450: 3d34 2e31 2e33 290a 5265 7175 6972 6573  =4.1.3).Requires
+00006460: 2d44 6973 743a 2070 6172 616d 696b 6f20  -Dist: paramiko 
+00006470: 283d 3d33 2e34 2e30 290a 5265 7175 6972  (==3.4.0).Requir
+00006480: 6573 2d44 6973 743a 2073 6574 7570 746f  es-Dist: setupto
+00006490: 6f6c 7320 283d 3d36 392e 352e 3129 0a44  ols (==69.5.1).D
+000064a0: 6573 6372 6970 7469 6f6e 2d43 6f6e 7465  escription-Conte
+000064b0: 6e74 2d54 7970 653a 2074 6578 742f 6d61  nt-Type: text/ma
+000064c0: 726b 646f 776e 0a0a 3c68 313e 3c61 2068  rkdown..<h1><a h
+000064d0: 7265 663d 2268 7474 7073 3a2f 2f61 7473  ref="https://ats
+000064e0: 6967 6e2e 636f 6d23 6768 2d6c 6967 6874  ign.com#gh-light
+000064f0: 2d6d 6f64 652d 6f6e 6c79 223e 3c69 6d67  -mode-only"><img
+00006500: 2077 6964 7468 3d32 3530 7078 2073 7263   width=250px src
+00006510: 3d22 6874 7470 733a 2f2f 6174 7369 676e  ="https://atsign
+00006520: 2e63 6f6d 2f77 702d 636f 6e74 656e 742f  .com/wp-content/
+00006530: 7570 6c6f 6164 732f 3230 3232 2f30 352f  uploads/2022/05/
+00006540: 6174 7369 676e 2d6c 6f67 6f2d 686f 7269  atsign-logo-hori
+00006550: 7a6f 6e74 616c 2d63 6f6c 6f72 3230 3232  zontal-color2022
+00006560: 2e73 7667 2367 682d 6c69 6768 742d 6d6f  .svg#gh-light-mo
+00006570: 6465 2d6f 6e6c 7922 2061 6c74 3d22 5468  de-only" alt="Th
+00006580: 6520 4174 7369 676e 2046 6f75 6e64 6174  e Atsign Foundat
+00006590: 696f 6e22 3e3c 2f61 3e3c 6120 6872 6566  ion"></a><a href
+000065a0: 3d22 6874 7470 733a 2f2f 6174 7369 676e  ="https://atsign
+000065b0: 2e63 6f6d 2367 682d 6461 726b 2d6d 6f64  .com#gh-dark-mod
+000065c0: 652d 6f6e 6c79 223e 3c69 6d67 2077 6964  e-only"><img wid
+000065d0: 7468 3d32 3530 7078 2073 7263 3d22 6874  th=250px src="ht
+000065e0: 7470 733a 2f2f 6174 7369 676e 2e63 6f6d  tps://atsign.com
+000065f0: 2f77 702d 636f 6e74 656e 742f 7570 6c6f  /wp-content/uplo
+00006600: 6164 732f 3230 3233 2f30 382f 6174 7369  ads/2023/08/atsi
+00006610: 676e 2d6c 6f67 6f2d 686f 7269 7a6f 6e74  gn-logo-horizont
+00006620: 616c 2d72 6576 6572 7365 3230 3232 2d43  al-reverse2022-C
+00006630: 6f6c 6f72 2e73 7667 2367 682d 6461 726b  olor.svg#gh-dark
+00006640: 2d6d 6f64 652d 6f6e 6c79 2220 616c 743d  -mode-only" alt=
+00006650: 2254 6865 2041 7473 6967 6e20 466f 756e  "The Atsign Foun
+00006660: 6461 7469 6f6e 223e 3c2f 613e 0a0a 5b21  dation"></a>..[!
+00006670: 5b47 6974 4875 6220 4c69 6365 6e73 655d  [GitHub License]
+00006680: 2868 7474 7073 3a2f 2f69 6d67 2e73 6869  (https://img.shi
+00006690: 656c 6473 2e69 6f2f 6261 6467 652f 6c69  elds.io/badge/li
+000066a0: 6365 6e73 652d 4253 4433 2d62 6c75 652e  cense-BSD3-blue.
+000066b0: 7376 6729 5d28 2e2f 4c49 4345 4e53 4529  svg)](./LICENSE)
+000066c0: 0a0a 2320 5353 484e 5044 2050 7974 686f  ..# SSHNPD Pytho
+000066d0: 6e0a 0a53 5348 204e 6f20 506f 7274 7320  n..SSH No Ports 
+000066e0: 7072 6f76 6964 6573 2061 2077 6179 2074  provides a way t
+000066f0: 6f20 7373 6820 746f 2061 2072 656d 6f74  o ssh to a remot
+00006700: 6520 6c69 6e75 7820 686f 7374 2f64 6576  e linux host/dev
+00006710: 6963 6520 7769 7468 6f75 7420 7468 6174  ice without that
+00006720: 0a64 6576 6963 6520 6f72 2074 6865 2063  .device or the c
+00006730: 6c69 656e 7420 6861 7669 6e67 2061 6e79  lient having any
+00006740: 206f 7065 6e20 706f 7274 7320 286e 6f74   open ports (not
+00006750: 2065 7665 6e20 3232 2920 6f6e 2065 7874   even 22) on ext
+00006760: 6572 6e61 6c0a 696e 7465 7266 6163 6573  ernal.interfaces
+00006770: 2e20 416c 6c20 6e65 7477 6f72 6b20 636f  . All network co
+00006780: 6e6e 6563 7469 7669 7479 2069 7320 6f75  nnectivity is ou
+00006790: 7462 6f75 6e64 2061 6e64 2074 6865 7265  tbound and there
+000067a0: 2069 7320 6e6f 206e 6565 6420 746f 0a6b   is no need to.k
+000067b0: 6e6f 7720 7468 6520 4950 2061 6464 7265  now the IP addre
+000067c0: 7373 2074 6865 2064 6576 6963 6520 6861  ss the device ha
+000067d0: 7320 6265 656e 2067 6976 656e 2e20 4173  s been given. As
+000067e0: 206c 6f6e 6720 6173 2074 6865 2064 6576   long as the dev
+000067f0: 6963 6520 616e 640a 636c 6965 6e74 2068  ice and.client h
+00006800: 6173 2061 6e20 4950 2061 6464 7265 7373  as an IP address
+00006810: 2028 7075 626c 6963 206f 7220 7072 6976   (public or priv
+00006820: 6174 6520 3139 3138 292c 2044 4e53 2061  ate 1918), DNS a
+00006830: 6e64 2049 6e74 6572 6e65 7420 6163 6365  nd Internet acce
+00006840: 7373 2c0a 796f 7520 7769 6c6c 2062 6520  ss,.you will be 
+00006850: 6162 6c65 2074 6f20 636f 6e6e 6563 7420  able to connect 
+00006860: 746f 2069 742e 0a0a 5468 6973 2076 6572  to it...This ver
+00006870: 7369 6f6e 2069 7320 5353 484e 5020 4461  sion is SSHNP Da
+00006880: 656d 6f6e 2077 7269 7474 656e 2069 6e20  emon written in 
+00006890: 5079 7468 6f6e 2c20 6974 2069 7320 7374  Python, it is st
+000068a0: 696c 6c20 696e 2069 7473 2062 6574 610a  ill in its beta.
+000068b0: 7374 6167 6520 6f66 2064 6576 656c 6f70  stage of develop
+000068c0: 656d 656e 742e 0a0a 2323 2050 7265 7265  ement...## Prere
+000068d0: 7175 6973 6974 6573 0a0a 5353 484e 5044  quisites..SSHNPD
+000068e0: 2050 7974 686f 6e20 7265 7175 6972 6573   Python requires
+000068f0: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a0a   the following:.
+00006900: 0a2a 2032 2061 7473 6967 6e73 2c20 6f6e  .* 2 atsigns, on
+00006910: 6520 666f 7220 7468 6520 636c 6965 6e74  e for the client
+00006920: 2061 6e64 206f 6e65 2066 6f72 2074 6865   and one for the
+00006930: 2064 6576 6963 650a 2a20 616e 7920 6d61   device.* any ma
+00006940: 6368 696e 6520 7769 7468 2073 7368 6420  chine with sshd 
+00006950: 7275 6e6e 696e 6720 616e 6420 7079 7468  running and pyth
+00006960: 6f6e 3320 696e 7374 616c 6c65 640a 2a20  on3 installed.* 
+00006970: 6174 7364 6b20 696e 7374 616c 6c65 640a  atsdk installed.
+00006980: 0a23 2320 496e 7374 616c 6c61 7469 6f6e  .## Installation
+00006990: 0a0a 5468 6973 2070 6163 6b61 6765 2063  ..This package c
+000069a0: 616e 2062 6520 696e 7374 616c 6c65 6420  an be installed 
+000069b0: 6672 6f6d 2050 7950 4920 7769 7468 3a0a  from PyPI with:.
+000069c0: 0a60 6060 7368 0a70 6970 2069 6e73 7461  .```sh.pip insta
+000069d0: 6c6c 2073 7368 6e70 640a 6060 600a 0a41  ll sshnpd.```..A
+000069e0: 6c74 6572 6e61 7469 7665 6c79 2063 6c6f  lternatively clo
+000069f0: 6e65 2074 6869 7320 7265 706f 2061 6e64  ne this repo and
+00006a00: 2066 726f 6d20 7468 6520 7265 706f 2072   from the repo r
+00006a10: 6f6f 743a 0a0a 6060 6073 680a 6364 2070  oot:..```sh.cd p
+00006a20: 6163 6b61 6765 732f 7079 7468 6f6e 2f73  ackages/python/s
+00006a30: 7368 6e70 640a 7069 7020 696e 7374 616c  shnpd.pip instal
+00006a40: 6c20 2d72 2072 6571 7569 7265 6d65 6e74  l -r requirement
+00006a50: 732e 7478 740a 7069 7020 696e 7374 616c  s.txt.pip instal
+00006a60: 6c20 2e0a 6060 600a 0a23 2320 5275 6e6e  l ..```..## Runn
+00006a70: 696e 6720 7468 6520 7072 6f67 7261 6d0a  ing the program.
+00006a80: 0a60 6060 7368 0a73 7368 6e70 6420 2d6d  .```sh.sshnpd -m
+00006a90: 2040 7b63 6c69 656e 7441 7473 6967 6e7d   @{clientAtsign}
+00006aa0: 202d 6120 407b 6465 7669 6365 4174 7369   -a @{deviceAtsi
+00006ab0: 676e 7d20 2d64 207b 6465 7669 6365 4e61  gn} -d {deviceNa
+00006ac0: 6d65 7d0a 6060 600a 0a23 2320 4e6f 2050  me}.```..## No P
+00006ad0: 6f72 7473 2053 444b 2050 7974 686f 6e20  orts SDK Python 
+00006ae0: 2865 7870 6572 696d 656e 7461 6c29 0a0a  (experimental)..
+00006af0: 5468 6572 6520 6973 2061 2073 696d 706c  There is a simpl
+00006b00: 6520 7079 7468 6f6e 2053 444b 2077 6869  e python SDK whi
+00006b10: 6368 2061 6c6c 6f77 7320 796f 7520 746f  ch allows you to
+00006b20: 2063 7265 6174 6520 7363 7269 7074 7320   create scripts 
+00006b30: 666f 7220 636f 6d6d 6f6e 0a61 646d 696e  for common.admin
+00006b40: 6973 7472 6174 6976 6520 7061 7474 6572  istrative patter
+00006b50: 6e73 2076 6961 2053 5348 204e 6f20 506f  ns via SSH No Po
+00006b60: 7274 732e 0a0a 0000 0000 0000 0000 0000  rts.............
+00006b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000070a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000070b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000070c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000070d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000070e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000070f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000076a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000076b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000076c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000076f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1914,647 +1914,7 @@
 00007790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000077f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007800: 7373 686e 7064 2d30 2e34 2e35 2f50 4b47  sshnpd-0.4.5/PKG
-00007810: 2d49 4e46 4f00 0000 0000 0000 0000 0000  -INFO...........
-00007820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00007870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00007880: 3030 3034 3534 3500 3030 3030 3030 3030  0004545.00000000
-00007890: 3030 3000 3031 3130 3133 0020 3000 0000  000.011013. 0...
-000078a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000078b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000078c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000078d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000078e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000078f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00007910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000079a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000079b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000079c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000079d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000079e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000079f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007a00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00007a10: 3a20 322e 310a 4e61 6d65 3a20 7373 686e  : 2.1.Name: sshn
-00007a20: 7064 0a56 6572 7369 6f6e 3a20 302e 342e  pd.Version: 0.4.
-00007a30: 350a 5375 6d6d 6172 793a 2050 7974 686f  5.Summary: Pytho
-00007a40: 6e20 696d 706c 656d 656e 7461 7469 6f6e  n implementation
-00007a50: 206f 6620 5353 4820 4e6f 2050 6f72 7473   of SSH No Ports
-00007a60: 2064 6165 6d6f 6e0a 486f 6d65 2d70 6167   daemon.Home-pag
-00007a70: 653a 2068 7474 7073 3a2f 2f67 6974 6875  e: https://githu
-00007a80: 622e 636f 6d2f 6174 7369 676e 2d66 6f75  b.com/atsign-fou
-00007a90: 6e64 6174 696f 6e2f 6e6f 706f 7274 730a  ndation/noports.
-00007aa0: 4175 7468 6f72 3a20 5861 7669 6572 204c  Author: Xavier L
-00007ab0: 696e 0a41 7574 686f 722d 656d 6169 6c3a  in.Author-email:
-00007ac0: 2078 6176 6965 722e 6c69 6e40 6174 7369   xavier.lin@atsi
-00007ad0: 676e 2e63 6f6d 200a 4d61 696e 7461 696e  gn.com .Maintain
-00007ae0: 6572 3a20 4368 7269 7320 5377 616e 0a4d  er: Chris Swan.M
-00007af0: 6169 6e74 6169 6e65 722d 656d 6169 6c3a  aintainer-email:
-00007b00: 2063 6872 6973 4061 7473 6967 6e2e 636f   chris@atsign.co
-00007b10: 6d0a 5265 7175 6972 6573 2d50 7974 686f  m.Requires-Pytho
-00007b20: 6e3a 203e 3d33 2e31 302c 3c34 2e30 0a43  n: >=3.10,<4.0.C
-00007b30: 6c61 7373 6966 6965 723a 2050 726f 6772  lassifier: Progr
-00007b40: 616d 6d69 6e67 204c 616e 6775 6167 6520  amming Language 
-00007b50: 3a3a 2050 7974 686f 6e20 3a3a 2033 0a43  :: Python :: 3.C
-00007b60: 6c61 7373 6966 6965 723a 2050 726f 6772  lassifier: Progr
-00007b70: 616d 6d69 6e67 204c 616e 6775 6167 6520  amming Language 
-00007b80: 3a3a 2050 7974 686f 6e20 3a3a 2033 2e31  :: Python :: 3.1
-00007b90: 300a 436c 6173 7369 6669 6572 3a20 5072  0.Classifier: Pr
-00007ba0: 6f67 7261 6d6d 696e 6720 4c61 6e67 7561  ogramming Langua
-00007bb0: 6765 203a 3a20 5079 7468 6f6e 203a 3a20  ge :: Python :: 
-00007bc0: 332e 3131 0a43 6c61 7373 6966 6965 723a  3.11.Classifier:
-00007bd0: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
-00007be0: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
-00007bf0: 3a3a 2033 2e31 320a 5265 7175 6972 6573  :: 3.12.Requires
-00007c00: 2d44 6973 743a 2050 794e 6143 6c20 283d  -Dist: PyNaCl (=
-00007c10: 3d31 2e35 2e30 290a 5265 7175 6972 6573  =1.5.0).Requires
-00007c20: 2d44 6973 743a 2061 7473 646b 2028 3d3d  -Dist: atsdk (==
-00007c30: 302e 322e 3629 0a52 6571 7569 7265 732d  0.2.6).Requires-
-00007c40: 4469 7374 3a20 6263 7279 7074 2028 3d3d  Dist: bcrypt (==
-00007c50: 342e 312e 3229 0a52 6571 7569 7265 732d  4.1.2).Requires-
-00007c60: 4469 7374 3a20 7061 7261 6d69 6b6f 2028  Dist: paramiko (
-00007c70: 3d3d 332e 342e 3029 0a52 6571 7569 7265  ==3.4.0).Require
-00007c80: 732d 4469 7374 3a20 7365 7475 7074 6f6f  s-Dist: setuptoo
-00007c90: 6c73 2028 3d3d 3639 2e31 2e31 290a 4465  ls (==69.1.1).De
-00007ca0: 7363 7269 7074 696f 6e2d 436f 6e74 656e  scription-Conten
-00007cb0: 742d 5479 7065 3a20 7465 7874 2f6d 6172  t-Type: text/mar
-00007cc0: 6b64 6f77 6e0a 0a3c 6831 3e3c 6120 6872  kdown..<h1><a hr
-00007cd0: 6566 3d22 6874 7470 733a 2f2f 6174 7369  ef="https://atsi
-00007ce0: 676e 2e63 6f6d 2367 682d 6c69 6768 742d  gn.com#gh-light-
-00007cf0: 6d6f 6465 2d6f 6e6c 7922 3e3c 696d 6720  mode-only"><img 
-00007d00: 7769 6474 683d 3235 3070 7820 7372 633d  width=250px src=
-00007d10: 2268 7474 7073 3a2f 2f61 7473 6967 6e2e  "https://atsign.
-00007d20: 636f 6d2f 7770 2d63 6f6e 7465 6e74 2f75  com/wp-content/u
-00007d30: 706c 6f61 6473 2f32 3032 322f 3035 2f61  ploads/2022/05/a
-00007d40: 7473 6967 6e2d 6c6f 676f 2d68 6f72 697a  tsign-logo-horiz
-00007d50: 6f6e 7461 6c2d 636f 6c6f 7232 3032 322e  ontal-color2022.
-00007d60: 7376 6723 6768 2d6c 6967 6874 2d6d 6f64  svg#gh-light-mod
-00007d70: 652d 6f6e 6c79 2220 616c 743d 2254 6865  e-only" alt="The
-00007d80: 2041 7473 6967 6e20 466f 756e 6461 7469   Atsign Foundati
-00007d90: 6f6e 223e 3c2f 613e 3c61 2068 7265 663d  on"></a><a href=
-00007da0: 2268 7474 7073 3a2f 2f61 7473 6967 6e2e  "https://atsign.
-00007db0: 636f 6d23 6768 2d64 6172 6b2d 6d6f 6465  com#gh-dark-mode
-00007dc0: 2d6f 6e6c 7922 3e3c 696d 6720 7769 6474  -only"><img widt
-00007dd0: 683d 3235 3070 7820 7372 633d 2268 7474  h=250px src="htt
-00007de0: 7073 3a2f 2f61 7473 6967 6e2e 636f 6d2f  ps://atsign.com/
-00007df0: 7770 2d63 6f6e 7465 6e74 2f75 706c 6f61  wp-content/uploa
-00007e00: 6473 2f32 3032 332f 3038 2f61 7473 6967  ds/2023/08/atsig
-00007e10: 6e2d 6c6f 676f 2d68 6f72 697a 6f6e 7461  n-logo-horizonta
-00007e20: 6c2d 7265 7665 7273 6532 3032 322d 436f  l-reverse2022-Co
-00007e30: 6c6f 722e 7376 6723 6768 2d64 6172 6b2d  lor.svg#gh-dark-
-00007e40: 6d6f 6465 2d6f 6e6c 7922 2061 6c74 3d22  mode-only" alt="
-00007e50: 5468 6520 4174 7369 676e 2046 6f75 6e64  The Atsign Found
-00007e60: 6174 696f 6e22 3e3c 2f61 3e0a 0a5b 215b  ation"></a>..[![
-00007e70: 4769 7448 7562 204c 6963 656e 7365 5d28  GitHub License](
-00007e80: 6874 7470 733a 2f2f 696d 672e 7368 6965  https://img.shie
-00007e90: 6c64 732e 696f 2f62 6164 6765 2f6c 6963  lds.io/badge/lic
-00007ea0: 656e 7365 2d42 5344 332d 626c 7565 2e73  ense-BSD3-blue.s
-00007eb0: 7667 295d 282e 2f4c 4943 454e 5345 290a  vg)](./LICENSE).
-00007ec0: 0a23 2053 5348 4e50 4420 5079 7468 6f6e  .# SSHNPD Python
-00007ed0: 0a0a 5353 4820 4e6f 2050 6f72 7473 2070  ..SSH No Ports p
-00007ee0: 726f 7669 6465 7320 6120 7761 7920 746f  rovides a way to
-00007ef0: 2073 7368 2074 6f20 6120 7265 6d6f 7465   ssh to a remote
-00007f00: 206c 696e 7578 2068 6f73 742f 6465 7669   linux host/devi
-00007f10: 6365 2077 6974 686f 7574 2074 6861 740a  ce without that.
-00007f20: 6465 7669 6365 206f 7220 7468 6520 636c  device or the cl
-00007f30: 6965 6e74 2068 6176 696e 6720 616e 7920  ient having any 
-00007f40: 6f70 656e 2070 6f72 7473 2028 6e6f 7420  open ports (not 
-00007f50: 6576 656e 2032 3229 206f 6e20 6578 7465  even 22) on exte
-00007f60: 726e 616c 0a69 6e74 6572 6661 6365 732e  rnal.interfaces.
-00007f70: 2041 6c6c 206e 6574 776f 726b 2063 6f6e   All network con
-00007f80: 6e65 6374 6976 6974 7920 6973 206f 7574  nectivity is out
-00007f90: 626f 756e 6420 616e 6420 7468 6572 6520  bound and there 
-00007fa0: 6973 206e 6f20 6e65 6564 2074 6f0a 6b6e  is no need to.kn
-00007fb0: 6f77 2074 6865 2049 5020 6164 6472 6573  ow the IP addres
-00007fc0: 7320 7468 6520 6465 7669 6365 2068 6173  s the device has
-00007fd0: 2062 6565 6e20 6769 7665 6e2e 2041 7320   been given. As 
-00007fe0: 6c6f 6e67 2061 7320 7468 6520 6465 7669  long as the devi
-00007ff0: 6365 2061 6e64 0a63 6c69 656e 7420 6861  ce and.client ha
-00008000: 7320 616e 2049 5020 6164 6472 6573 7320  s an IP address 
-00008010: 2870 7562 6c69 6320 6f72 2070 7269 7661  (public or priva
-00008020: 7465 2031 3931 3829 2c20 444e 5320 616e  te 1918), DNS an
-00008030: 6420 496e 7465 726e 6574 2061 6363 6573  d Internet acces
-00008040: 732c 0a79 6f75 2077 696c 6c20 6265 2061  s,.you will be a
-00008050: 626c 6520 746f 2063 6f6e 6e65 6374 2074  ble to connect t
-00008060: 6f20 6974 2e0a 0a54 6869 7320 7665 7273  o it...This vers
-00008070: 696f 6e20 6973 2053 5348 4e50 2044 6165  ion is SSHNP Dae
-00008080: 6d6f 6e20 7772 6974 7465 6e20 696e 2050  mon written in P
-00008090: 7974 686f 6e2c 2069 7420 6973 2073 7469  ython, it is sti
-000080a0: 6c6c 2069 6e20 6974 7320 6265 7461 0a73  ll in its beta.s
-000080b0: 7461 6765 206f 6620 6465 7665 6c6f 7065  tage of develope
-000080c0: 6d65 6e74 2e0a 0a23 2320 5072 6572 6571  ment...## Prereq
-000080d0: 7569 7369 7465 730a 0a53 5348 4e50 4420  uisites..SSHNPD 
-000080e0: 5079 7468 6f6e 2072 6571 7569 7265 7320  Python requires 
-000080f0: 7468 6520 666f 6c6c 6f77 696e 673a 0a0a  the following:..
-00008100: 2a20 3220 6174 7369 676e 732c 206f 6e65  * 2 atsigns, one
-00008110: 2066 6f72 2074 6865 2063 6c69 656e 7420   for the client 
-00008120: 616e 6420 6f6e 6520 666f 7220 7468 6520  and one for the 
-00008130: 6465 7669 6365 0a2a 2061 6e79 206d 6163  device.* any mac
-00008140: 6869 6e65 2077 6974 6820 7373 6864 2072  hine with sshd r
-00008150: 756e 6e69 6e67 2061 6e64 2070 7974 686f  unning and pytho
-00008160: 6e33 2069 6e73 7461 6c6c 6564 0a2a 2061  n3 installed.* a
-00008170: 7473 646b 2069 6e73 7461 6c6c 6564 0a0a  tsdk installed..
-00008180: 2323 2049 6e73 7461 6c6c 6174 696f 6e0a  ## Installation.
-00008190: 0a54 6869 7320 7061 636b 6167 6520 6361  .This package ca
-000081a0: 6e20 6265 2069 6e73 7461 6c6c 6564 2066  n be installed f
-000081b0: 726f 6d20 5079 5049 2077 6974 683a 0a0a  rom PyPI with:..
-000081c0: 6060 6073 680a 7069 7020 696e 7374 616c  ```sh.pip instal
-000081d0: 6c20 7373 686e 7064 0a60 6060 0a0a 416c  l sshnpd.```..Al
-000081e0: 7465 726e 6174 6976 656c 7920 636c 6f6e  ternatively clon
-000081f0: 6520 7468 6973 2072 6570 6f20 616e 6420  e this repo and 
-00008200: 6672 6f6d 2074 6865 2072 6570 6f20 726f  from the repo ro
-00008210: 6f74 3a0a 0a60 6060 7368 0a63 6420 7061  ot:..```sh.cd pa
-00008220: 636b 6167 6573 2f70 7974 686f 6e2f 7373  ckages/python/ss
-00008230: 686e 7064 0a70 6970 2069 6e73 7461 6c6c  hnpd.pip install
-00008240: 202d 7220 7265 7175 6972 656d 656e 7473   -r requirements
-00008250: 2e74 7874 0a70 6970 2069 6e73 7461 6c6c  .txt.pip install
-00008260: 202e 0a60 6060 0a0a 2323 2052 756e 6e69   ..```..## Runni
-00008270: 6e67 2074 6865 2070 726f 6772 616d 0a0a  ng the program..
-00008280: 6060 6073 680a 7373 686e 7064 202d 6d20  ```sh.sshnpd -m 
-00008290: 407b 636c 6965 6e74 4174 7369 676e 7d20  @{clientAtsign} 
-000082a0: 2d61 2040 7b64 6576 6963 6541 7473 6967  -a @{deviceAtsig
-000082b0: 6e7d 202d 6420 7b64 6576 6963 654e 616d  n} -d {deviceNam
-000082c0: 657d 0a60 6060 0a0a 2323 204e 6f20 506f  e}.```..## No Po
-000082d0: 7274 7320 5344 4b20 5079 7468 6f6e 2028  rts SDK Python (
-000082e0: 6578 7065 7269 6d65 6e74 616c 290a 0a54  experimental)..T
-000082f0: 6865 7265 2069 7320 6120 7369 6d70 6c65  here is a simple
-00008300: 2070 7974 686f 6e20 5344 4b20 7768 6963   python SDK whic
-00008310: 6820 616c 6c6f 7773 2079 6f75 2074 6f20  h allows you to 
-00008320: 6372 6561 7465 2073 6372 6970 7473 2066  create scripts f
-00008330: 6f72 2063 6f6d 6d6f 6e0a 6164 6d69 6e69  or common.admini
-00008340: 7374 7261 7469 7665 2070 6174 7465 726e  strative pattern
-00008350: 7320 7669 6120 5353 4820 4e6f 2050 6f72  s via SSH No Por
-00008360: 7473 2e0a 0a00 0000 0000 0000 0000 0000  ts..............
-00008370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000083a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000083b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000083c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000083d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000083e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000083f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000084a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000084b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000084c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000084d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000084e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000084f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000085a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000085b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000085c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000085d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000085e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000085f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000086a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000086b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000086c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000086d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000086e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000086f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000087a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000087b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000087c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000087d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000087e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000087f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000088a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000088b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000088c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000088d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000088e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000088f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000089a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000089b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000089c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000089d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000089e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000089f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000090a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000090b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000090c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000090d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000090e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000090f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000091a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000091b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000091c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000091d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000091e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000091f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000092a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000092b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000092c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000092d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000092e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000092f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000093a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000093b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000093c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000093d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000093e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000093f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000094a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000094b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000094c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000094d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000094e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000094f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000095a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000095b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000095c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000095d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000095e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000095f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000096a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000096b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000096c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000096d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000096e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000096f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000097f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000098f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000099f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

